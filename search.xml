<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>《移动智能应用开发》课程个人实验报告</title>
    <url>/2022/01/05/Android-report/</url>
    <content><![CDATA[<h1 id="《移动智能应用开发》课程实验报告"><a href="#《移动智能应用开发》课程实验报告" class="headerlink" title="《移动智能应用开发》课程实验报告"></a>《移动智能应用开发》课程实验报告</h1><h2 id="一、项目名称"><a href="#一、项目名称" class="headerlink" title="一、项目名称"></a>一、项目名称</h2><p><em><strong>Food’ secret</strong></em>（营养咨询app）</p>
<blockquote>
<p><strong>项目地址：</strong><a href="https://github.com/android-app-development-course/2021autumn-A15-Nutrition-consultation">2021autumn-A15-Nutrition-consultation</a></p>
</blockquote>
<h2 id="二、项目的主题、设计目的"><a href="#二、项目的主题、设计目的" class="headerlink" title="二、项目的主题、设计目的"></a>二、项目的主题、设计目的</h2><p>产品主要供给想要规范化自己日常饮食的人群，如计划在减肥的肥胖人士，需要控制饮食的病人之类的。这类人群需要比较精确的知道食物的营养成分，让自己的饮食可以合理的提供所需的营养。而且这类人群有能力也会接受付费的定制化服务，消费水平可观。</p>
<ul>
<li><p><strong>为什么做？—— “我们为什么要开发这个产品？”（战略层）</strong></p>
<p>解决人们对于快速精准了解食物具体营养成分的需求。</p>
</li>
<li><p><strong>做什么？—— “我们要开发的是什么？”（范围层）</strong></p>
<p>我们的产品主要以功能性为主，向用户精准快速地提供食物营养成分。</p>
</li>
<li><p><strong>怎么做？——“我们如何达到上述抽象层面所确定的问题？”（结构层、框架层、表现层）</strong></p>
<p>我们的产品将首先立足于最基本的需求痛点——通过用户输入食物名称或者相关信息返回相应的营养信息，供用户利用这些信息制定饮食方案。除此之外，我们将追求实现动态记录用户每一天的营养摄入情况，并且通过用户设定的营养目标动态地为用户提供饮食建议。</p>
</li>
</ul>
<h2 id="三、软件简介-包括软件的基本结构、基本内容、运行环境等"><a href="#三、软件简介-包括软件的基本结构、基本内容、运行环境等" class="headerlink" title="三、软件简介:包括软件的基本结构、基本内容、运行环境等"></a>三、软件简介:包括软件的基本结构、基本内容、运行环境等</h2><h3 id="1-基本内容"><a href="#1-基本内容" class="headerlink" title="1.基本内容"></a>1.基本内容</h3><ul>
<li><input checked="" disabled="" type="checkbox"> 可以直接通过关键字模糊搜索某种食物的营养成分</li>
<li><input checked="" disabled="" type="checkbox"> 可以在分类页面查看每个分类下每个具体食物的营养成分</li>
<li><input checked="" disabled="" type="checkbox"> 可以把已查询到的食物添加进分析列表</li>
<li><input checked="" disabled="" type="checkbox"> 可以对分析列表中的食物进行选择和输入具体食用量</li>
<li><input checked="" disabled="" type="checkbox"> 可以根据当前时间结合营养需求给出建议</li>
<li><input checked="" disabled="" type="checkbox"> 每个fragment都有不一样的颜色，会自动改变，侧边栏的部分也会随之改变</li>
</ul>
<h3 id="2-基本结构"><a href="#2-基本结构" class="headerlink" title="2.基本结构"></a>2.基本结构</h3><p><strong>单activity多fragment结构</strong></p>
<blockquote>
<p><strong>用Navigation组件管理7个fragment：</strong></p>
<ul>
<li>home</li>
<li>search</li>
<li>tag</li>
<li>detail</li>
<li>select</li>
<li>analyse</li>
<li>about</li>
</ul>
<p><strong>主要有四个recycleview：</strong></p>
<ul>
<li>Food</li>
<li>Result</li>
<li>Tag</li>
<li>Foodselect</li>
</ul>
</blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220105101147601.png"></p>
<h2 id="四、重点介绍整个软件开发过程中个人的主要工作和收获"><a href="#四、重点介绍整个软件开发过程中个人的主要工作和收获" class="headerlink" title="四、重点介绍整个软件开发过程中个人的主要工作和收获"></a>四、重点介绍整个软件开发过程中个人的主要工作和收获</h2><h3 id="主要工作："><a href="#主要工作：" class="headerlink" title="主要工作："></a>主要工作：</h3><p><strong><u>本人负责的是UI设计和实现以及部分操作逻辑的实现</u></strong></p>
<p>具体包括<strong>7个fragemnt</strong>的实现以及<strong>4个recycleview</strong>的实现，还有<strong>部分数据传递</strong>的工作</p>
<h3 id="收获："><a href="#收获：" class="headerlink" title="收获："></a>收获：</h3><ol>
<li>熟悉了navigation组建的基本用法，如何在fragment之间导航，传递整个类的数据之类的</li>
<li>自己设计了这个app的UI，熟悉了约束布局的使用和sketch的线框图功能</li>
<li>发现很多UI实现方面的小细节和技巧，对自己还是有很大帮助的，比如获得一些套壳布局的id之类的</li>
</ol>
<h2 id="五、设计实践中目前存在的问题"><a href="#五、设计实践中目前存在的问题" class="headerlink" title="五、设计实践中目前存在的问题"></a>五、设计实践中目前存在的问题</h2><ol>
<li>因为用的是免费的API，所以食物的数据不够全面丰富，并不能很好的提供完整的用户体验</li>
<li>分析结果部分做得差强人意，不能根据用户的偏好来进行更细化的分析，比如不让用户在相邻的时间内重复提醒吃某种食物</li>
<li>和用户的个人交互方面有待完善，没有收藏食物，记录用户习惯，记录体重这种让用户更舒心的功能</li>
<li>动效不足，因为网上的文档和资源较少，而且本项目的所有内容都是自己写的，除了网络部分引用了库，所以一些地方因为技术问题可能会不是很完美</li>
</ol>
<h2 id="六、设计实践过程中的自我感想"><a href="#六、设计实践过程中的自我感想" class="headerlink" title="六、设计实践过程中的自我感想"></a>六、设计实践过程中的自我感想</h2><p>因为项目是没用到别人的项目代码的，所以什么都是自己搭起来的，学到了挺多东西的吧。但是也清楚了自己的能力所限，比如一些想要的效果做不出来，现在我也不知道那个motion的具体用法。什么共享元素过度之类的，还有各种material design效果的实现，也没找到官方的资源。</p>
<p>不仅是代码能力的缺失，对UI设计的能力也不足，比较单调，可以多去dribble学一下，而且目前图标，插图什么的都是用的别人的，自己也不会画。</p>
<p>总的来说，距离我的梦想（成为一个能做出好看界面的程序员）还有很长的一段路啊，两端都看不到头，安卓代码这边路漫漫其修远兮，什么自定义view，还有好多jetpack的，而且自己也想学学flutter。总之只能努力学了。</p>
]]></content>
  </entry>
  <entry>
    <title>第一个完整项目有感</title>
    <url>/2022/05/17/Learning-Companion/</url>
    <content><![CDATA[<h1 id="第一个完整项目有感而发"><a href="#第一个完整项目有感而发" class="headerlink" title="第一个完整项目有感而发"></a>第一个完整项目有感而发</h1><h2 id="1-一些奇淫巧技的记录"><a href="#1-一些奇淫巧技的记录" class="headerlink" title="1.一些奇淫巧技的记录"></a>1.一些奇淫巧技的记录</h2><h3 id="1-assets里预置数据库"><a href="#1-assets里预置数据库" class="headerlink" title="1.assets里预置数据库"></a>1.assets里预置数据库</h3><p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/RgerRO.png" alt="RgerRO"></p>
<p>把预装好数据的db文件放在assets文件夹里，然后写到<code>/data/data/packagename/databases</code>里就能实现预装数据库</p>
<p>关键代码如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> dbHelper = MyDatabaseHelper(<span class="keyword">this</span>,<span class="string">&quot;LearningData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">dbHelper.copyFileFromAssets(MyApplication.context,<span class="string">&quot;LearningData.db&quot;</span>,<span class="string">&quot;/data/data/com.lnm011223.learning_companion/databases&quot;</span>,<span class="string">&quot;LearningData.db&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">copyFileFromAssets</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    context: <span class="type">Context</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    assetName: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    savePath: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    saveName: <span class="type">String</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 若目标文件夹不存在，则创建</span></span><br><span class="line">    <span class="comment">//val dir = File(Environment.getExternalStorageDirectory().toString() + &quot;/&quot; + savePath)</span></span><br><span class="line">    <span class="comment">//if (!dir.exists()) &#123;</span></span><br><span class="line">    <span class="comment">//    if (!dir.mkdir()) &#123;</span></span><br><span class="line">    <span class="comment">//        Log.d(&quot;FileUtils&quot;, &quot;mkdir error: $savePath&quot;)</span></span><br><span class="line">    <span class="comment">//        return</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 拷贝文件</span></span><br><span class="line">    <span class="keyword">val</span> filename = savePath + <span class="string">&quot;/&quot;</span> + saveName</span><br><span class="line">    <span class="keyword">val</span> file = File(filename)</span><br><span class="line">    <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> inStream: InputStream = context.assets.<span class="keyword">open</span>(assetName)</span><br><span class="line">            <span class="keyword">val</span> fileOutputStream = FileOutputStream(filename)</span><br><span class="line">            <span class="keyword">var</span> byteread: <span class="built_in">Int</span></span><br><span class="line">            <span class="keyword">val</span> buffer = ByteArray(<span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">while</span> (inStream.read(buffer).also &#123; byteread = it &#125; != -<span class="number">1</span>) &#123;</span><br><span class="line">                fileOutputStream.write(buffer, <span class="number">0</span>, byteread)</span><br><span class="line">            &#125;</span><br><span class="line">            fileOutputStream.flush()</span><br><span class="line">            inStream.close()</span><br><span class="line">            fileOutputStream.close()</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: IOException) &#123;</span><br><span class="line">            e.printStackTrace()</span><br><span class="line">        &#125;</span><br><span class="line">        Log.d(<span class="string">&quot;FileUtils&quot;</span>, <span class="string">&quot;[copyFileFromAssets] copy asset file: <span class="variable">$assetName</span> to : <span class="variable">$filename</span>&quot;</span>)</span><br><span class="line">        Toast.makeText(context, <span class="string">&quot;保存成功&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Log.d(<span class="string">&quot;FileUtils&quot;</span>, <span class="string">&quot;[copyFileFromAssets] file is exist: <span class="variable">$filename</span>&quot;</span>)</span><br><span class="line">        <span class="comment">//Toast.makeText(context, &quot;已存在&quot;, Toast.LENGTH_SHORT).show()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-数据库数据填充"><a href="#2-数据库数据填充" class="headerlink" title="2.数据库数据填充"></a>2.数据库数据填充</h3><p>可以用Excel填充数据然后导入进db文件的表里</p>
<h3 id="3-广播用法"><a href="#3-广播用法" class="headerlink" title="3.广播用法"></a>3.广播用法</h3><p>可以通过触发发送一个自定义广播，然后再接收这个广播，从而达到recycleview里的操作可以通知到fragment</p>
<p>关键代码如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">viewHolder.deleteerror_btn.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">    <span class="keyword">val</span> errorBookQuestion = errorlist[position]</span><br><span class="line">    AlertDialog.Builder(parent.context).apply &#123;</span><br><span class="line">        setTitle(<span class="string">&quot;确认：&quot;</span>)</span><br><span class="line">        setMessage(<span class="string">&quot;真的要删除这条记录吗？&quot;</span>)</span><br><span class="line">        setNegativeButton(<span class="string">&quot;否&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        setPositiveButton(<span class="string">&quot;是&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">            db.delete(<span class="string">&quot;ErrorBook&quot;</span>, <span class="string">&quot;title = ?&quot;</span>, arrayOf(errorBookQuestion.title))</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(<span class="string">&quot;ErrorBookDataChange&quot;</span>)</span><br><span class="line"></span><br><span class="line">            context.sendBroadcast(intent)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        show()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onResume</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume()</span><br><span class="line">    Log.d(<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;resume&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> intentFilter = IntentFilter()</span><br><span class="line">    intentFilter.addAction(<span class="string">&quot;ErrorBookDataChange&quot;</span>)</span><br><span class="line">    receiver = ErrorBookChangeReceiver()</span><br><span class="line">    activity?.registerReceiver(receiver,intentFilter)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onPause</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause()</span><br><span class="line">    Log.d(<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;pause&quot;</span>)</span><br><span class="line">    activity?.unregisterReceiver(receiver)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorBookChangeReceiver</span> : <span class="type">BroadcastReceiver</span></span>() &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onReceive</span><span class="params">(context: <span class="type">Context</span>?, intent: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">            initErrorBookList()</span><br><span class="line">            <span class="keyword">val</span> layoutManager = StaggeredGridLayoutManager(<span class="number">1</span>, StaggeredGridLayoutManager.VERTICAL)</span><br><span class="line">            errorbook_recycleview.layoutManager = layoutManager</span><br><span class="line">            <span class="keyword">val</span> adapter = ErrorBookAdapter(errorbooklist)</span><br><span class="line">            errorbook_recycleview.adapter = adapter</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-一些感悟"><a href="#2-一些感悟" class="headerlink" title="2.一些感悟"></a>2.一些感悟</h2><p>先展示一下一些数据：</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/DBnQfG.png" alt="DBnQfG"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/R4iH5c.png" alt="R4iH5c"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/JK0XPm.png" alt="JK0XPm"></p>
]]></content>
      <categories>
        <category>项目</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux kernel编译记录</title>
    <url>/2021/10/10/Linux-kernel/</url>
    <content><![CDATA[<blockquote>
<p>本文参考了<a href="https://linux.cn/article-9665-1.html">如何编译 Linux 内核</a></p>
</blockquote>
<h1 id="开始踩坑"><a href="#开始踩坑" class="headerlink" title="开始踩坑"></a>开始踩坑</h1><blockquote>
<p>编译的内核版本为5.14.9，且Linux发行版为Ubuntu 20.04.3 LTS</p>
</blockquote>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="安装ssh服务"><a href="#安装ssh服务" class="headerlink" title="安装ssh服务"></a>安装ssh服务</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ps -e |grep ssh //查看是否有安装ssh服务</span><br><span class="line">sudo apt-get update //更新资源列表</span><br><span class="line">sudo apt-get install openssh-server //安装</span><br><span class="line">udo ps -e |grep ssh //再次查看是否安装成功</span><br><span class="line">ifconfig //查ip</span><br></pre></td></tr></table></figure>

<h3 id="下载内核源码"><a href="#下载内核源码" class="headerlink" title="下载内核源码"></a>下载内核源码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.14.9.tar.xz</span><br></pre></td></tr></table></figure>

<h3 id="安装编译环境"><a href="#安装编译环境" class="headerlink" title="安装编译环境"></a>安装编译环境</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install git fakeroot build-essential ncurses-dev xz-utils libssl-dev bc flex libelf-dev bison</span><br></pre></td></tr></table></figure>

<h3 id="解压源码"><a href="#解压源码" class="headerlink" title="解压源码"></a>解压源码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo tar xvJf linux-5.14.9.tar.xz //先用cp命令拷贝到usr/src/再解压</span><br></pre></td></tr></table></figure>

<h2 id="配置内核"><a href="#配置内核" class="headerlink" title="配置内核"></a>配置内核</h2><blockquote>
<p>以下的命令不出意外都需要在前面加<code>sudo</code></p>
</blockquote>
<p>首先必须配置需要包含哪些模块。实际上，有一些非常简单的方式来配置。使用一个命令，你能拷贝当前内核的配置文件，然后使用可靠的 <code>menuconfig</code> 命令来做任何必要的更改。使用如下命令来完成：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp /boot/config-$(uname -r) .config</span><br></pre></td></tr></table></figure>

<p>有一个配置文件了，输入命令 <code>make menuconfig</code>。该命令将打开一个配置工具（图 1），它可以让你遍历每个可用模块，然后启用或者禁用你需要或者不需要的模块。</p>
<blockquote>
<p>我个人是直接进去配置界面然后exit的，估计这样就直接采用拷贝过来的配置文件了，下面的<code>make</code>命令就不需要选择一堆问题了</p>
</blockquote>
<blockquote>
<p><em><strong><u><a href="#%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95">建议先看看下面的坑</a>,看完可以省事！</u></strong></em></p>
</blockquote>
<h3 id="编译和安装"><a href="#编译和安装" class="headerlink" title="编译和安装"></a>编译和安装</h3><p>这里需要的时间是最多的，我给了8g内存给虚拟机，cpu占用59%，最后跑了55分钟</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo time make -jn //最好在前面加time,统计一下时间</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://blog.csdn.net/zl3090/article/details/89303583?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.no_search_link&spm=1001.2101.3001.4242">这里贴一下网上搜到的对-jn的理解</a>，总结来说就是n一般是cpu核心数量的两倍</p>
</blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/%E6%88%AA%E5%B1%8F2021-10-07%20%E4%B8%8A%E5%8D%8812.20.03.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/%E6%88%AA%E5%B1%8F2021-10-07%20%E4%B8%8A%E5%8D%882.03.48.png"></p>
<blockquote>
<p>最好在这里弄个快照，这样安装完内核重启之后出问题了还能退回这一步</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo make modules_install // 安装那些之前启用的模块</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/%E6%88%AA%E5%B1%8F2021-10-07%20%E4%B8%8A%E5%8D%882.09.09.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo make install //安装内核</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/%E6%88%AA%E5%B1%8F2021-10-07%20%E4%B8%8A%E5%8D%882.10.31.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/%E6%88%AA%E5%B1%8F2021-10-07%20%E4%B8%8A%E5%8D%882.12.30.png"></p>
<h2 id="启动内核作为引导"><a href="#启动内核作为引导" class="headerlink" title="启动内核作为引导"></a>启动内核作为引导</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-initramfs -c -k 5.14.9</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-grub</span><br></pre></td></tr></table></figure>

<p>然后就可以重启系统了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo reboot</span><br><span class="line">uname -r //重启完可以用这个看看当前内核</span><br></pre></td></tr></table></figure>

<blockquote>
<p>看完本文觉得有帮助的可以去本人的GitHub点个follow哇，说不定还有下一次作业呢</p>
</blockquote>
<h1 id="踩坑记录"><a href="#踩坑记录" class="headerlink" title="踩坑记录"></a>踩坑记录</h1><h2 id="make的时候提示debian-canonical-certs-pem"><a href="#make的时候提示debian-canonical-certs-pem" class="headerlink" title="make的时候提示debian/canonical-certs.pem"></a>make的时候提示debian/canonical-certs.pem</h2><blockquote>
<p>没有规则可制作目标“debian/canonical-certs.pem”，由“certs/x509_certificate_list” 需求。 停止。<br>[Makefile:1858：certs] 错误 2</p>
</blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211010225345232.png"></p>
<p>这个坑可以用下面这个方法解决：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim .config</span><br></pre></td></tr></table></figure>

<p>然后在vim的正常模式下直接输入<code>/debian</code>然后回车就能定位到这个字符串上，把该字符串的值改为空</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211010225809246.png"></p>
<p>然后用<code>:w !sudo tee %</code>强行保存修改，最后<code>:q!</code>就好了</p>
<h2 id="make次数过多导致No-space-left-on-device"><a href="#make次数过多导致No-space-left-on-device" class="headerlink" title="make次数过多导致No space left on device"></a>make次数过多导致No space left on device</h2><blockquote>
<p>嗨呀，这个问题的根本原因就是虚拟机空间给少了，下面的方法只能缓解一下，建议扩容</p>
<p><a href="https://blog.csdn.net/orange_612/article/details/79597905">这里是网上搜的扩容教程</a>，没实践过，请自行操作</p>
</blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211010230837626.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211010230904891.png"></p>
<blockquote>
<p>通过这个文章解决的<a href="https://www.cnblogs.com/kaishirenshi/p/11343983.html">https://www.cnblogs.com/kaishirenshi/p/11343983.html</a></p>
<p>**<u>/dev/mapper/是挂载在Linux的根目录的（Mounted on /）</u>**，所以不是Ubuntu的如果是这个路径出问题的，<del>应该也是这样解决吧</del></p>
</blockquote>
<h3 id="可以清理一下-dev-loop"><a href="#可以清理一下-dev-loop" class="headerlink" title="可以清理一下/dev/loop*"></a>可以清理一下/dev/loop*</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt autoremove --purge snapd</span><br></pre></td></tr></table></figure>



<h3 id="可以直接扩容"><a href="#可以直接扩容" class="headerlink" title="可以直接扩容"></a>可以直接扩容</h3><p>给ubuntu–vg-ubuntu–lv扩容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lvresize -A n -L +20G /dev/mapper/ubuntu--vg-ubuntu--lv</span><br><span class="line">resize2fs -p /dev/mapper/ubuntu--vg-ubuntu--lv</span><br></pre></td></tr></table></figure>

<h3 id="也可以删文件解决"><a href="#也可以删文件解决" class="headerlink" title="也可以删文件解决"></a>也可以删文件解决</h3><p>首先<code>cd /</code>到根目录，然后<code>sudo  du -h -x --max-depth=1</code>就能找到下一级目录哪个文件夹，这样一级级找下去，在本文的范围内，不出意外应该是<code>/usr/src/</code>里的那个源码文件夹最大了，所以要不就给虚拟机更多空间，要不就从头开始，直接一开始就把<code>debian/canonical-certs.pem</code>删掉，这样就能一次通过<code>make</code>了，<del>大概</del></p>
<p>先<code>cd /usr/src/</code>，再rm掉源码文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo rm -rf linux-5.14.9//换成自己的文件夹名字</span><br></pre></td></tr></table></figure>

<p>然后再<code>cd /</code>，执行<code>df -h</code>，这时候占用应该就正常了</p>
<h2 id="完结撒花🎉"><a href="#完结撒花🎉" class="headerlink" title="完结撒花🎉"></a>完结撒花🎉</h2>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>kernel</tag>
      </tags>
  </entry>
  <entry>
    <title>锁与Reflex空想</title>
    <url>/2021/12/08/Linux-4th/</url>
    <content><![CDATA[<h2 id="4-1-程序分析题：锁"><a href="#4-1-程序分析题：锁" class="headerlink" title="4.1 程序分析题：锁"></a>4.1 程序分析题：锁</h2><blockquote>
<ul>
<li>基于标志(flag)的锁实现方式：</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> __<span class="title">lock_t</span> &#123;</span> <span class="keyword">int</span> flag; &#125; <span class="keyword">lock_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">lock_t</span> *mutex)</span> </span>&#123;</span><br><span class="line">     <span class="comment">// 0 -&gt; lock is available, 1 -&gt; held</span></span><br><span class="line">     mutex-&gt;flag = <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">lock</span><span class="params">(<span class="keyword">lock_t</span> *mutex)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">while</span> (mutex-&gt;flag == <span class="number">1</span>) <span class="comment">// TEST the flag   </span></span><br><span class="line">     ; <span class="comment">// spin-wait (do nothing)</span></span><br><span class="line">     mutex-&gt;flag = <span class="number">1</span>;         <span class="comment">// now SET it!             </span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">(<span class="keyword">lock_t</span> *mutex)</span> </span>&#123;</span><br><span class="line">    mutex-&gt;flag = <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4-1-1"><a href="#4-1-1" class="headerlink" title="4.1.1"></a>4.1.1</h3><blockquote>
<p>第10行的注释，spin-wait，是什么意思？</p>
</blockquote>
<p>自旋等待，当执行lock时，就会什么都不干，不断的检测flag</p>
<h3 id="4-1-2"><a href="#4-1-2" class="headerlink" title="4.1.2"></a>4.1.2</h3><blockquote>
<p>假设没有底层硬件或操作系统的相关支持，该锁用于进程间的互斥则其实现方式 会有什么问题？请详细说明。</p>
</blockquote>
<p>没有底层硬件和操作系统的支持，无法保证操作原子性，就是执行完A进程的某一行代码，就有去执行B进程的，没有完整的执行完一个进程的代码，例如上面的代码，可能会导致两个进程同时被锁。</p>
<p>原本应该一体的flag设置和检测的原子性无法得到保证，可能会被分开执行。</p>
<hr>
<blockquote>
<ul>
<li><p>Test-and-Set原子指令的实现逻辑</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">TestAndSet</span><span class="params">(<span class="keyword">int</span> *old_ptr, <span class="keyword">int</span> <span class="keyword">new</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> old = *old_ptr; <span class="comment">//fetch old value at old_ptr</span></span><br><span class="line">    *old_ptr = <span class="keyword">new</span>;     <span class="comment">//store ‘new’ into old_ptr</span></span><br><span class="line">    <span class="keyword">return</span> old;         <span class="comment">//return the old value</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>基于Test-and-Set指令的锁实现方式：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> __<span class="title">lock_t</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> flag;</span><br><span class="line">&#125; <span class="keyword">lock_t</span>;</span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">lock_t</span> *lock)</span> </span>&#123;</span><br><span class="line">     <span class="comment">// 0: lock is available, 1: lock is held</span></span><br><span class="line">     lock-&gt;flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lock</span><span class="params">(<span class="keyword">lock_t</span> *lock)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (TestAndSet(&amp;lock-&gt;flag, <span class="number">1</span>) == <span class="number">1</span>)</span><br><span class="line">    ; <span class="comment">// spin-wait (do nothing)</span></span><br><span class="line">&#125;</span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">(<span class="keyword">lock_t</span> *lock)</span> </span>&#123;</span><br><span class="line">    lock-&gt;flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<h3 id="4-1-3"><a href="#4-1-3" class="headerlink" title="4.1.3"></a>4.1.3</h3><blockquote>
<p>“基于 Test-and-Set”指令的锁实现方式，是否可以解决 4.1.2 中，“基于标志 （flag）的锁实现方式”所存在的问题，为什么?</p>
</blockquote>
<p>一个Test-and-Set(TAS)指令包括两个子步骤，<strong>把给定的内存地址设置为1，然后返回之前的旧值。</strong><br>这两个子步骤在硬件上实现为一个<strong>原子操作</strong>，执行期间不会被其他处理器打断。</p>
<p>当第一个线程执行这段代码时，TAS指令会立即把lock设置为1，并返回0 ，线程退出while循环进入临界区。<br>如果另一个线程尝试进入临界区，TAS会把lock设置为1，但是也会返回1(由第一个线程的TAS指令设置为1)，<br>此时第二个线程会一直while循环(忙等待)，直到第一个线程退出临界区代码，执行了lock=0，即释放了锁。</p>
<p>所以TAS操作要么同时完成检测和设置操作，要么就都不做，可以解决上一个方式存在的问题。</p>
<h3 id="4-1-4"><a href="#4-1-4" class="headerlink" title="4.1.4"></a>4.1.4</h3><blockquote>
<p>假设系统中有 2 个线程 X 和 Y（优先级相同），它们之间通过“CPU 时间片轮转 调度策略”来分享底层唯一的一个 CPU 资源。其中，X 在某个时刻通过图 3 的 lock()获取 到了锁，并且需要运行 10 个时间片才会调用 unlock()来释放锁。请问，在此时间段内，Y 会分到时间片吗? 如果可以分到，那么 Y 是个什么运行形态? 此运行形态会带来什么样的负面效果?</p>
</blockquote>
<p>因为调度规则已经指定为时间片轮转调度，而且CPU资源只有一个，所以当X在某个时刻通过lock获得了锁，在X的时间片结束以后，X就会被CPU移到就绪队列的队尾，此时Y便会开始执行，但是X还占据着锁，所以即使Y分到了时间片，也只会因为没有获取到锁而一直循环等待，占用着CPU，直到时间片用完，然后又轮到X，不断循环这个过程，等X运行完10个时间片，就能运行Y了。这会造成CPU利用率低的问题，而且执行等待的空指令也会带来额外的开销，造成资源浪费。</p>
<hr>
<blockquote>
<p>基于Linux的“Futex”锁实现方式：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mutex_lock</span><span class="params">(<span class="keyword">int</span> *mutex)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v;</span><br><span class="line">  <span class="comment">/* Bit 31 was clear, we got the mutex (the fastpath) */</span></span><br><span class="line">  <span class="keyword">if</span> (atomic_bit_test_set(mutex, <span class="number">31</span>) == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  atomic_increment(mutex);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;   </span><br><span class="line">    <span class="keyword">if</span> (atomic_bit_test_set(mutex, <span class="number">31</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">      atomic_decrement(mutex);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* We have to waitFirst make sure the futex value</span></span><br><span class="line"><span class="comment">    we are monitoring is truly negative (locked). */</span></span><br><span class="line">    v = *mutex;</span><br><span class="line">    <span class="keyword">if</span> (v &gt;= <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    futex_wait(mutex, v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mutex_unlock</span><span class="params">(<span class="keyword">int</span> *mutex)</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* Adding 0x80000000 to counter results in 0 if and</span></span><br><span class="line"><span class="comment">  only if there are not other interested threads */</span></span><br><span class="line">  <span class="keyword">if</span> (atomic_add_zero(mutex, <span class="number">0x80000000</span>))  </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* There are other threads waiting for this mutex,</span></span><br><span class="line"><span class="comment">   wake one of them up. */</span></span><br><span class="line">  futex_wake(mutex); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4-1-5"><a href="#4-1-5" class="headerlink" title="4.1.5"></a>4.1.5</h3><blockquote>
<p>该图中的第 4～5 行，和图中的第 8～11 行，具体实现什么作用? 它们是否有功 能冗余和冲突? 可以去掉当中的一个吗? 为什么? </p>
</blockquote>
<ul>
<li>4～5行，一个尝试获取锁的过程，自旋一次，若能获取，则该线程直接返回</li>
<li>8～11行，在被<code>futex_wait</code>沉睡的线程经过<code>unlock</code>后被<code>futex_wake</code>唤醒，再通过TAS操作获得锁</li>
<li>不能去掉其中的一个，在这两段代码中有一句<code>atomic_increment(mutex);</code>，这句话的作用是一个线程在执行<code>futex_lock</code>时，如果一开始没有在4～4行获得锁，则需要等待，并加入到等待队列，8～11行的代码的作用是让被唤醒的线程获取到锁退出，两者是互相配合的。</li>
</ul>
<h3 id="4-1-6"><a href="#4-1-6" class="headerlink" title="4.1.6"></a>4.1.6</h3><blockquote>
<p>在第 24～25 行中的 if 语句是用来干什么的? 如果条件语句 <code>atomic_add_zero (mutex, 0x80000000)</code> 为真，为什么要直接 return，为什么不直接执行第 29 行程序呢? </p>
</blockquote>
<ul>
<li><p>假如没有这个<code>if (v &gt;= 0)</code>语句，若线程A没有获取到锁，当它还没执行到<code>futex_wait</code>时，线程C<code>unlock</code>了，此时等待队列为空，则mutex到最高位为0，<code>futex_wake</code>不会被调用，此时线程B会进入<code>futex_wait</code>,会导致线程B无法被唤醒。</p>
<p>有了这个if语句以后，当最高位变为0以后，muetx也会变为0，线程B会进入if语句后执行<code>continue</code>，在接下来的循环里，B会获得C释放的锁，就不会阻塞。</p>
</li>
<li><p>若<code>atomic_add_zero(mutex, 0x80000000)</code>为真，则说明等待队列长度为0，此时就没有线程需要<code>futex_wake</code>了，直接<code>return</code>可以减少系统调用的开销。</p>
</li>
</ul>
<h3 id="4-1-7"><a href="#4-1-7" class="headerlink" title="4.1.7"></a>4.1.7</h3><blockquote>
<p>图 4 所展示的 Futex 锁实现方式，是否改进了 4.1.4 问题中提到的负面效果，为什么?</p>
</blockquote>
<p>可以改进上面提到的负面效果，利用<code>futex_wait</code>可以让没有锁的线程睡眠，让有锁的线程占用CPU，更快完成任务，避免CPU不必要的浪费，避免不必要的线程进入CPU调度，可以提高性能。</p>
<hr>
<h2 id="4-2-运用系统思维对热门计算机技术进行分析和介绍"><a href="#4-2-运用系统思维对热门计算机技术进行分析和介绍" class="headerlink" title="4.2 运用系统思维对热门计算机技术进行分析和介绍"></a>4.2 运用系统思维对热门计算机技术进行分析和介绍</h2><blockquote>
<p>4.2.1 OK，现在轮到各位同学运用系统思维对英伟达公司的另外一个亮点 游戏技术 Nvidia Reflex 进行分析和介绍。</p>
</blockquote>
<p>快乐游戏最重要的自然是画质和流畅度啦，不过要想打出好的操作，抛开个人技术不谈，低延迟才是王道。在玩网络游戏时，如果网络不好，就会造成高延迟，比如上一秒敌人还在这个位置，你丢了一个技能过去，下一秒你发现敌人其实早就去了另一个位置。又比如你突然发现无论怎么操作，角色都定住不动了，都是高延迟的表现，这种人我们一般称之为高ping战士。</p>
<p>单机游戏自然不存在网络延迟，但是设备所带来的系统延迟是无法避免的 。从点击键盘或鼠标到屏幕上渲染出来，要经过好几个步骤。</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211209105637773.png"></p>
<p>英伟达推出的这个 Nvidia Reflex 技术主要解决的是图里PC这个部分的问题。 Nvidia Reflex主要包括两个部分：</p>
<blockquote>
<ul>
<li><strong>低延迟技术：</strong><ul>
<li><strong>NVIDIA Reflex SDK</strong> – 开发者 SDK，用于启用 NVIDIA Reflex 低延迟模式，从而在 GPU 密集型场景中降低延迟</li>
<li><strong>延迟优化的驱动控制面板设置</strong> – 增强的“首选最高性能”模式和“超低延迟”模式</li>
<li><strong>GeForce Experience 性能优化</strong> – 一键式 GPU 超频自动优化工具</li>
</ul>
</li>
<li><strong>延迟测量工具：</strong><ul>
<li><strong>NVIDIA Reflex SDK 指标</strong> – 游戏和渲染延迟标记使开发者能够在游戏中显示延迟指标</li>
<li><strong>NVIDIA Reflex 延迟分析器</strong> – 360Hz G-SYNC 显示器的新功能率先实现了完整的端到端的系统延迟测量</li>
<li><strong>GeForce Experience 性能监控</strong> – 提供侧栏和游戏中叠加显示，可显示包括延迟在内的实时性能指标</li>
</ul>
</li>
</ul>
</blockquote>
<p>而重点分析的肯定是<strong>NVIDIA Reflex SDK</strong>，其他的只不过是一些设置，关键部分还是这个<strong>SDK</strong>。</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211209201501001.png"></p>
<p>从这张图可以看出，从点击外设开始，先经过CPU再经过渲染队列，再通过GPU渲染才会呈现在屏幕上，SDK就是通过调控CPU和GPU的平衡来更快的处理渲染队列降低系统延迟，从而消除 GPU 渲染排队现象。</p>
<p>竞技游戏瞬息万变，因此会在受限于GPU和受限于CPU之间来回转换。根据这篇文章写的，应该是分为了两种情况：</p>
<ul>
<li>游戏受 GPU 限制，这时候就会避免GPU作业大量排队。CPU 处理帧的速度快于 GPU 渲染帧的速度，造成了这种作业积压，从而导致渲染延迟增加。</li>
<li>游戏受 CPU 限制。Reflex SDK 将通过保持较高的 GPU 时钟频率来确保较低的延迟。</li>
</ul>
<p>本质上来说，其实就是开发者在游戏中使用了SDK，这可以更好的控制CPU的运行速度，使其无法提前运行，这样就不会提交更多的任务给GPU，但是又要及时的提交作业，让GPU没有空闲时间，让CPU作业时间稍微延后，就能降低延迟，这就叫减少CPU反压。而在流程的内部，出现帧与帧之间排队也是司空见惯的。例如游戏引擎与渲染器上的最终GPU工作之间，实际上有数个待处理的帧正在排队，从而造成了延迟，这时候可能是GPU处理帧的速度赶不上CPU提交渲染请求的速度，这样就造成了CPU的反压。因此适当的丢掉一些无效的渲染请求就可以优化延迟。同样，在受GPU限制下，CPU也必须等待上一帧处理完成后，才能产生下一帧。</p>
<p>从网上看到一张有趣的图</p>
<p><img src="https://pic3.zhimg.com/80/v2-ceb6933f2bfa1a2be3b24e82885e4b56_1440w.jpg" alt="img"></p>
<p>其实NVIDIA Reflex技术就是用来缓解CPU与GPU之间的尴尬处境，消除GPU渲染队列。消除CPU渲染的“无用帧”，消除后压，并可立刻传送至显卡进行渲染。</p>
<p>在以前，如果没有Reflex，要想获得更低的输入延迟，你需要通过游戏自带的帧率限制器，因为通过限制帧率，我们机器上的GPU瓶颈被释放了，GPU渲染的速度更快，所以压力就不会到CPU这里。在这里Reflex可以保证帧率，同时也可以有效地减少你的输入延迟，因为它会动态地自我调整。原理是一样的，通过软件驱动层面，协调CPU和GPU的关系是非常重要的，就像CPU和内存的关系一样。</p>
<p>Reflex技术可以更好的从游戏中控制CPU的运行速度（估计是直接通过操作系统来操作我们CPU的工作流程），使CPU不能超前运行。并允许CPU及时向GPU提交作业，然后让GPU在作业管道中没有任何空闲的间隙来处理作业。而且，通过稍微推迟CPU作业的开始时间，为尽可能地对最后一毫秒的输入进行采样创造了机会，从而进一步减少了延迟。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Reflex</tag>
      </tags>
  </entry>
  <entry>
    <title>第一款为自己打造的app初步感想</title>
    <url>/2022/06/21/ThinkToMyFirstApp/</url>
    <content><![CDATA[<h1 id="首先是还没想好的app名字"><a href="#首先是还没想好的app名字" class="headerlink" title="首先是还没想好的app名字"></a>首先是还没想好的app名字</h1><h2 id="1-先放一个演示视频吧"><a href="#1-先放一个演示视频吧" class="headerlink" title="1.先放一个演示视频吧"></a>1.先放一个演示视频吧</h2>
<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
<iframe src="//player.bilibili.com/player.html?aid=385208144&bvid=BV1DZ4y1v7Yo&cid=753338307&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; Left: 0; top: 0;" ></iframe></div>


<p><del>此处偷偷吐槽一下垃圾微信视频号，视频比例都没适配好，把我的演示视频直接裁剪了。</del></p>
<h2 id="2-介绍（尬吹）"><a href="#2-介绍（尬吹）" class="headerlink" title="2.介绍（尬吹）"></a>2.介绍（尬吹）</h2><ol>
<li>适配了深色模式，2022年了还有不适配的app吗（不会吧不会吧不会吧</li>
<li>目前做的部分有精美的UI和流畅的动画（存疑</li>
<li>目前只有日记功能</li>
</ol>
<blockquote>
<p>UI部分参考了iOS上的天天豆，强推</p>
</blockquote>
<h2 id="3-todo（画大饼）"><a href="#3-todo（画大饼）" class="headerlink" title="3.todo（画大饼）"></a>3.todo（画大饼）</h2><ul>
<li><p><input checked="" disabled="" type="checkbox">  已完成功能</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 精美UI（bushi</li>
<li><input checked="" disabled="" type="checkbox"> 流畅动画</li>
<li><input checked="" disabled="" type="checkbox"> 日记基本功能</li>
<li><input checked="" disabled="" type="checkbox"> 基本框架</li>
<li><input checked="" disabled="" type="checkbox"> 深色模式</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox">  加入todo功能</p>
<ul>
<li><input disabled="" type="checkbox"> tablayout切换完成以及未完成列表</li>
<li><input disabled="" type="checkbox"> 有截止日期，提醒功能</li>
<li><input disabled="" type="checkbox"> 有分类功能</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox">  加入统计功能</p>
<ul>
<li><input disabled="" type="checkbox"> 对每月以及每年进行心情趋势分布统计</li>
<li><input disabled="" type="checkbox"> 对每月完成的todo进行统计</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox">  加入设置功能</p>
<ul>
<li><p><input disabled="" type="checkbox">  加入定时提醒写日记功能</p>
</li>
<li><p><input disabled="" type="checkbox">  自由切换深色模式</p>
</li>
<li><p><input disabled="" type="checkbox">  加入自定义主题</p>
</li>
<li><p><input disabled="" type="checkbox">  适配material3动态颜色</p>
</li>
<li><p><input disabled="" type="checkbox">  账号功能</p>
</li>
<li><p><input disabled="" type="checkbox">  云存档</p>
</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox">  完善日记功能</p>
<ul>
<li><input disabled="" type="checkbox"> 设置每日只能同时存在一份日记</li>
<li><input disabled="" type="checkbox"> 添加每月分类</li>
<li><input disabled="" type="checkbox"> 优化滑动卡顿</li>
<li><input disabled="" type="checkbox"> 修改为每日与每月查看模式</li>
</ul>
</li>
</ul>
<hr>
<h2 id="4-初步骚操作记录"><a href="#4-初步骚操作记录" class="headerlink" title="4.初步骚操作记录"></a>4.初步骚操作记录</h2><h5 id="1-bottomnavigationview取消item选择"><a href="#1-bottomnavigationview取消item选择" class="headerlink" title="1.bottomnavigationview取消item选择"></a>1.bottomnavigationview取消item选择</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/uncheckedItem&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:title</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:visible</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br></pre></td></tr></table></figure>

<p>只要添加一个空的隐藏的item，就可以使没选中的item变成初始状态，因为我采用了两个bottomnavigationview，将四个item平均分了，为了fab的效果，用了这种方式，然后再监听目前的fragmnet来控制效果,然后再设置相关的边距</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//控制BottomNavigationView和fab的效果</span></span><br><span class="line">    navController.addOnDestinationChangedListener &#123; _, destination, _ -&gt;</span><br><span class="line">        <span class="keyword">when</span>(destination.id) &#123;</span><br><span class="line">            R.id.navigation_home -&gt; &#123;</span><br><span class="line">                binding.navView.updatePadding(right = DensityUtil.dip2px(context,<span class="number">50f</span>))</span><br><span class="line">                binding.navView2.updatePadding(left = DensityUtil.dip2px(context,<span class="number">50f</span>))</span><br><span class="line">                binding.bottomAppBar.fabAlignmentMode = FAB_ALIGNMENT_MODE_CENTER</span><br><span class="line">                binding.navView2.menu.findItem(R.id.uncheckedItem).isChecked = <span class="literal">true</span></span><br><span class="line">                binding.fab.setImageDrawable(getDrawable(R.drawable.ic_baseline_done_all_24))</span><br><span class="line">                binding.fab.show()</span><br><span class="line">            &#125;</span><br><span class="line">            R.id.navigation_dashboard -&gt; &#123;</span><br><span class="line">                binding.fab.setImageDrawable(getDrawable(R.drawable.ic_baseline_add_24))</span><br><span class="line">                binding.navView.updatePadding(right = DensityUtil.dip2px(context,<span class="number">50f</span>))</span><br><span class="line">                binding.navView2.updatePadding(left = DensityUtil.dip2px(context,<span class="number">50f</span>))</span><br><span class="line">                binding.navView2.menu.findItem(R.id.uncheckedItem).isChecked = <span class="literal">true</span></span><br><span class="line">                binding.bottomAppBar.fabAlignmentMode = FAB_ALIGNMENT_MODE_CENTER</span><br><span class="line">                binding.fab.show()</span><br><span class="line">            &#125;</span><br><span class="line">            R.id.navigation_charts -&gt; &#123;</span><br><span class="line">                binding.navView.setPadding(<span class="number">0</span>)</span><br><span class="line">                binding.navView2.setPadding(<span class="number">0</span>)</span><br><span class="line">                binding.navView.menu.findItem(R.id.uncheckedItem).isChecked = <span class="literal">true</span></span><br><span class="line">                binding.fab.hide()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            R.id.navigation_settings -&gt; &#123;</span><br><span class="line">                binding.navView.setPadding(<span class="number">0</span>)</span><br><span class="line">                binding.navView2.setPadding(<span class="number">0</span>)</span><br><span class="line">                binding.navView.menu.findItem(R.id.uncheckedItem).isChecked = <span class="literal">true</span></span><br><span class="line">                binding.fab.hide()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-监听添加与修改日记"><a href="#2-监听添加与修改日记" class="headerlink" title="2.监听添加与修改日记"></a>2.监听添加与修改日记</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//作为接收recyclerview添加以及修改结果的中转站</span></span><br><span class="line"><span class="meta">@Deprecated(<span class="meta-string">&quot;Deprecated in Java&quot;</span>)</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityResult</span><span class="params">(requestCode: <span class="type">Int</span>, resultCode: <span class="type">Int</span>, <span class="keyword">data</span>: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, <span class="keyword">data</span>)</span><br><span class="line">    <span class="keyword">when</span> (requestCode) &#123;</span><br><span class="line">        <span class="number">1</span> -&gt; <span class="keyword">if</span> (resultCode == RESULT_OK) &#123;</span><br><span class="line">            diaryViewModel.addDiaryItem = <span class="keyword">data</span>?.getParcelableExtra(<span class="string">&quot;addDiary&quot;</span>)!!</span><br><span class="line">            diaryViewModel.addPosition.value = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="number">2</span> -&gt;  &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">data</span>?.getStringExtra(<span class="string">&quot;position&quot;</span>).toString() != <span class="string">&quot;null&quot;</span>)&#123;</span><br><span class="line">                diaryViewModel.reviseDiaryItem = <span class="keyword">data</span>?.getParcelableExtra(<span class="string">&quot;reviseDiary&quot;</span>)!!</span><br><span class="line">                diaryViewModel.setPosition(position = <span class="keyword">data</span>.getStringExtra(<span class="string">&quot;position&quot;</span>)?.toInt() ?: -<span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在viewmodel里设置两个值，通过observe这两个值来通知fragment，话说应该有很多其他方法来做这件事，比如广播，handler之类的，不过我这种应该也不算很烂吧</p>
<h5 id="3-在adapter外部获取点击事件"><a href="#3-在adapter外部获取点击事件" class="headerlink" title="3.在adapter外部获取点击事件"></a>3.在adapter外部获取点击事件</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//点击事件接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ItemListenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">deleteItemClick</span><span class="params">(position: <span class="type">Int</span>)</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">reviseItemClick</span><span class="params">(position: <span class="type">Int</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> itemListenter: ItemListenter? = <span class="literal">null</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setOnItemClickListener</span><span class="params">(itemListenter: <span class="type">ItemListenter</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.itemListenter = itemListenter</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在onCreateViewHolder里调用</span></span><br><span class="line">itemListenter?.deleteItemClick(position)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//recyclerview点击接口回调</span><br><span class="line">adapter.setOnItemClickListener(object : DiaryAdapter.ItemListenter &#123;</span><br><span class="line">    override fun deleteItemClick(position: Int) &#123;</span><br><span class="line">        diaryViewModel.deleteDiary(position)</span><br><span class="line">        adapter.notifyItemRemoved(position)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun reviseItemClick(position: Int) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这样就可以拿到recyclerview里对应的position了，其实感觉弄个下拉刷新更方便，不过实时刷新肯定更好啦</p>
<h5 id="4-在adapter里获取actvity"><a href="#4-在adapter里获取actvity" class="headerlink" title="4.在adapter里获取actvity"></a>4.在adapter里获取actvity</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiaryAdapter</span></span>(<span class="keyword">val</span> diaryList: List&lt;Diary&gt;,<span class="keyword">val</span> activity: Activity) : RecyclerView.Adapter&lt;DiaryAdapter.ViewHolder&gt;()&#123;</span><br></pre></td></tr></table></figure>

<p>在构造函数里加入activity参数，调用的时候传进来就好了</p>
<h5 id="5-imageview图片展示效果"><a href="#5-imageview图片展示效果" class="headerlink" title="5.imageview图片展示效果"></a>5.imageview图片展示效果</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">android:adjustViewBounds=&quot;true&quot;</span><br><span class="line">android:scaleType=&quot;fitXY&quot;</span><br></pre></td></tr></table></figure>

<p>在xml里设置这两个就能按原比例完整的展示图片了，为了这个弄了好久，最后发现原生的就行。。。<del>我恨网上鱼龙混杂的垃圾教程</del></p>
<h5 id="6-关于ConstraintLayout的黑科技"><a href="#6-关于ConstraintLayout的黑科技" class="headerlink" title="6.关于ConstraintLayout的黑科技"></a>6.关于ConstraintLayout的黑科技</h5><p>这个布局真的是功能强大，在lnm被小程序折磨以后如是说道，熟悉用法以后真的很强大</p>
<h6 id="1-首先就是这个barrier功能"><a href="#1-首先就是这个barrier功能" class="headerlink" title="1.首先就是这个barrier功能"></a>1.首先就是这个barrier功能</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.Barrier</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;1dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:barrierDirection</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/barrier1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:constraint_referenced_ids</span>=<span class="string">&quot;delete_image,diarycard_mood,materialCardView&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<p>可以把所需的控件包在里面，然后其他的就只能被挡在另一个方向了，对于复杂布局还是很有用的</p>
<h6 id="2-其次便是Guideline功能"><a href="#2-其次便是Guideline功能" class="headerlink" title="2.其次便是Guideline功能"></a>2.其次便是Guideline功能</h6><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.Guideline</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/guideline2&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintGuide_percent</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>就是一个辅助线的功能，目前我用来定位水平中心，直接0.5就能到中心，舒舒服服</p>
<hr>
<p>应该差不多就是这些了，后面就是慢慢加新功能了。。。。</p>
]]></content>
      <categories>
        <category>项目</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>git使用命令</title>
    <url>/2021/09/14/git/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>暑假的时候看了<a href="https://www.liaoxuefeng.com/wiki/896043488029600">廖雪峰</a>写的git使用教程，这学期要频繁使用，所以特地记录下来。</p>
<p>基本就是从廖雪峰的网站里摘抄的，供自己翻阅。</p>
<h1 id="命令使用技巧"><a href="#命令使用技巧" class="headerlink" title="命令使用技巧"></a>命令使用技巧</h1><h2 id="1-创建Git仓库"><a href="#1-创建Git仓库" class="headerlink" title="1.创建Git仓库"></a>1.创建Git仓库</h2><p>​        </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init //初始化Git仓库</span><br><span class="line">git add //添加文件进Git仓库</span><br><span class="line">git commit -m //提交文件到仓库</span><br><span class="line">git add --all //把所有文件添加进仓库</span><br></pre></td></tr></table></figure>



<h2 id="2-时光机穿梭"><a href="#2-时光机穿梭" class="headerlink" title="2.时光机穿梭"></a>2.时光机穿梭</h2><p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/jeOUv6.png" alt="add 和 commit"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git log //查看提交日志</span><br><span class="line">git reset --hard //回退到对应版本号</span><br><span class="line">git reflog //查看每一次命令，可以查看回退前的版本号</span><br><span class="line">git status //查看仓库状态</span><br><span class="line">git diff HEAD -- //可以看工作区和版本库里面最新版本的区别</span><br><span class="line">git checkout -- //回退到最近一次commit或add的状态，即用版本库里的替换工作区的版本</span><br><span class="line">git reset HEAD //如果添加到了暂存区，先reset再checkout</span><br><span class="line">git rm //删除文件</span><br></pre></td></tr></table></figure>

<h2 id="3-远程库"><a href="#3-远程库" class="headerlink" title="3.远程库"></a>3.远程库</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add origin git@server-name:path/repo-name.git //关联远程库</span><br><span class="line">git push -u origin master //第一次推送master分支的内容</span><br><span class="line">git push origin master //推送最新修改</span><br><span class="line">git clone //克隆仓库</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/4p7A1R.png" alt="同时关联gitee和github"></p>
<h2 id="4-分支管理"><a href="#4-分支管理" class="headerlink" title="4.分支管理"></a>4.分支管理</h2><p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/SIZDdg.png" alt="多人协作"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git branch //查看分支</span><br><span class="line">git branch &lt;name&gt; //创建分支</span><br><span class="line">git checkout &lt;name&gt;或者git switch &lt;name&gt; //切换分支</span><br><span class="line">git checkout -b &lt;name&gt;或者git switch -c &lt;name&gt; //创建加切换分支</span><br><span class="line">git merge &lt;name&gt; //合并某分支到当前分支</span><br><span class="line">git branch -d &lt;name&gt; //删除某分支</span><br><span class="line">git log --graph //查看分支合并图</span><br><span class="line">git stash //暂时储藏当前工作区</span><br><span class="line">git stash apply //恢复stash内容，不删除</span><br><span class="line">git stash pop //恢复且删除</span><br><span class="line">git remote -v //查看远程库</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-标签管理"><a href="#5-标签管理" class="headerlink" title="5.标签管理"></a>5.标签管理</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git tag &lt;tagname&gt; &lt;commit id&gt;//新建标签，默认为HEAD</span><br><span class="line">git log --pretty=oneline --abbrev-commit //查看commit id</span><br><span class="line">git tag -a &lt;tagname&gt; -m &quot;blablabla...&quot; //可以指定标签信息</span><br><span class="line">git tag //查看所有标签</span><br><span class="line">git show &lt;tagname&gt; //可以看标签信息</span><br><span class="line">git tag -d &lt;tagname&gt; //删除标签</span><br><span class="line">git push origin &lt;tagname&gt; //可以推送一个本地标签；</span><br><span class="line">git push origin --tags //可以推送全部未推送过的本地标签；</span><br><span class="line">git tag -d &lt;tagname&gt; //可以删除一个本地标签；</span><br><span class="line">git push origin :refs/tags/&lt;tagname&gt; //可以删除一个远程标签。</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>使用技巧</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>花束般的恋爱观后有感</title>
    <url>/2021/09/16/huashu/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="dc9084ba7b86cc1c4fb6490ca22000290608eb754f2fe3fb28eb8c1432424d97">baf00afd9fe9c9de8fa7f230fba25cf10342acb1b6894e4eeac0df067958b768e5f028ce396ecbbc35b73f9a7174618599178bab3f281ab11edc294ba1283650eba2721a72499a2605ab131ff9a737b1d4dfa8e1dc8434a3fd02d94c1891789f5bdd8c833771c861a126345ae691e636f598cac407c9872678a70147729b955fd42ee1d1bcf381a1afb6574b9da7a2110cc18aa468965dd58285d5837e9718ea9db39e36f01dbe89518443f0cfa3f7d716b79edca936335f1f13eb5ceb4bc8936aeab8d98aae8bafdd838c46a756719aef87846df73447959749e20b3b3251bf8d94c7fdd2df4cb4c2169d08d5ad3a6ead54c9f680f475b6d1a424f375a83322777d97d36e8e94c52165edcef34b63949f5aa339b58f82064a1295ea000d252062002ca36a3ddbe80312647a4c7787fcd7e7247ba0af9ff4776c890fe702615d490b8cf49bd61552e571b44c0946b1b31d33fd33f03f758c61162cbdbdde47b3ed33b4a4eda518c1dbe87429988b3e557d0d32318c4559283af5c51f6ca5dcc349f15c77bd431ef1399cf85547843406ddb585a752a7559bf9e6255d7fb918acf0f563dd1f26cbbf470806ceca753dbb71afc5d1babc9d7c2726adb9af0120f6bd0862da0c1cc038a1b34ce089758eef19fd18e4883f3253fd884eaaad39ac3a60d4ae7daefd0d99521dd884c400dc10d668ad9b5a69e12fe2f34b2d2daa96f8dd2a2328626e35481390adfb9187ea4cd559b921a3279aff310a0b533514372b963c9abf9a84a322c0a4bb65b56cace61f7cc5ed640c305174324d8d068f3471a407f419181630f295e77d34be68c5b5c23bf47f8ad480c787083682b49945dadc23e0a76ea267296dd129f1ac8b06792792192f3db7fd14a58536de3f66c27efcc06a00612b4b53e6ce9aa6c9b4c786dd49717dda22aaec61cbf39e3cad7ca70cc6e2ad187245d321e944b4d855f8271df28c8833ac0d61636a7184df9363f4f54d8f0281364884f19e77f2a98eb522657872a584b49903927561eafc974a78e3ce8e33e90e5538f03a60235d3543008dbba7c034e6b212c60ce6ef15f84a0faf7d3abb5994741da35b8373bcd3400f46f614fefeba0d2c1ee8788a69b42921688d01bbad812760a3b0d354d5a8f771130e1446f89edd60e377f2ca21c4157b0dc50ae063de89a4cdc0ed69be985748d60096bad79decd22ef609e4060e7fd469620d97aa35a548484585a3687bfd76dcc409c7cef4c8b7e9e398b857dcbab0a12f96a9bbac28b7c7605b0921bd5af634c34e8154d31485ef6e238075cb3ef1e9cb15ff823fd13d6818ad495619be4821ba24ebbb2f5dc8a03e28341c3e5971db37e2deefbccdec9626dfab2769d6db4be86f327c69f7ea7a355235287a181b6d9d958aef4f8c564addad07ed6abbea4cdbc0a8b0eeb080d0d7c05ca8730403138414566755ec077da2062f71995decc435dd7a75123b5e784f19f2b00a39c8a6b5fbc9608b1999d2ad408ad15d363dd79b1a115efced6c1461ce476c29a687b1354f66ced260a8e88a99c993723bb55da72747e3e8aa76e947584716351477fe876d0f164837d297c30473617bd724c4a9c0168a5ee302b08b185b392909bad8bc368b0ef373f0826bbf19ae24940f5f3fdb0c3719462e868dd607c1482e2ebdd1685890128f637aa502394b86e3579eebf614785da7c120f0981d0543475cb32230eb6888c6db4e81fa57dffb5a306392887565ee5582e55635dbfab1077c53d8b080f4c47768c338ef20c5b3027fabd4765c1a482b8e74fc7613e32e25675c156a8cff6b3ae24af15a5b27b0047cf593423c4f681682095ded401e76fcb102ab504bbd0ab54d86f9faa3da59e2a3c59a098c8b7cb90e8b5111909b82b285b6f8a705c30fff23a22259caeb63ca0cd540d872be4076c9b66c44ac39f6b0050770590a49501aedce2b2cb21fb947ba26912b328e20e5ce20ae163d239d2b8ce5767d9efdf25ab8e7aad61a28b5e583b1bc87271e8db5ec3cc64ea3ef15a1a2e33977210117fb4bd9c2aff5061837200061f4ae14df1496d7cbc27fcaa75c25b637366e2bab8bc5a3fb12cba60c68bdf813eb418948f9ccbad532a722eafc57c6c4ec5a891a0c232ec0609ed4342fe33fe1918cf1eba1a235df9228ba8b983ad493a8087621ed8910db6386d158f4d7b14897a536778bda22980a258613351153ed89e39c16a179161e9bcba431ec70ae7912f4ae99446ff9ad173d5134cfd6f377926871b7e8f86f8ea671efbd72ccfe174edda30e5c5fb629be12a44771e81bb8a96e499e8bc01bb87a69a67f96ff4676a3087ccaf75c2582524059900fb521fed4085ffdceb7acdf77c6300d4463052119dbc28eb3436b92779396de17fcd5b08f937ed422c25ae2923a4120e262afd63bd457f5e3ac79d357e4c935e78df912f5014d1a41e784578e4968273fa0f60319780d21ce4b777db2138da0c410c38d3f27949eaa599e64e610b58ac08bef78ba24ce7cdebff7988844f5504d2c98ffa5fb27d0195bbaae80f208ecf4c341986aa0bd33452c9d189e1e8cfa8970b4003b90417a1fb8d3da0190a8cbdcc4aa54a30fdef4d209d9e6a3f600cbe476b04839b0373681918c3304e373a61f3dc8b4b6d8ba34372c31997f66c2e5c006271103fd55e4122d3064af399fb8e573f1304f5c4e52ab82d8a64f539a817d88d3792594bee425723aec85e83886c50ce21fae08e2a49a30103629b1f97e3a1772cd95686445699ac3db142b7d5f0bc8719f563c2f6e24fb8eacf01a594bd380101ddc07d0e4e3c3243186f3f9ba5877ef0f5df619cc90f92e9e29d915e2dd194742f1ddf4909089dd38d8730066a2d8409efb4e5c8d68d9522a8ebd24bb5e768b1008bc1827971c90393801b5817156217d6620add235b7570352a9b85a7db8f0a5cbb0ed63f2bd56aa412449ca639613449d642375a24fd4e7b951ea49d79dab27331bc27f7b77d1ccb5ee49b56eabe2cec5c4a3d6ca7a4d5b5e1c6c6b5935200db10403eec975b1d27be979ec7225474fe289cf4cc6709ad57079610a9fb6f4c84be1c915bb5141aad76342cb5de3795ff4772a40a9d5046c405832bf843c85f895c6c477b34632143664f40233188941d0c47616f6d62cee05ed34c0942de136ba72bab0c2500359049e15955ce72772aab23a785fd49ff32f6eedb199acb1540ee50d1061724f03264c5f96362a1c8402b98affdb5cec5879b300dc612d131ecdb2f97d777b306c16f914dd28d7a9484ace56c37523a6bbc38d39b66df66b5791bb4209d5426c18dbf4ccccfe73d3c84d377e8637ff195d220bc2d3ae50a4ea5f55b193c141170d16fc40eb7657b4e4d3191e204ca1dacf57e94132b55cdb0ae4011bb8494a1ec6a13a304736348cf3b49d226dd52d34a71408ca29251339353971817ca873d4d8ecad9f73a92e9380c1745c82b6d5a405198557f9b2f2aab308d06166d1e7937e7439c63037d7591bd3a78be57f37e777099d750c000793d1cd3dd9cd5d907b97c707680f35dc5d87b1758932e6387de74d27ada59d5061d1874eae0ee34ed79099f468bb936a5ecb4962f888682d82b71e3de4ff951e74065bad6769871fe0a26b95342e0d0d0e1433253a8f017410f3a4c969b4ee3919bde3eb5f2630d21124ec279f2195bb0387e48b332f846cd6102ad5ebfba16d31aa2d363b21d9ae0154bab6efa047a4891bee75ebce83e1a970dbfeb913cc67800e0b73f92ccc80d1e42e599343e486532b5732a422cdbef838d24eacfcade909b27872aa3f21e51b66a489f8a482d2e1aff3ce0d9e89356ecb1b3bb0a6fe966f423b718a6f6b971d7d0551e951a81b7c6b99ad5ac73a0faa7eaa894683205572ae05b91c9c5a529c1ee1fda8265a3cb5185e9bfb9ee7d9ac059f91a047f14eab85a299c795d1a2bce9219d05b3b123922908cb95e7fac276549077d8a7815e0e3ead3998966672e51277c45ba0d2a8605a4c85a532583df862c0cc08870336e7ac27d42f658433d1f57a5836bdb34e87f8b4552c9b7929b7d57015034bfc17b930c37331e12caa2e49969451d414219811d84675dbb2db72c99e17b0a2ae3afc8a0bca7f62e10fcfa8578bae7765b382cc44392d62790a0e0e708680849600e963d08bbfe3e85eefc38151ad15e7244a764e3a6aceada8c737dc304ef38331fab497e46e00d096c5e0eb97e588b2f023813e456be2082d09e3f88bca71d82939d8227efc2fcf57aff267c71f8f7b2c27a3b90276b29e9dc0a542bbd4dfa5fff27b4d55275cd6801002ce1d1f04ebe63e78016e34968350f2d28f79db01bafea130da9f243c4f22989649e2cbe2be555d4ae1085d84f54e157e5c1adc0ad173559d90d88517bd474387769a0ba28edb3f817b1cea5a7fe2bece9ffc9697b9015086a21b765e23d028b5ea7d27db9bf9e609afbd87959e51b800ced8021b8483460f576de0b06d33bb468cde34df5a9034d9ea401022ccdf4d4ac9935f4c89fc3e717897bb6880aecea4083cae954d97a42510c55f505735924183bbb85134f8fa8d308bba387d54809d12ca2ff0d969dee2292dc61b3c02e47c2bbcb400e28b0966f9ae1f5b4c9d419fa6dd6887ca66ce8481d5ef5a338d277fa8bb94e62021e2a929bc34476437a826f99d2f11be1dd82258cf07b88fafa6cc86b1287ca9c95573bc100dacf31870174e7487020fa845d7cccab3ef252fa53668668412c8d97131bd9bfb3e679e17d88c0d9b8d67ff32e503903baf9059563b23be2cad7d42208458c3b72064bc46e544c3cb5727d781002e496f74932dda8296c3973c1f8488656755b4e0eb01bdb61f99de6e456db743fe0019170ab61edb1bdf8df67eda479e6c7d862e708fa50dabb5ce9946f977541faf5fd700a61d5a9bf5768fd41974d6a001d053b453e16c53d016eec23e43ef611d963655311852b050fa4343b3fa0289862b61e4beb1172464e28160c6972a09ac800e6a3b9fad4db8de17d8bd306be5558fccd0453411a7be5ce3bd53cfc28b1755a55162a14b40503cf23d27fa2697192af0c29fe006299a1c43eba2de60a06c7402ce31858cc48695a254ae1355bbbc2121d8ef252a2a973c567ffe59b5fbd2d3ba290ed735c29fb79a120930fe8e9feea3f94fbca331e752272cd3b85a8fa8e35cb044712dfa321d6c2334d99091d73ce65049a1aaffdc4a6223ef2a90a7bbc6b3c089b469ca72b49eaa5965807265078e648b4dd26face2583b4ce047a658e6b7bb651d609aee9a6190e65cf1191e085f075e169745adb22091aafb45388419aed71ea1272c1b04afdc8e38294e0d913eb304eea5d8222a9cffd5c5f06e763d03cbfbc05eb9d1f1788081115eb17ba9845346f1d41e5bc346af83d90fe0d3ff2dbfba26355ec4adf95d4e9ce30dfd5f8a4f2fb56acf43735a823f51bf21f7ac07a52a4a7f116ffb8be0123a51b508a4593f03ad403f028af5c02c82e75f7eed3a0b832d94631c1abe63c3e58e16c74499729b01e129be9d3e980e1ebc5722ce3a9c0657f032bf7f79cce0ed0a3f9aacdef2d9da3702143b66dc369e0f7e3e9fe2fe6d61d804fbe40a4c88eeddc6d53b9f0f85396752399ad2f8f4495f6de46df1cb64666081b5c434b938641dfbe40bb07deb455178d7e69a3318e6dd5bb2570fd5df54415ce07d9fb686df93a4d5b9007a17fa8cd48a697fb08910e51918c014975c24d21a041bd9a3904e43f50e4913962437ef45516bae8865386df1708bcaf0fcf582592079aed5fdd3fae4c1a639dfd84322fdbd07e15977389159c03aad976b35de8f76992053f25ef951614a521b0d6a0aae2b0be087224a26742e45b583a3dd688e4ab963455bea973573904c129b8d94ee1cb170b2699d71da3711d723df9044f6c6f28e9a16cc74c3c94da9e1fc1a904c414f790cc13e7cab2bc692fe77d0ea738b5872048f640c8f4fdfb3d40c9e6784e040c5bbcc0277318802c2843ccfe7419583772a18f8a36cb63aa7d65a928eaf1f89c7ec3c58b9794642e34a43676884d5f1abda3c3a6072bc4068a926e5d16801044257c2c2703ad483e7aa83e226fa17a738f5e2351f8a0994701005bd07b5305f21293158621b4ccb8a64f945d2a9cd33d28581d0ad61994a91e9270ef55282ca95a854aa4f240d916b7e04288155e775e48e68c801b488be70423b636c6ca8432f25da15cb008c7869e53c43e416a72d85dd4b5aa73f0fc9080c8e3eec82477105af0bd142ced31a007301b8805cf6bec74d2d7ad8717dea421f5981fae6a530180f17bb3485a37cd7e499d9ff28be3764be824669cf440f05548fe115b0ef90a88e36960109b254a178453322a22674f9fa11f2224f905327e89474e6e6916f326fd7d5621f41216876389231045946c030195aa14f1632d998a0e4b8fa64719368335ec0291fdcd8c42fcf95442be3f7a2352ea8c065ebd5043a7ba577d06a6c2251d127ed300855fb9aa272fa714e6f1f31aa157942f1ae9010ac8d52d75cc1f9b040ac04c24a08359bbcb219cccb051983c00ea61ae04343e628c393bd774923a35a344734fe55643c934942edecd8142726d35ef29b82b4346a924ecc19f3c35eccdaa1c174c38ef7bf52bc1ac8dd64cc175d224917fb678b17862138432ad190151a58a76a0fd06d2e850333aed0c2eadfeed502080de261e68e7f68cdaf1e749c98aabcb43ae9c10a508a67aaf1f21c22b29ea9073ba7184920431ff26e0350856ad98c1791d7cc2d2d030c6f48256ee9eaf271d22393d759a8ce822dd0e846c5c17884a3f4dc5390d0063d53e6209815eaf58fd02a6b72a602ce899ecc3b734d96b2df18b2671ae2fb1c42ef6b200019e0e13641f7c88087cedf6aa88ca177324ffdddaa248bb616a76f84001abba63af812437aad24fbdc59f61c52bd0905ea1e2db4faab4e80af5e091be0ab447f1038d95860546d1fd9739b5042defb336b02ba2ddb02a67b723a4509918a438bb7a474778adf63791c39a1df1fedbeb79443a3196434037d398713bfbb05e87a9845efcabfc392dd9c53ca9041d9b6b90555b383c4137fbb570e8acbd4e1132ff37c5a2490d837dd0fb908ceab4696fff167083e319729feab08c22865f201dafb4d1665fd0e8ae9fbe233a416a75787b5d58f5830402202ac17ce61fb7b947dfb0666cae93943cc2402c6cee521dcc90abe411954bcaeac8372e47d494c8162e5cfa74e1a06f46fa9792151912416f43ee9884d816a4fa2ab7dd1e87659e536fbe6ee4622c6ab31ae2be5fb5953644f35f8850d8d1e5507777f930ff3be6fd79fb2af21bcebee43467541fcca43d32272fd8897bd27902c99b9e2583ea7b379ad8ec03a4dcf8a3eb6e8feacd261ca1b295b2f2f22bb1fe75f4172cabb0f2b1c92cc3baf679282cc77f51b03cd2d09252060cf0a04b8036a84df77518d412edbc99b5c8e5313f3ad9195bb93b6207c2d284f4e23a394ee7fdfb60adc4e9760f2d511c189c8ca3311026ec42a2ff04199e0ed972a7688d5ea4936642366c52cb442be58c0e4d55a3a844801bdba310d7cc26714bf86effc5ba7b9a50a8c5a914b4e1de1e4044404dd71638ee1242518a38099fd4dfb838e5dc3a3603228ee99fe211db74e8d7df0675b00cebbf2f849a5450b0ad987b612840d62642315bc8bbbc0afc066f7da0d90e96545948efd6b513c77cb2e3d4aa8a05a56e0a6336c85c6192574f0ac865723df8dd94bbbec68c9caa98378c8938cba0034f3096af7016344d29cd83e014831f98a0bc8949d9d26a4c49ccc861a948e7c842aefbc0ab6a817e310f48c1189b45f75ef6db7a97538c7221f9d0f46d18e6295ad0512d99b27c5e5122971864418db5c8b4d675c50845a6daf980a64e65d7dfebb9caf54b4d3bab4aa664054ea44fbffa2fe4ee3df0665ac775ed90d4748cef08177e535c3f0d3c45fdd359ce04353bfd73e5d1fc3dab885a3a5883153e63a7a1817b2d21ffb924ad34aa1a663878bdf380a0ba41fee0aa2f2260506baa74ab1e7b04054085335b16cd4cfa355c7c4a42d0a70b07fc30e4ad9c3788e99a5963cc0f90093f44ecd89247c871ca6c5bb8805f586ee1753157d2bc8dee2ea155a0030b39746b5a8fe25c6ff47242f856652fe5972f737068bac95176e42b8a6df04f70f8eacbcee0156042be6d47e039ffbdaa355610adc3365b2bdadd8c7c19756fbc0127fd710509f92c38c1a4e38815109699ce37874020bcc39da45fe890e5c85eaf4b5ea61e61329a78f070cfa3fc07ac0fbc11f5943090e471932139f6ad485b7e8e7ed7c6556fceb5e35d4f8694771ee9e49236054eee3e0b803d750d55db93636afb3baac18fc283245f4c62882b1b54c4c008aecc95dd5180c64396a6de8379f0d235713929a2aef7e683d035bbef4da88dba54cccf62f8f6a67578a5b4b8e2daff08b18afb8e5f90b6fc1ed8db9bb7c63cf28b36ca03fb06f1fd8cb35ead12b14fe69f922d339261c15c7e048cecccf06645a2dce144a99a79b1ca2fb953a8a65ae5b05adaca89ad257494b4186a5138333cafe82af2d1b731057bc161924daf8741a5e67521b29bae25bf3ddfbfef1305fa0eb536154a0dcfc4dd62c286282184c2597097cb09a8ef45c67769e8b0f3c9efd39875c5cd723b204e4e35c18f5178ac056022d8c05d1ba87c2c02d2f1afb3af7d392980ddbec7f4e1e774d0abc384f2f7a64b082f72dbcc47172e0f628b7d8ee6f07cd37fc193dea6fb42c3286001792d4b72ff49e01c15aa2743f7bebf7b8702cbcb82c45b60dd41e431f202cedf82bb19a92cf679c813be59723e746b1b565bd28a7e35644b1a662e29b219e5e22c60a88bc9b32b4201018cba3aadf92d267fe335afa3208d24219da37547af97bec2cf82a17daf55ead1436a71c433783ec8ee8bfff4dc4fa91bd4d6feae48df15765c1c1bdf002bbd57f9a687adfd8b0e18c41bdef07dc5cc4e61848cb49b558da3f7b10eeae70e634ff0314b6dbb2dab8e36342f3884722cf444aadc432bd5f9fc0114b00f416f6911fb7a8a0616e864c071486f8eaad516cea56e3f100f50a19627ff29b27b09430844b6a13ea2b6cb09078c192d50ff7e3477419d28969f29dd000ee5ea220731127af3ca67e01c4b1f5d6e95d01041662d6e46bcdc7071386dea190d6c1d95a12122b547b166f744c0183522be24c5361fbb027003c48ac51b28da0253c306da3e8711e1a454995651196af217f945944bfe086db7d870b648d9b19012b8eae5b771145296408bd1e9ffb447eab791239136e3d6c62b9235a0c884e5c09f217afa953224271a7b401f00308f5c4ef745967da0abb7f241aa47a6f7a3ea5cb7837486bdea0c409bf5732412019f4a857f87936061ef263acf7e889cbb711d4d151c950997ba3ad301f257895e8a4f1d73d35552c37989aa0c5d6878d3500107d5718c642c40b18156bbbff7de20fa6324eeae5fdc43f5c656a28f8784c69048f7199a4b56656ef18aa28905cc4411e03a208f77cd410652f7dd3904aa8454dc629278a6a13064a254b7f24da5d4356ee5ca603be6a273a2738ec28cf3a336f0a274a2c124f5391ae3760b00957d8c45591f16f118796c8e0988757a595a1295e21a79eb441af3aa5394e06857c7fae34253d71627c613364342e62b9f1e6124f8b021f8f60251561faffea5b77926888a5fc58c91c849273a2612f90667bb89391dedbb0cdd693e8bc4016a4829c8db16094372bb34380f35d60589d550b11e9f6a4387681e4d310912a0a538731f32c5d7104f56c047edec1ae413b2c5111ab8d2bd41c840c2458e53fef978eb5700df47f2394d405cf5344d1d90dd12ebac2b2db2f3c1eeaf69f59f546384a5cdcb086d7338996ba38dac187b75ff61e5946724f3731086bc58d5abfdbf1a4a2f9f44b9a23d1b85e9d100f740905a0253cfc3ff20301b71d223a0132421c4ef4faee2d559ef2ca8fc623dc335de65cb5bc989e045a2215165880bb281f6250c2926f108d0757b94cd4dbca46725399511d667cfa23a1ba5ac9dbccaee3d9b033da094c707d22f7d1653862a5c6d1f62bae71a384c8be67add43354908a5b367ef397a6f0720c72658bfbf2bb2230531c4b3b6e9c3f1bc298d5f7de1cb085734320fb87617c7fa9bbd6f2beec43283c88f554fb4de4ce4a6725e854e90f92ff32be1bc263b9444f1888c6704218d3e8674625db586b873ee151ffb9499354e2eb17cfe86d91931f352eb30c0377a03d87408618840fb7e59f0b484ab4daf3708532e39a1e3f766f4b83406a0194bade16be00b03ceedea0d22f7d4b58867c808d0b5f3b8f922384576edb631b3479fa16bfa67074927544555a3695c260ba7518463ff5e314e677aa764fb87a05da039ef9895fa8b828f6a695a6c57ec365f9381aaafca4f7348c444ee450f72fb6693c9aa3025040923a3168c865f99c17d76e177c88b042ba6af23f2db6e5f3074df476debf0bcd0324c7f736dd4c3a415e1cf62571bbcf9b9ca64a05d2218af3a3cbda50c4256f85503e34adf0e718d0f6254b05474322997dad43bd4cb5120ff445533bee23a7a7a80b26c33c31ce8975608183a54845d470fb2aa5a51877341849d4805321edb2621e39b6a63750313ec143d4a83e19a101b335768037a31e9f198165df703bd11a769544ef6a7e36028b40144497b58979ac1f79d77ff52f3ac2cb95d901deea785130668e6144c8e558f40a820537fd224e1a2fd8f1657ea88cf9003354c05a8cd18774d240a28b28cdd5ae4dfa000b113c7e2b753fcd41032d5a44a9361c9b10b71b0bde51b2f1ed04c56a38efafb3590aa19c206c1e725746d97aedd2199dc05f2c0237999d57744fe09dc127c9af2c5da64aa25637918d441544a1a4aa7ab11ee2953e659f3708a8850a5d8d647a4cabb540683d8cadf30690ff2c57b8188daa6dfd4faf4fbe5a872577a921c9b355fe542d5cbf102f1838fa97536e4ad8eafca8822dd219f8bb1878ed8fffd2ae91ab9751280571e3a75aa45eaf41eec8086b6bf721f202413e933d8c2af8fa9b1e9fcb50bf89da53198f69fdebff82a362c7660b2da04ecbde2669f1303fae8d8522b2bbc3e6c9c35fb38d5e87889fc009b63011aedfe9964370f7072a7bced105317fd5e12ebe82c6f4b69c3be9688bb476e4bca074c8a25f54328ddc8359267dba63aacf7f52b868335674d217ffdd7f8e0527505a905cb8eb83ced3faece88e9c5a7f38df49709be1d042fd17d6adefbb0332028b3213408426138ac9743bc3f784ab0e00b46125667d7a879f04baf2d8e8e338aade160b374df948b7a24b5df9780e78ff8e1181b57c3e7f71d666eb01ca18865dea31b65f7118002611cd10d2263f47bebe512062e32de10948a17cd1c5767942457a4447278d77312806f055af125f705ab6f236229032cc545653d5fa7c336d8129a9fb5b4815407a74787477319c55545ac6e962bc66e78bc58900e48d30d7dfabf7aaf4e0bbfdca8818f180104f3df3fe9ede39d482ed0429be25d7b815c23b0352c8bdae0fbd4bbc118cc678969f402df5dfd34ccf27345a779a529feaf2b23706a93226e34efbc54d6efe89075491ec501ae637d2b7a3abd59c1d4a51831e28923f871344892727464db5e417ab5513a7d38fd509d966d319566bc23ac8042de871dc86c40140afc9c183f9f857ce738ed27af5b3ad1fa5309b77ae301f388255815c2e784bc06864e0684f877e08348c8a8e03d4f72b63e1ac142430ba73bbe5c98a7e06048063a3df743bf16ca2466e9471f68961b139558cdc69700d79afdb96e4b64c80d5aa2fb3a6ad74358c406aa41ae96c7b0178a821ad0ed4335895eacd66ec7b985fe9fd3cc3ac28cb5a7677e94d68ef1c616c5a80a9a5eef9e0a12fdb250cd3b77c299dae369a8c7b4ca3cb0607424c3fb4f44725760b43e91fce25663ae3593526a4690b9ecb406e6aea34153b088dd472091318e44fafd2708707ef65db2c5e52b25950a414c14525d2c3803db16a6c69164284448d7fa80d939e24f258b37cfa55d4e555aa15219ff9736469c64aa7ee7904fe4ac348fd18cd8453fa1e94c4e9542fd2ceb9878a14d53c6f876d07b42e41eeba614d1bd3dc3fc33c6ea046d7f259d009734bf5db4d77029a5772155197cb7cf94987542f15744254ee42720481496ba54edca52623cc16ef7ea07ce58bd2c3fb72c4d96651ae9762634423e891bd0c332016549fe87237aa4d6dac0d51dc4b0b451e32657267c00861882da7fd0fb33d37a23e21d560a45b9675251afffa38cb0a06b3039217669cb5066d77894c0a565328a03b273c4664b0f1a89c3f20640291c38627bae183020125c74be222ed3f637f69a21618f1cfad03035d19738bb8ef24ce3a2adfd5ff30b61e8d3c03b095578e3cc877395fa74ca65bbf47efff3cb32d0797c9b3016a65725d8ddf5c3f272fdedf5abcb8441a3d4b0c9e26f9250e42753e5f5dcdfc5b346548e34e3822d289a6c26b09e8832e899df94d9d7f3b487a2974a739edc9dd59d0bec30d643820e23cff592510e5a4f8a8944a7a155b29ec287d87ab1fd03dec2ffd74a84a931daee041bd41fa5609a145aa140b279b540ed3f326d9328636e233480662c8ad916cb52897cbfc0adfa40506d6b0b251b4d5e339481972c547000228c741c1bddeca466afa1eea266344c0bf4003cae15c29bdc681fcf14c0ef110658fcd0f5f513032bb94d3b00d2441a6658fd5f23f02d98a25a613d3ee32418d05ded41e2e1c31757be82ac9e38ee9478ea381c804c34ecd3b240f32b3ab6c3885af0ad701f1c6998ed54ae506777b4cdf0be4c2e14bfd5ac45a0609da10f09e7234eccbe80aa1ad11b57a6f3b8073a0072e506e157767564978ed0293a183d851183ab4b69c982c4eccb8102e375b1e1a35b98c7637dd319d82cf9180087ae3ac4ad6ca3f02d58502bdf8c8e811588efe88767e066aaeab0ff60097f623678197a1ec94573264a88627870c4c715dca4e833f608426c76f96daaa317dbeea2825406f411c538b57a17caaa67f6487d118a2a2f574969216061e699dfe95051ca0bfc8c6c7908ed5a1bc1725a96d9d5b81821884fae0f7fbac25685d4202f9f8cd7065a24f8880a1325d5c0681d8f7697e0e9f990b374ac2739a05fce77cba4b42a4e051aca9f3e2d7218d1510205642bc8516607715522120da174e3e5e07c910be47c1e527bcfcfeb5cf054a23b844d3bf405c8795243439deba50129dd60e9f5555c0ff39363f5997a5377546b037f02d4b2c0e7ae4fe81b854b99a3620f30e251893918a0489ffe213e3b077e60fa811ce1da3030a94e38527583e9d3ac79fda844a023b1023cd7d6e4de3d24c630e834343e5aba36a5e294ed1630c474fb622733f54aba398523788d7aced7e4c57e1eaa9839afe9211bb0d1c53730971ee633c52a467366b1338eec4abc6fc943522d3cbe9b9a175406c08d3274041aa6655893acd324e1018a7788fbb17539e8f38bd1385b3891f0b8f3d2460d6b1469868c87829927eb72faf121367775049f973df6eccef1af626598a72554bbd9b26c14f351a7c5ac85d2c7bd674fac89473c640ec9af4b7cdd14bc637ee001c10a71370729473efc9ae8d521e9556588bfa04a1dc7688d640a6bde9a307dab4794096775f8c1fb5026fcf4c8a369073180b20dc09963f49aecdd09e65e23c1e0aeec8c99789733d2101da8d696e82c6430e4e078c5cb34197127cb831681ae1e5035b06aa05a97ee91cb4eebbc8a916ccfab02d8ce32d5b3b832e670b6743eaa185d272ba0b4cb87692234629b6c491dee7e5278dd43838ac43a06c35c58d9cfbe58eba3070d171348449e1823ddac4b28ef0e70e99a382e7e2e72b92b0611d941128a02fe2f0ee95d344151c58de33b13285811bb4819eec9d3f46ed45a75bea202ec486a1b4d4c2976fa7dadaf5d1ba98e5a3dfa21febf1281335a7fdc08ad25fccdc9d56384b714c69785d6430be0c9ce00e8fc8aee2aeb3faa180688d5bdb91b4fde7a4bd4af8b6c2287d8310e582c36b481c7f86d59406ede817cf566a8274780ed60da22ff4024abb038c9c04c02cbbc7d771bc792b09768964ce22e683f1c00f1ac5302bfd59ec3f25fc892e4756a41a67ca1cd0e6524124dd73e473f48a875254c20feab3658ebb34b80bd892130818c3de247d6d07f6443af39b234d8f82204e14b0c6781ea70a0a09cc60e82296ca2fd133218510ab919b15650f79ab14efe16a5cb2a65f237da10af5559b06a6a9a5db8ecafd9f2622ede252d3886a1569d7aeec74c85c195c4706fb3d62358f3c18fdd84faeb208ead41e679c58f40f7714e71aa79304518555c5c6ef6abc58a9099213431e77ca82bf081465195904a57afec25814c2a8b68f887039f1584c47348bf09ea2f938230791d016a6daa872607ae80aaeef50cce2f8f2bd2b344739e6987de0c8fb8647a763978a37ac4b6fdc1791d89491a34b88fa1a079c7a5336247c18466b5f326bf20298db560e2e723615a8482a49f66e259f4e084e5c11442544de6f360c76182ac0c87742402244994847d2985cefc81fcec12d207c9bd369400416e094e69d97f0da562c13dede313f74effa3b37df082d223ef26c0abb1b0293d7c60aaefb8de69c84f446992f53118b0e8667536b120671fed80b2a42d3625d3e7ae321568a57a2091e095f76ccff7347f23e7d98ce2c152d3c9f43a75eeca726e48b5ff4275d57393b93fa3a2a00f9c7a476da85f93ed0dd3bccecdb08ba59271fa9add12a7e4973ba34e9b8c451eb1bab9345b7f7addba29c1d45178ec43431208c4baaad3309f137256c02f94fa9cbeeb6424e42b3e4e10044e70d43c2887deae002454a6fef0acbe9a08b4fee20eee476ca23410c9961a25c5d9f569724aa63a25bfa90281109d37bd17c7ee6c7bc1aa8e01e2fb09b395eab490cf5fbb90124a0afe9e0ffeb61485f10656b8e89d25d567eee95e0956eda0288f74dfc2b499bbd4cd085dcce0826ffa1ae40b9ac7acd30c50bb3650f97a46a21150e052f9b5f95177a2f41237707945c6fb8b47b1737c67b1ee43d1eb2ffe07cc6226f67d0cddaa203a77b63d5934d172ac1951c4be2262f86420bf2518159a06a341a1c0a39a26fa4dc0aeab2c828d37175b61712149f0b1215d3b06d73cc149d9f449ca6255b009e8de474514edd1b6d4979ccc4ce6213fe9e131209f4b94914eeb0d6442a08389296dd80ee6014dfb846e88b973d24b028c6f50e2700a0c8b4c44451c766d2053cae1b1959fa56d8dd9ccfa91950a3b3caa5a7ccbffb9f9c6af2f461ada49a7ad3b78a8baeb016c3c852fe44b1c854c766176ed5c5e2f228a0d4ea71831b35c89d42a052a350691e6e6ecd4b30c38cd0a1a9eb35c7da486a8e4f53bcb95f393577778b6727e0a6af89d912ca4a5a1eb040f6e0c28976ab978260e609650aac429b8fa80621a145be500424e12e39e10af863b66e48f5d3de712561ed50cd73e560eba8dffc280a907edb50a8409ea09af2f7695df453933a8720fed3e4400e8c29fca1c1b4557edfa9c7e844e4448d44231eadf4cc8022792353f8dedb903d58631d423ac3d08345a1f24e39d0fde107e96436d8f493364ed1cae9ecc15b5002959e090ccedcfb3c70f48c8f78f88933bd32317d68fb8e7c718f713b1c91a4b98f57b50d525b195cd3be96a78e786667f0a9acb06165ed1fd98ad64a411945212c81b780e51696cea560ca9263e517c1eb55af9642831886989c457b30091abfe3845fc214f7d69e4b978e73c9e9a0519b8da4728fa5a6d3c076ae17fc002cd1012d8cb04de34cdef2191bd11111d5cf20bfc465f80dc9440f03c77f4f385678e05ee363b0a0a4b00403bb530cf2edc3ac8ec285e1d531ea2e919967cdce32257862b0686556a8cd770593e921964f546dd85323b460b62cfeab4ecb87689a3ec2ac68d96607a4174e1cc37232ce512f5ea74d320ccba467cf58e1acc9535575936f59a358ebb646dd1e9d3425539e2bdb48a091a38a935daa16a127186106616e32ece2b4d5455e0c4ba249c1d0c5e02289b2e1d5a5f1f350a5daa344b4897c7d458f8ee205e320e3eda901356fcae97526556dc9463665927942f8af0a63720f80d5453500d9addbf100bd3073e67232bfdf73c8db03d2f91979e5c6e611f74bfe611e50fd025fe842ede6ef60c0aa6cc41f4e69f80ff82b6d0cd499da5222eb1175e67f0cd4a632a579a486bffe2a6963ee41c7e341e50fa1de2ffed8ea3ad0d19b330c7d475b00f198991c9e107c01b199acc591d0017a7e23a2a0b2890e57f2458b12f13e2570ddc0c55873bd42b0516f4fabf0817175df7f0626f4c939416c64945da4699bfff1a4a0ae37e8189ae7414d9abdbd0ad0d7d6bfb159923a5c8e23c2d29eba965554e79d76e9ba5407759437d859cfa6cee1b668223a88aa15d30d646a0bf9fdff1cc896200f2f31f8ec3ec4defbfb9c39c1a4263d67c4b97e9ffb2b698b48b978979d7686ba9a50923a60996d6b6bd45c4ffeafb2cee5523f55b02e331fea6d3702829bc1fce23787e22de961649e268e9ce78ffb09aa2af520a39180905c202a36f08d0839a35468806501d0f52829b1692b36b86a3c0314fd121cb5d9d444c4e39d849fcde3a2795a278dc54095dbe27a55613e45ec0208f8a7bb2d8f42911a45fb033fdd76fc31120ecc4b7cd888d49b362bc44f14a7a33f9eed026182968c30e5e192cacac1f90d6aeea4503d4b581ee60d16720ee7fc704d3824468b1844ccbe4cf2ea0daefd16e1fe53f7cf4c3f4a861823f49c3aed4fdcb721f6b2a50398814f24913e89ae11f0fcbb281a29936f973f31589fc059dc4659ed84a499c421b845334fe29d30f9d117715a60358e17478a2075553688365f3ab202ef6cc89ff8bfb7722e251d025cd9a81327c3560b9219df4c3e2fdac93ee78a785e64ba02b83740bcfbd2ae4eb896330341578c9e8aa73623ae2d9271ca8bd626f6537a7fe4fa7740746f755c91eb3b999676f40a71d1bac6276c4a833a231ad81c516864bfa3f15e947238ddeed75b242eb29103724e9c9fccb0193e90152673220cee325549578c65c1775b654804925d4764113d32a5ddbcedf992603d387233268239b310949d981ff539f10c0ef5debb00dd0b073c8949060c05ba0e3c980128e414558f210dd8836e0d69b951972d38748768110cb1e4e2389f31cf7d5ae0632afbc9f6d677d685c1cf292d32080b97e0694f078c6cde6aa9f3715353ceef15bbc0a0d743108916405c1a807a67486078a0ea168c816d490357f72e6dae5bc8a51356126f846323f963beb7ac76a0c8576e5554fa9b795f9ff0a30d64dd5b34f89966892d3a33837ea23b15248d8253b061ee7ddcfa94664d3d413d388b8a92036a4cc6dcc855bbbc20b61b0c546d73896ebc10513b62d19db4a2503c273776568a337470e53da062ee59b675f9ef0e98ede0dc674bc005e88b9087ea5d6231363c0dc2321bdcceadecfe8a5db0bc2d2df88da116ab59</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">私人感情就隐藏起来吧,有兴趣可以私聊我拿密码hhhhh。</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>生活记录</category>
      </categories>
      <tags>
        <tag>感想</tag>
        <tag>电影</tag>
      </tags>
  </entry>
  <entry>
    <title>kotlin-review</title>
    <url>/2022/04/04/kotlin-review/</url>
    <content><![CDATA[<p>emmm，居然拖了这么久还是没写</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>FineWeather开发记录</title>
    <url>/2021/10/17/weather/</url>
    <content><![CDATA[<h1 id="FineWeather开坑记录"><a href="#FineWeather开坑记录" class="headerlink" title="FineWeather开坑记录"></a>FineWeather开坑记录</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>九月份看完了郭霖大神的第一行代码，然后跟着书里的实战敲了一个天气app，但是感觉过于简陋，考虑到天气能锻炼到地方还挺多，于是打算自己开个坑。因为本人是美化爱好者，难得可以自己开发一个app，那本app自然是界面不能丑了，<del>在保证实用性的基础上我会大力加点花里胡哨的东西</del>。</p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>既然注册了彩云app的账号，那既然还是用这个api啦，提供的数据也足够用了。还要搜集插图，设计界面。</p>
<h2 id="TODO（画饼）"><a href="#TODO（画饼）" class="headerlink" title="TODO（画饼）"></a>TODO（画饼）</h2><ul>
<li><input disabled="" type="checkbox"> 画launcher icon</li>
<li><input disabled="" type="checkbox"> 搜集插图</li>
<li><input disabled="" type="checkbox"> 设计界面</li>
<li><input disabled="" type="checkbox"> 完成基础功能</li>
<li><input disabled="" type="checkbox"> 优化好暗色模式</li>
<li><input disabled="" type="checkbox"> 升级动效</li>
<li><input disabled="" type="checkbox"> 待定</li>
</ul>
<h2 id="开坑"><a href="#开坑" class="headerlink" title="开坑"></a>开坑</h2><blockquote>
<p><a href="https://github.com/lnm011223/FIneWeather/tree/master">GitHub项目地址</a>：可以来提issue哇</p>
</blockquote>
<h3 id="第一次失败"><a href="#第一次失败" class="headerlink" title="第一次失败"></a>第一次失败</h3><p>本来在dribble找了个挺好看的设计的，但是在GitHub上找到的shadow库全都用不了，就勉强用material design硬上了，然后发现好多东西都不会改，于是第一版设计结束了。泪目，丢个图纪念一下。属实是差别有点大。</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211020133316854.png"></p>
<h3 id="记录一个小技巧"><a href="#记录一个小技巧" class="headerlink" title="记录一个小技巧"></a>记录一个小技巧</h3><p>先放个效果图</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211025210534105.png" alt="demo"></p>
<p>解释一下原理：</p>
<p>先创建一个buttom appbar，然后在这个部件里嵌入一个buttomnavigation，再把buttomnavigation的右边边距设置在fab的左边，就能做出这个效果。这样就可以同时拥有fab和navigation的特性</p>
<p>下面是示例代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/coordinator&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#235fd9&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.bottomappbar.BottomAppBar</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/bottomAppBar&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#ffffff&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.BottomAppBar.Colored&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:contentInsetEnd</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:contentInsetStart</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:fabAlignmentMode</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">com.google.android.material.bottomnavigation.BottomNavigationView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/bottomNavigation&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:backgroundTint</span>=<span class="string">&quot;@android:color/transparent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:itemIconTint</span>=<span class="string">&quot;#585342&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:itemRippleColor</span>=<span class="string">&quot;?attr/colorOnSurface&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:itemTextColor</span>=<span class="string">&quot;#585342&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:labelVisibilityMode</span>=<span class="string">&quot;selected&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:menu</span>=<span class="string">&quot;@menu/navigation&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">            <span class="attr">android:elevation</span>=<span class="string">&quot;0dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.bottomappbar.BottomAppBar</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.FloatingActionButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fab&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#ffffff&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:contentDescription</span>=<span class="string">&quot;@string/todo&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_baseline_add_24&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:tint</span>=<span class="string">&quot;#585342&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_anchor</span>=<span class="string">&quot;@id/bottomAppBar&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>图形学期末复习整理</title>
    <url>/2022/01/11/tuxingxuezhengli/</url>
    <content><![CDATA[<h1 id="图形学复习整理"><a href="#图形学复习整理" class="headerlink" title="图形学复习整理"></a>图形学复习整理</h1><h2 id="名词解释："><a href="#名词解释：" class="headerlink" title="名词解释："></a>名词解释：</h2><ul>
<li><p><strong>计算机图形学</strong>是研究怎样利用计算机来显示、生成和处理图形的原理、方法和技术的一门学科。</p>
</li>
<li><p>在计算机图形学中，将在用户坐标系中需要进行观察和处理的一个坐标区域称为<strong>窗口</strong>（Window）</p>
</li>
<li><p>将窗口映射到显示设备上的坐标区域称为<strong>视区</strong>（Viewport）</p>
</li>
<li><p>用离散量表示连续量引起的失真，就叫做<strong>走样（</strong>Liasing****）。用于减少或消除这种效果的技术，称为反走样</p>
</li>
<li><p><strong>灭点</strong>：</p>
<p>不平行于投影面的平行线的投影会汇聚到一个点，这个点称为<strong>灭点</strong>(Vanishing Point)。</p>
<p>坐标轴方向的平行线在投影面上形成的灭点称作<strong>主灭点</strong>。</p>
<p><strong>一点透视</strong>有一个主灭点，即投影面与一个坐标轴正交，与另外两个坐标轴平行。</p>
<p><strong>两点透视</strong>有两个主灭点，即投影面与两个坐标轴相交，与另一个坐标轴平行。</p>
<p><strong>三点透视</strong>有三个主灭点，即投影面与三个坐标轴都相交</p>
</li>
</ul>
<h2 id="计算公式："><a href="#计算公式：" class="headerlink" title="计算公式："></a>计算公式：</h2><p>帧缓存大小的计算：</p>
<p>  x方向的象素点数 X y方向的象素点数 X log<sub>2</sub>n/8  </p>
<p> 其中：n为颜色数或灰度等级数</p>
<p>欧拉公式证明简单多面体的顶点数V、边数E和面数F满足如下关系：V-E+F=2</p>
<p>令H表示多面体表面上孔的个数，G表示贯穿多面体的孔的个数，C表示独立的、不相连接的多面体数，则<strong>扩展后的欧拉公式</strong>为：V-E+F-H=2（C-G）</p>
<p>二维几何变换：</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111155707809.png" alt="image-20220111155707809"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111155739740.png" alt="image-20220111155739740"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111155936643.png" alt="image-20220111155936643"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111160400711.png" alt="image-20220111160400711"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111160320001.png" alt="image-20220111160320001"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111160333973.png" alt="image-20220111160333973"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161104529.png" alt="image-20220111161104529"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161116470.png" alt="image-20220111161116470"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161048507.png" alt="image-20220111161048507"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161024555.png" alt="image-20220111161024555"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161334976.png" alt="image-20220111161334976"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161651479.png" alt="image-20220111161651479"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161706608.png" alt="image-20220111161706608"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161719309.png" alt="image-20220111161719309"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161729687.png" alt="image-20220111161729687"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161858850.png" alt="image-20220111161858850"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111161907345.png" alt="image-20220111161907345"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20220111220426467.png" alt="image-20220111220426467"></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>图形学</tag>
        <tag>期末复习</tag>
      </tags>
  </entry>
  <entry>
    <title>系统调用和进程通信踩坑记录</title>
    <url>/2021/11/20/Linux-system/</url>
    <content><![CDATA[<blockquote>
<p>本篇博客参考了dzcgiegie的好文啦：<a href="https://dzcgood.xyz/2021/11/15/SystemCall_ProcessCommunication/">系统调用与进程通信</a></p>
</blockquote>
<hr>
<h2 id="3-1-Linux-之系统调用"><a href="#3-1-Linux-之系统调用" class="headerlink" title="3.1 Linux 之系统调用"></a>3.1 Linux 之系统调用</h2><blockquote>
<p>任务描述：通过对作业二形成的系统新内核进行相应的修改，加入自己的系 统调用，并且在应用层编写一应用程序对其进行调用，产生相应的输出给予验证。</p>
</blockquote>
<p><del>作为一个懒人，那肯定要省时间的方法啊，谁会再去等至少一个小时的内核编译时间啊</del></p>
<h3 id="1-查询-sys-call-table-的地址"><a href="#1-查询-sys-call-table-的地址" class="headerlink" title="1.查询 sys_call_table 的地址"></a>1.查询 sys_call_table 的地址</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cat /proc/kallsyms | grep sys_call_table</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121000419205.png"></p>
<p>找到sys_call_table 的地址为<strong>0xffffffff91a013a0</strong></p>
<h3 id="2-查询可用的系统调用号"><a href="#2-查询可用的系统调用号" class="headerlink" title="2.查询可用的系统调用号"></a>2.查询可用的系统调用号</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /usr/include/asm-generic/unistd.h</span><br></pre></td></tr></table></figure>

<p>这里我是这个路径，其他人好像不是，</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo find / -name unistd*.h</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121094548170.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121094955823.png"></p>
<p>反正找到这个<code>unistd</code>文件就行，然后看一下哪个号没被占用</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121001129248.png"></p>
<p>找到<u><strong>415号</strong></u>是可用的系统调用号</p>
<h3 id="3-创建lnm-c文件"><a href="#3-创建lnm-c文件" class="headerlink" title="3.创建lnm.c文件"></a>3.创建lnm.c文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim lnm.c</span><br></pre></td></tr></table></figure>

<p>在文件内定义系统调用，其中使用到的 sys_call_table 地址和可用系统调用号为上面找到的</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line">MODULE_INFO(intree,<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;Dual BSD/GPL&quot;</span>);</span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;LNM&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SYS_CALL_TABLE_ADDRESS 0xffffffff91a013a0  <span class="comment">//sys_call_table对应的地址</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM 415  <span class="comment">//系统调用号为415</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> __init <span class="title">hello_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  printk(KERN_INFO <span class="string">&quot;Welcome !  20192131031+liangnuoming\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> __exit <span class="title">hello_exit</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   printk(KERN_INFO <span class="string">&quot;Bye !  20192131031+liangnuoming\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">module_init(hello_init);</span><br><span class="line">module_exit(hello_exit);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-创建Makefile调用文件"><a href="#4-创建Makefile调用文件" class="headerlink" title="4.创建Makefile调用文件"></a>4.创建Makefile调用文件</h3><p>先运行下面的命令找到系统当前的内核，然后去/usr/src/目录找对应的文件夹，记住这个文件夹的路径<code>/usr/src/linux-headers-5.4.0-88-generic</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uname  -a</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121004215247.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121004446744.png"></p>
<p>然后创建Makefile文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim Makefile</span><br></pre></td></tr></table></figure>

<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">obj-m:=lnm.o</span></span><br><span class="line">CURRENT_PATH:=<span class="variable">$(<span class="built_in">shell</span> pwd)</span></span><br><span class="line">LINUX_KERNEL_PATH:=/usr/src/linux-headers-5.4.0-88-generic</span><br><span class="line"><span class="section">all:</span></span><br><span class="line">        make -C  <span class="variable">$(LINUX_KERNEL_PATH)</span> M=<span class="variable">$(CURRENT_PATH)</span> modules</span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">        make -C  <span class="variable">$(LINUX_KERNEL_PATH)</span> M=<span class="variable">$(CURRENT_PATH)</span> clean</span><br></pre></td></tr></table></figure>

<h3 id="5-安装内核模块"><a href="#5-安装内核模块" class="headerlink" title="5.安装内核模块"></a>5.安装内核模块</h3><p>执行<code>sudo make</code><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121011135879.png"></p>
<p>可以通过<code>ls | grep ‘lnm.*’</code>查看执行是否成功</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121011002126.png"></p>
<p>使用如下命令插入模块：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo insmod lnm.ko</span><br></pre></td></tr></table></figure>

<p>使用如下命令检查插入是否成功：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lsmod</span><br></pre></td></tr></table></figure>

<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121011434782.png"></p>
<p>可以看到<strong>lnm</strong>的模块，插入成功。</p>
<h3 id="6-创建test-c调用文件"><a href="#6-创建test-c调用文件" class="headerlink" title="6.创建test.c调用文件"></a>6.创建test.c调用文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim test.c</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">unsigned</span> <span class="keyword">long</span> x = <span class="number">0</span>;</span><br><span class="line">        x = syscall(<span class="number">415</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;调用测试成功&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用 <code>gcc test.c</code> 和 <code>./a.out</code> 命名查看运行结果：</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121012942991.png"></p>
<p>通过 <code>dmesg</code> 命令查看系统调用的结果：</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121013038067.png"></p>
<p><strong>说明添加系统调用成功</strong></p>
<h2 id="3-2-IPC"><a href="#3-2-IPC" class="headerlink" title="3.2 IPC"></a>3.2 IPC</h2><h3 id="代码实践-1："><a href="#代码实践-1：" class="headerlink" title="代码实践 1："></a>代码实践 1：</h3><blockquote>
<p>本人在学者网的课程主页中上传了相关 Slides（教学资源里名 为“Linux-OS.zip“的压缩包），其第 12、13 章对上述四种 IPC 方式的使用过程和 示范代码进行了详细的解释。所以这里就请大家先根据上述压缩包里的教程，把 四种 IPC 方式的代码在自己的虚拟机里正确的运行起来并仔细理解。因为这些隶 属于应用层代码，所以难度较低。</p>
</blockquote>
<p>若是执行gcc以后报错，可以用man + 函数名 命令解决该头文件缺失的问题</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121015027022.png"></p>
<p>例如<code>man fork</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121015239484.png"></p>
<h4 id="管道-PIPE"><a href="#管道-PIPE" class="headerlink" title="管道 - PIPE"></a>管道 - PIPE</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim pipe.c</span><br></pre></td></tr></table></figure>

<p>创建 pipe.c 文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p1,fd[<span class="number">2</span>];</span><br><span class="line">    <span class="comment">//定义读缓冲区</span></span><br><span class="line">    <span class="keyword">char</span> outpipe[<span class="number">50</span>];</span><br><span class="line">    <span class="comment">//定义写缓冲区</span></span><br><span class="line">    <span class="keyword">char</span> inpipe[<span class="number">50</span>];</span><br><span class="line">    <span class="comment">//创建无名管道fd</span></span><br><span class="line">    pipe(fd);</span><br><span class="line">    <span class="keyword">while</span>((p1 = fork()) == <span class="number">-1</span>);</span><br><span class="line">    <span class="comment">//子进程返回</span></span><br><span class="line">    <span class="keyword">if</span>(p1 == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(inpipe, <span class="string">&quot;This is a message!&quot;</span>);</span><br><span class="line">        <span class="comment">//写信息到管道</span></span><br><span class="line">        write(fd[<span class="number">1</span>], inpipe, <span class="number">50</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//父进程返回</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//等待子进程终止</span></span><br><span class="line">        wait(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//从管道读信息到缓冲区</span></span><br><span class="line">        read(fd[<span class="number">0</span>], outpipe, <span class="number">50</span>);</span><br><span class="line">        <span class="comment">//显示读到的信息</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,outpipe);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行<code>sudo gcc pipe.c -o pipe</code>和<code>./pipe</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121015507060.png"></p>
<h4 id="信号-Signal"><a href="#信号-Signal" class="headerlink" title="信号 - Signal"></a>信号 - Signal</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim signal.c</span><br></pre></td></tr></table></figure>

<p>创建 signal.c 文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> k;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">int_func</span><span class="params">(<span class="keyword">int</span> sig)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        k=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;int_func\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        signal(SIGINT,int_func);</span><br><span class="line">        k=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(k==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">               <span class="built_in">printf</span>(<span class="string">&quot;Hello!20192131031 + liangnuoming\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;OK\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>执行<code>sudo gcc signal.c -o signal</code>和<code>./signal</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121020231298.png"></p>
<h4 id="消息传递-Message-Passing-Interface"><a href="#消息传递-Message-Passing-Interface" class="headerlink" title="消息传递 - Message Passing Interface"></a>消息传递 - Message Passing Interface</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim sndfile.c</span><br></pre></td></tr></table></figure>

<p>创建 sndfile.c文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXMSG 512</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">my_msg</span> //定义消息缓冲区数据结构</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> my_msg_type;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">char</span> some_text[MAXMSG];</span><br><span class="line">&#125; msg;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> msgid;                            <span class="comment">//定义消息缓冲区内部标识</span></span><br><span class="line">    <span class="keyword">char</span> buffer[BUFSIZ];                  <span class="comment">//定义用户缓冲区</span></span><br><span class="line">    msgid = msgget(<span class="number">12</span>,<span class="number">0666</span> | IPC_CREAT); <span class="comment">//创建消息队列， key为12</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Enter some text:&quot;</span>);     <span class="comment">//提示键入消息内存</span></span><br><span class="line">        fgets(buffer, BUFSIZ, <span class="built_in">stdin</span>); <span class="comment">//标准输入送buffer</span></span><br><span class="line">        msg.i++ ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i=%d\n&quot;</span>,msg.i);</span><br><span class="line">        msg.my_msg_type = <span class="number">3</span>;</span><br><span class="line">        <span class="built_in">strcpy</span>(msg.some_text, buffer);             <span class="comment">//buffer中的内容送消息缓冲</span></span><br><span class="line">        msgsnd(msgid, &amp;msg, MAXMSG, <span class="number">0</span>);            <span class="comment">//发送消息到消息队列</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strncmp</span>(msg.some_text, <span class="string">&quot;end&quot;</span>, <span class="number">3</span>) == <span class="number">0</span>) <span class="comment">//消息为end结束</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim rcvfile.c</span><br></pre></td></tr></table></figure>

<p>创建 rcvfile.c文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXMSG 512</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">my_msg</span>//定义消息缓冲区数据结构</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">int</span> my_msg_type;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">char</span> some_text[MAXMSG];</span><br><span class="line">&#125;msg;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> msgid;</span><br><span class="line">	msg.my_msg_type=<span class="number">3</span>;</span><br><span class="line">	msgid=msgget(<span class="number">12</span>,<span class="number">0666</span>|IPC_CREAT);<span class="comment">//获取消息队列。Key为1234</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		msgrcv(msgid,&amp;msg,BUFSIZ,msg.my_msg_type,<span class="number">0</span>);<span class="comment">//接收消息</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;You wrote:%s and i = %d\n&quot;</span>,msg.some_text,msg.i);<span class="comment">//显示消息</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">strncmp</span>(msg.some_text,<span class="string">&quot;end&quot;</span>,<span class="number">3</span>)==<span class="number">0</span>)<span class="comment">//消息为end则结束</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	msgctl(msgid,IPC_RMID,<span class="number">0</span>);<span class="comment">//删除消息队列</span></span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行<code>sudo gcc sndfile.c -o sndfile</code>和<code>sudo gcc rcvfile.c -o rcvfile</code></p>
<p>执行<code>./sndfile</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121021919778.png"></p>
<p>执行<code>./rcvfile</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121022001974.png"></p>
<h4 id="共享内存-Shared-Memory"><a href="#共享内存-Shared-Memory" class="headerlink" title="共享内存 - Shared Memory"></a>共享内存 - Shared Memory</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim sndshm.c</span><br></pre></td></tr></table></figure>

<p>创建 sndshm.c 文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> shmid;</span><br><span class="line">    <span class="keyword">char</span> *viraddr;</span><br><span class="line">    <span class="keyword">char</span> buffer[BUFSIZ];</span><br><span class="line">    shmid = shmget(<span class="number">1234</span>, BUFSIZ, <span class="number">0666</span> | IPC_CREAT); <span class="comment">//创建共享内存</span></span><br><span class="line">    viraddr = (<span class="keyword">char</span>*)shmat(shmid, <span class="number">0</span>, <span class="number">0</span>);<span class="comment">//附接到共享内存</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Enter some text:&quot;</span>);           <span class="comment">//提示用户输入信息</span></span><br><span class="line">	fgets(buffer, BUFSIZ, <span class="built_in">stdin</span>);       <span class="comment">//将标准输入送入到缓冲区中</span></span><br><span class="line">	<span class="built_in">strcat</span>(viraddr, buffer);            <span class="comment">//采用追加方式写到共享内存</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strncmp</span>(buffer, <span class="string">&quot;end&quot;</span>, <span class="number">3</span>) == <span class="number">0</span>) <span class="comment">//当输入的字符为&quot;end&quot;时，终止循环</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    shmdt(viraddr); <span class="comment">//切断与共享内存的链接</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo vim rcvshm.c</span><br></pre></td></tr></table></figure>

<p>创建 rcvshm.c 文件，并在其中添加以下代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> shmid;</span><br><span class="line">    <span class="keyword">char</span> *viraddr;</span><br><span class="line">    shmid = shmget(<span class="number">1234</span>, BUFSIZ, <span class="number">0666</span> | IPC_CREAT); <span class="comment">//创建共享内存</span></span><br><span class="line">    viraddr = (<span class="keyword">char</span> *)shmat(shmid, <span class="number">0</span>, <span class="number">0</span>);           <span class="comment">//附接到共享内存</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Your message is ：%s&quot;</span>, viraddr);        <span class="comment">//输出共享内存的内容</span></span><br><span class="line">    shmdt(viraddr);                                 <span class="comment">//切断与共享内存的链接</span></span><br><span class="line">    shmctl(shmid, IPC_RMID, <span class="number">0</span>);<span class="comment">//释放共享内存</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>执行<code>sudo gcc sndshm.c -o sndshm</code>和<code>sudo gcc rcvshm.c -o rcvshm</code></p>
<p>执行<code>./sndshm</code>和<code>./rcvshm</code></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211121023045174.png"></p>
<h3 id="代码实践-2："><a href="#代码实践-2：" class="headerlink" title="代码实践 2："></a>代码实践 2：</h3><blockquote>
<p>请对上述 IPC 方式的第四种——共享内存进行改写，实现以下 场景。 </p>
<ul>
<li>（1）创建两块共享内存 M1 和 M2；用数据结构“环形队列/数组”来抽象 M1 和 M2，也即，每个共享内存中的存储形式为一循环队列或数组，容量为 4096（可 以容纳 4096 个消息）； </li>
<li>（2）发送者进程，名为 A，向 M1 中“生产”常规信息（可以是字符串），从 M2 中“消费”控制信息；接收者进程，名为 B，向 M2“生产”控制信息，从 M1 中 “消费”常规信息；这里可以理解为：M1 为 A 向 B 发送数据的缓冲（Data Buffer）， M2 则为 B 向 A 发送应答（确认收到的应答）的缓冲（Response Buffer）； </li>
<li>（3）初始状态下，M1 和 M2 皆为空；A 首先主动向 B 发送常规信息，数量 为[1-10]中的随机数目（但是每次发送的数据量肯定不能超过 M1 中的空闲槽数 量）；发送之后，A 再向 B 传送信号（Signal），要其消费 M1； </li>
<li>（4）B 收到 A 发送来的信号后，从 M1 中消费信息，数量为[1-10]中的随机 数量（但是肯定不能超过 M1 中的当前存在消息数目）；B 向 M2 中生产应答信 息，数目为其最近消费 M1 的消息个数，即：B 一次消费的常规信息数，要等于 生产的应答信息数；之后，B 向 A 发送信号，让其接收应答信息； </li>
<li>（5）A 收到信号后，消费应答信息，并继续向 M1 中生产常规信息。</li>
</ul>
</blockquote>
<p>本题就是一个pv操作，A读写的时候B不能读写，B读写的时候A不能，所以设置两个信号量就能控制这个问题，达到轮流操作的效果</p>
<p>代码参考了<a href="https://dzcgood.xyz/2021/11/15/SystemCall_ProcessCommunication/">系统调用与进程通信</a>与<a href="https://www.cnblogs.com/harrypotterjackson/p/11997774.html">生产者消费者问题 多进程共享内存 - LightningStar</a>，并改成了随时间变化的随机数，使每次运行结果都为伪随机的</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_NUM 4096</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//int flag;</span></span><br><span class="line"><span class="comment">//共享内存缓冲区资源的循环队列</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Resource</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> message[MAX_NUM];</span><br><span class="line">    <span class="keyword">int</span> front;</span><br><span class="line">    <span class="keyword">int</span> rear;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//M1 M2</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Resource</span> <span class="title">M</span>[2];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//信号量数据结构</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">semun</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//用于映射信号量编号与对应意义的映射</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">MUTEX</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//是否允许A操作</span></span><br><span class="line">    A_ENABLE,</span><br><span class="line">    <span class="comment">//是否允许B操作</span></span><br><span class="line">    B_ENABLE,</span><br><span class="line">    <span class="comment">//信号量相关</span></span><br><span class="line">    NUM_MUX</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//信号量集合描述符</span></span><br><span class="line"><span class="keyword">int</span> semid;</span><br><span class="line"></span><br><span class="line"><span class="comment">//共享空间描述符，M1,M2各占一个空间</span></span><br><span class="line"><span class="keyword">int</span> shmid[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//共享空间首地址</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Resource</span> *<span class="title">shm</span>[2];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//绑定共享内存</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">attach_shm</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//将共享内存连接到当前进程的地址空间</span></span><br><span class="line">    shm[<span class="number">0</span>] = (struct Resource *)shmat(shmid[<span class="number">0</span>], <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    shm[<span class="number">1</span>] = (struct Resource *)shmat(shmid[<span class="number">1</span>], <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (shm[<span class="number">0</span>] == (struct Resource *)<span class="number">-1</span> || shm[<span class="number">1</span>] == (struct Resource *)<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;shmat failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解绑共享内存</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">detach_shm</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//把共享内存从当前进程中分离</span></span><br><span class="line">    <span class="keyword">if</span> (shmdt((<span class="keyword">void</span> *)shm[<span class="number">0</span>]) == <span class="number">-1</span> || shmdt((<span class="keyword">void</span> *)shm[<span class="number">1</span>]) == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;shmdt failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取资源，对应信号量实施P操作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P</span><span class="params">(<span class="keyword">short</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sembuf</span> <span class="title">sb</span> =</span></span><br><span class="line">        &#123;</span><br><span class="line">            num, <span class="number">-1</span>, <span class="number">0</span> <span class="comment">//0表示信号量编号,-1表示P操作,SEM_UNDO表示进程退出后，该进程对sem进行的操作将被撤销</span></span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="comment">//修改集合中，一个或多个信号量值</span></span><br><span class="line">    semop(semid, &amp;sb, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//释放资源，对应信号量实施V操作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">V</span><span class="params">(<span class="keyword">short</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sembuf</span> <span class="title">sb</span> =</span> &#123;</span><br><span class="line">        num, <span class="number">1</span>, <span class="number">0</span> <span class="comment">//</span></span><br><span class="line">    &#125;;</span><br><span class="line">    semop(semid, &amp;sb, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取数据，id为0，表示A在操作，id为2，表示B在操作</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">readMessage</span><span class="params">(<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// id = 0，读取M[1]，id = 1，读取M[0]</span></span><br><span class="line">    <span class="keyword">int</span> message = <span class="number">0</span>;</span><br><span class="line">    message = shm[-id + <span class="number">1</span>]-&gt;message[shm[-id + <span class="number">1</span>]-&gt;front];</span><br><span class="line">    shm[-id + <span class="number">1</span>]-&gt;front = (shm[-id + <span class="number">1</span>]-&gt;front + <span class="number">1</span>) % MAX_NUM;</span><br><span class="line">    <span class="comment">// printf(&quot;M%d -&gt; front = %d\n&quot;, -id + 2, shm[-id + 1]-&gt;front);</span></span><br><span class="line">    <span class="keyword">return</span> message;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写入数据，id为0，表示A在操作，id为2，表示B在操作</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">writeMessage</span><span class="params">(<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sleep(<span class="number">1.0</span>);</span><br><span class="line">    srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="comment">//随机生成一个范围在[1,4096]的message</span></span><br><span class="line">    <span class="keyword">int</span> message = rand() % <span class="number">4096</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//id为0，向M[0]写入，id为1，向M[1]写入</span></span><br><span class="line">    shm[id]-&gt;message[shm[id]-&gt;rear] = message;</span><br><span class="line">    shm[id]-&gt;rear = (shm[id]-&gt;rear + <span class="number">1</span>) % MAX_NUM;</span><br><span class="line">    <span class="comment">// printf(&quot;M%d -&gt; rear = %d\n&quot;, id + 1, shm[id]-&gt;rear);</span></span><br><span class="line">    <span class="keyword">return</span> message;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进程A的工作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    attach_shm();</span><br><span class="line">    <span class="comment">//sleep(1.0);</span></span><br><span class="line">    <span class="comment">//srand((unsigned)time(NULL));</span></span><br><span class="line">    <span class="comment">//extern int flag;</span></span><br><span class="line">    <span class="comment">//flag = rand()%10+1;</span></span><br><span class="line">    <span class="comment">//这里让A执行4次</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; <span class="number">4</span>; m++)</span><br><span class="line">    &#123;</span><br><span class="line">        P(A_ENABLE);</span><br><span class="line">        <span class="comment">//当前M1中元素个数</span></span><br><span class="line">        <span class="keyword">int</span> ele1Number = (shm[<span class="number">0</span>]-&gt;rear - shm[<span class="number">0</span>]-&gt;front + MAX_NUM) % MAX_NUM;</span><br><span class="line">        <span class="comment">//最多写入个数</span></span><br><span class="line">        <span class="keyword">int</span> maxNum = MAX_NUM - ele1Number;</span><br><span class="line">	sleep(<span class="number">1.0</span>);</span><br><span class="line">        srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">        <span class="keyword">int</span> randInt = rand() % <span class="number">10</span> + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//选一个小的数作为写入的信息数</span></span><br><span class="line">        <span class="keyword">int</span> times = maxNum &lt; randInt ? maxNum : randInt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;A write message to   M1 : %d \n&quot;</span>, writeMessage(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果M2队列为空，也就是刚刚开始A向B，B还没向A发送过信息</span></span><br><span class="line">        <span class="comment">//所以只在M2有消息的时候才读取</span></span><br><span class="line">        <span class="keyword">if</span> (shm[<span class="number">1</span>]-&gt;front != shm[<span class="number">1</span>]-&gt;rear)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//当前M2中元素个数</span></span><br><span class="line">            <span class="keyword">int</span> eleNumber = (shm[<span class="number">1</span>]-&gt;rear - shm[<span class="number">1</span>]-&gt;front + MAX_NUM) % MAX_NUM;</span><br><span class="line">            sleep(<span class="number">1.0</span>);</span><br><span class="line">	    srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">	    <span class="comment">//随机读取[1, eleNumber]次</span></span><br><span class="line">            <span class="keyword">int</span> times = rand() % eleNumber + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;A read  message from M2 : %d \n&quot;</span>, readMessage(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        V(B_ENABLE);</span><br><span class="line">    &#125;</span><br><span class="line">    detach_shm();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进程B的工作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    attach_shm();</span><br><span class="line">    <span class="comment">//这里让B执行4次</span></span><br><span class="line">    <span class="comment">//sleep(1.0);</span></span><br><span class="line">    <span class="comment">//srand((unsigned)time(NULL));</span></span><br><span class="line">    <span class="comment">//int flag2 = rand()%flag+1;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; <span class="number">4</span>; m++)</span><br><span class="line">    &#123;</span><br><span class="line">        P(B_ENABLE);</span><br><span class="line">        <span class="comment">//当前M1中元素个数</span></span><br><span class="line">	sleep(<span class="number">1.0</span>);</span><br><span class="line">	srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">        <span class="keyword">int</span> eleNumber = (shm[<span class="number">0</span>]-&gt;rear - shm[<span class="number">0</span>]-&gt;front + MAX_NUM) % MAX_NUM;</span><br><span class="line">        <span class="keyword">int</span> randInt = rand() % <span class="number">10</span> + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//选一个小的数作为读取的信息数</span></span><br><span class="line">        <span class="keyword">int</span> times = eleNumber &lt; randInt ? eleNumber : randInt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;B read  message from M1 : %d \n&quot;</span>, readMessage(<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//向M2写times个信息</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;B write message to   M2 : %d \n&quot;</span>, writeMessage(<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        V(A_ENABLE);</span><br><span class="line">    &#125;</span><br><span class="line">    detach_shm();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">extern</span> <span class="keyword">int</span> flag;</span><br><span class="line">    <span class="comment">//记录父进程pid</span></span><br><span class="line">    <span class="keyword">pid_t</span> ppid = getpid();</span><br><span class="line">    <span class="comment">//信号集名字，信号集中信号量的个数，信号量集合的权限</span></span><br><span class="line">    semid = semget((<span class="keyword">key_t</span>)<span class="number">1234</span>, NUM_MUX, IPC_CREAT | <span class="number">0600</span>); <span class="comment">//创建信号量</span></span><br><span class="line">    <span class="keyword">if</span> (semid == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;semget&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化信号量</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">semun</span> <span class="title">s</span>;</span></span><br><span class="line">    <span class="comment">//初始时，允许A执行</span></span><br><span class="line">    s.value = <span class="number">1</span>;</span><br><span class="line">    semctl(semid, A_ENABLE, SETVAL, s);</span><br><span class="line">    <span class="comment">//初始时，不允许B执行</span></span><br><span class="line">    s.value = <span class="number">0</span>;</span><br><span class="line">    semctl(semid, B_ENABLE, SETVAL, s);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建共享内存</span></span><br><span class="line">    shmid[<span class="number">0</span>] = shmget((<span class="keyword">key_t</span>)<span class="number">1234</span>, <span class="keyword">sizeof</span>(M[<span class="number">0</span>]), <span class="number">0666</span> | IPC_CREAT);</span><br><span class="line">    shmid[<span class="number">1</span>] = shmget((<span class="keyword">key_t</span>)<span class="number">5678</span>, <span class="keyword">sizeof</span>(M[<span class="number">1</span>]), <span class="number">0666</span> | IPC_CREAT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (shmid[<span class="number">0</span>] == <span class="number">-1</span> || shmid[<span class="number">1</span>] == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;shmget failed\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    attach_shm();</span><br><span class="line">    <span class="comment">//初始化共享内存</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(shm[i]-&gt;message, <span class="number">0</span>, <span class="keyword">sizeof</span>(shm[i]-&gt;message));</span><br><span class="line">        shm[i]-&gt;front = <span class="number">0</span>;</span><br><span class="line">        shm[i]-&gt;rear = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建3个进程：1个父进程 + 1个A + 1个B</span></span><br><span class="line">    <span class="keyword">pid_t</span> child_pid[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        child_pid[i] = fork();</span><br><span class="line">        <span class="comment">//子进程</span></span><br><span class="line">        <span class="keyword">if</span> (child_pid[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//A</span></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        processA();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//B</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        processB();</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//父进程</span></span><br><span class="line">    <span class="keyword">if</span> (getpid() == ppid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//等待子进程结束</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            waitpid(child_pid[i], <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        detach_shm();</span><br><span class="line">        <span class="comment">//删除共享内存</span></span><br><span class="line">        <span class="keyword">if</span> (shmctl(shmid[<span class="number">0</span>], IPC_RMID, <span class="number">0</span>) == <span class="number">-1</span> || shmctl(shmid[<span class="number">1</span>], IPC_RMID, <span class="number">0</span>) == <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;shmctl(IPC_RMID) failed\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211122004416639.png"></p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211122004451249.png"></p>
<h2 id="3-3-心得和体会"><a href="#3-3-心得和体会" class="headerlink" title="3.3 心得和体会"></a>3.3 心得和体会</h2><p>通过3.1的内核模块学会了一些关于内核模块，KO文件，Makefile的知识，懂了怎么插入和自定义内核模块，当然了，掌握的还是很浅薄，不过万丈高楼平地起，也算是有了一点基础。不得不说Linux的可玩性比Windows和macOS好太多了，不过也要有能力才能玩起来。</p>
<p>上学期学了操作系统，一直没什么实践的机会，这次写了一下pv操作的逻辑，学会了几个os相关的api，虽然也是一知半解的状态，不过感觉对底层的东西敬意又多了不少。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>System Call</tag>
        <tag>IPC</tag>
      </tags>
  </entry>
  <entry>
    <title>通讯录的实现</title>
    <url>/2021/12/23/My-contacts/</url>
    <content><![CDATA[<h1 id="通讯录的设计与实现说明文档"><a href="#通讯录的设计与实现说明文档" class="headerlink" title="通讯录的设计与实现说明文档"></a>通讯录的设计与实现说明文档</h1><h2 id="一、软件名称"><a href="#一、软件名称" class="headerlink" title="一、软件名称"></a>一、软件名称</h2><p>​    简易通讯录</p>
<blockquote>
<p>GitHub项目地址：<a href="https://github.com/lnm011223/My_contact">https://github.com/lnm011223/My_contact</a></p>
</blockquote>
<h2 id="二、软件内容简介"><a href="#二、软件内容简介" class="headerlink" title="二、软件内容简介"></a>二、软件内容简介</h2><p>一个真的很简单的通讯录，素材配色什么的直接用了上次日记本的（不过本来这个实验就没什么要做的，书上都有）</p>
<p>实现了短按打电话，长按发短信的功能，右侧的按钮点击也可以实现打电话和发短信</p>
<h2 id="三、界面设计"><a href="#三、界面设计" class="headerlink" title="三、界面设计"></a>三、界面设计</h2><h3 id="1-界面展示"><a href="#1-界面展示" class="headerlink" title="1.界面展示"></a>1.界面展示</h3><img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Screenshot_1640223080.png" alt="" style="zoom:50%;" />

<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Screenshot_1640223087.png" alt="" style="zoom:50%;" />

<h3 id="2-权限获取"><a href="#2-权限获取" class="headerlink" title="2.权限获取"></a>2.权限获取</h3><img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Screenshot_1640223091.png" style="zoom:50%;" />

<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Screenshot_1640223110.png" style="zoom:50%;" />

<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Screenshot_1640223178.png" style="zoom:50%;" />

<h2 id="四、关键代码"><a href="#四、关键代码" class="headerlink" title="四、关键代码"></a>四、关键代码</h2><h3 id="1-Activity逻辑"><a href="#1-Activity逻辑" class="headerlink" title="1.Activity逻辑"></a>1.Activity逻辑</h3><blockquote>
<p>1.MainActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_contacts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.Manifest</span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.provider.ContactsContract</span><br><span class="line"><span class="keyword">import</span> android.util.Log</span><br><span class="line"><span class="keyword">import</span> androidx.core.app.ActivityCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.ContextCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> contactlist = ArrayList&lt;Contact&gt;()</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        setSupportActionBar(toolbar)</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinearLayoutManager(<span class="keyword">this</span>)</span><br><span class="line">        contactview.layoutManager = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter = ContactAdapter(contactlist)</span><br><span class="line">        contactview.adapter = adapter</span><br><span class="line">        Log.d(<span class="string">&quot;111&quot;</span>,<span class="string">&quot;111&quot;</span>)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        <span class="keyword">if</span> (ContextCompat.checkSelfPermission(</span><br><span class="line">                <span class="keyword">this</span>,</span><br><span class="line">                Manifest.permission.READ_CONTACTS</span><br><span class="line">            ) != PackageManager.PERMISSION_GRANTED</span><br><span class="line">        ) &#123;</span><br><span class="line">            ActivityCompat.requestPermissions(<span class="keyword">this</span>, arrayOf(Manifest.permission.READ_CONTACTS), <span class="number">2</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            readContacts()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;Range&quot;</span>)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">readContacts</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 查询联系人数据</span></span><br><span class="line">        contentResolver.query(</span><br><span class="line">            ContactsContract.CommonDataKinds.Phone.CONTENT_URI,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            <span class="literal">null</span>,</span><br><span class="line">            <span class="literal">null</span></span><br><span class="line">        )?.apply &#123;</span><br><span class="line">            <span class="keyword">while</span> (moveToNext()) &#123;</span><br><span class="line">                <span class="comment">// 获取联系人姓名</span></span><br><span class="line">                <span class="keyword">val</span> displayName =</span><br><span class="line">                    getString(getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME))</span><br><span class="line">                <span class="comment">// 获取联系人手机号</span></span><br><span class="line">                <span class="keyword">val</span> number =</span><br><span class="line">                    getString(getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                contactlist.add(Contact(getavadar(), displayName, number))</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            close()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getavadar</span><span class="params">()</span></span>= <span class="keyword">when</span> ((<span class="number">1.</span><span class="number">.5</span>).random()) &#123;</span><br><span class="line">            <span class="number">1</span> -&gt; R.drawable.mood_1</span><br><span class="line">            <span class="number">2</span> -&gt; R.drawable.mood_2</span><br><span class="line">            <span class="number">3</span> -&gt; R.drawable.mood_3</span><br><span class="line">            <span class="number">4</span> -&gt; R.drawable.mood_4</span><br><span class="line">            <span class="number">5</span> -&gt; R.drawable.mood_5</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span> -&gt; &#123;R.drawable.mood_1&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.SendActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_contacts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.Manifest</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.telephony.SmsManager</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.core.app.ActivityCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.ContextCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_send.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">var</span> phonenumber = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> phonename = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_send)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        toolbar.title = <span class="string">&quot;Send Message&quot;</span></span><br><span class="line">        phonenumber = intent.getStringExtra(<span class="string">&quot;number&quot;</span>).toString()</span><br><span class="line">        phonename = intent.getStringExtra(<span class="string">&quot;name&quot;</span>).toString()</span><br><span class="line">        phonenumbertext.text = phonenumber</span><br><span class="line">        phonetext.text = phonename</span><br><span class="line">        sendbutton.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (ContextCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.SEND_SMS) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                ActivityCompat.requestPermissions(<span class="keyword">this</span>, arrayOf(Manifest.permission.SEND_SMS), <span class="number">1</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">val</span> sms_text = sms_edit.text.toString()</span><br><span class="line">                <span class="keyword">if</span> (sms_text.isNotEmpty() &amp;&amp; phonenumber.isNotEmpty())&#123;</span><br><span class="line">                    <span class="keyword">val</span> smsManager = SmsManager.getDefault()</span><br><span class="line">                    smsManager.sendTextMessage(phonenumber,<span class="literal">null</span>,sms_text,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;发送成功&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;发送内容不能为空！&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onRequestPermissionsResult</span><span class="params">(requestCode: <span class="type">Int</span>, permissions: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;, grantResults: <span class="type">IntArray</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults)</span><br><span class="line">        <span class="keyword">when</span> (requestCode) &#123;</span><br><span class="line">            <span class="number">1</span> -&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (grantResults.isNotEmpty() &amp;&amp; grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                    <span class="comment">//call()</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;You denied the permission&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Recycleview相关"><a href="#2-Recycleview相关" class="headerlink" title="2.Recycleview相关"></a>2.Recycleview相关</h3><blockquote>
<p>1.contact类</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_contacts</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Contact</span></span>(<span class="keyword">val</span> avadar: <span class="built_in">Int</span>,<span class="keyword">val</span> name: String,<span class="keyword">val</span> number: String)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.ContactAdapter</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_contacts</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.Manifest</span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.pm.PackageManager</span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> androidx.core.app.ActivityCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.ContextCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.content.ContextCompat.startActivity</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContactAdapter</span></span>(<span class="keyword">val</span> contactlist: List&lt;Contact&gt;): RecyclerView.Adapter&lt;ContactAdapter.ViewHolder&gt;() &#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(view: View) : RecyclerView.ViewHolder(view) &#123;</span><br><span class="line">        <span class="keyword">val</span> contact_image : ImageView = view.findViewById(R.id.contact_imageView)</span><br><span class="line">        <span class="keyword">val</span> contact_name : TextView = view.findViewById(R.id.contact_name)</span><br><span class="line">        <span class="keyword">val</span> contact_phone : TextView = view.findViewById(R.id.contact_phone)</span><br><span class="line">        <span class="keyword">val</span> phone_image : ImageView = view.findViewById(R.id.phone_image)</span><br><span class="line">        <span class="keyword">val</span> message_image : ImageView = view.findViewById(R.id.message_image)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.contact_item,parent,<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">val</span> viewHolder = ViewHolder(view)</span><br><span class="line">        viewHolder.itemView.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (ContextCompat.checkSelfPermission(parent.context, Manifest.permission.CALL_PHONE) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                ActivityCompat.requestPermissions(parent.context <span class="keyword">as</span> Activity, arrayOf(Manifest.permission.CALL_PHONE), <span class="number">1</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">val</span> intent = Intent(Intent.ACTION_CALL)</span><br><span class="line">                intent.<span class="keyword">data</span> = Uri.parse(<span class="string">&quot;tel:<span class="subst">$&#123;contact.number&#125;</span>&quot;</span>)</span><br><span class="line">                parent.context.startActivity(intent)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        viewHolder.itemView.setOnLongClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(parent.context,SendActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;number&quot;</span>,contact.number)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;name&quot;</span>,contact.name)</span><br><span class="line">            parent.context.startActivity(intent)</span><br><span class="line">            <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        viewHolder.message_image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(parent.context,SendActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;number&quot;</span>,contact.number)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;name&quot;</span>,contact.name)</span><br><span class="line">            parent.context.startActivity(intent)</span><br><span class="line">        &#125;</span><br><span class="line">        viewHolder.phone_image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (ContextCompat.checkSelfPermission(parent.context, Manifest.permission.CALL_PHONE) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                ActivityCompat.requestPermissions(parent.context <span class="keyword">as</span> Activity, arrayOf(Manifest.permission.CALL_PHONE), <span class="number">1</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">val</span> intent = Intent(Intent.ACTION_CALL)</span><br><span class="line">                intent.<span class="keyword">data</span> = Uri.parse(<span class="string">&quot;tel:<span class="subst">$&#123;contact.number&#125;</span>&quot;</span>)</span><br><span class="line">                parent.context.startActivity(intent)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> viewHolder</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">ContactAdapter</span>.<span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line">        holder.contact_image.setImageResource(contact.avadar)</span><br><span class="line">        holder.contact_name.text = contact.name</span><br><span class="line">        holder.contact_phone.text = contact.number</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = contactlist.size</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.contact_item.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/contact_imageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/contact_name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;144dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;26dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#3EB06A&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/contact_imageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/contact_phone&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;199dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;24dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;bottom&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/contact_imageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/contact_name&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/phone_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/phone&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/contact_phone&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/message_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/message&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/phone_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="3-布局文件"><a href="#3-布局文件" class="headerlink" title="3.布局文件"></a>3.布局文件</h3><blockquote>
<p>1.activity_main.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#3EB06A&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/appbar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;-20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/appbar&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/contactview&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.activity_send.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.SendActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#3EB06A&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/appbar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:elevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;-20dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/appbar&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginEnd</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#3EB06A&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;电话：&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/phonetext&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@id/phonetext&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/phonenumbertext&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">com.google.android.material.textfield.TextInputLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/textField&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                <span class="attr">android:minHeight</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.333&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@id/phonenumbertext&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">com.google.android.material.textfield.TextInputEditText</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/sms_edit&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:minHeight</span>=<span class="string">&quot;200dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">com.google.android.material.textfield.TextInputLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;279dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;267dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/undraw_new_message_re_fp03&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toTopOf</span>=<span class="string">&quot;@+id/sendbutton&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/textField&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintVertical_bias</span>=<span class="string">&quot;0.952&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.ExtendedFloatingActionButton</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#3EB06A&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;发送短信&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#ffffff&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:icon</span>=<span class="string">&quot;@drawable/ic_baseline_message_24&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:iconTint</span>=<span class="string">&quot;#ffffff&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/sendbutton&quot;</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="五、软件操作流程"><a href="#五、软件操作流程" class="headerlink" title="五、软件操作流程"></a>五、软件操作流程</h2><p>这么简单就懒得画了。。。。</p>
<h2 id="六、难点和解决方案"><a href="#六、难点和解决方案" class="headerlink" title="六、难点和解决方案"></a>六、难点和解决方案</h2><h4 id="1-长按调用问题"><a href="#1-长按调用问题" class="headerlink" title="1.长按调用问题"></a>1.长按调用问题</h4><p>解决方案：和短按<code>setOnClickListener</code>不一样的地方在于，长按<code>setOnLongClickListener</code>需要返回一个boolen参数，即返回一个<code>true</code>，在Java里直接return true就好,但是在kotlin里，默认用的是lambda表达式，最后一行语句是返回值，所以直接<code>true</code>就好</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">viewHolder.itemView.setOnLongClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> contact = contactlist[position]</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(parent.context,SendActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;number&quot;</span>,contact.number)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;name&quot;</span>,contact.name)</span><br><span class="line">            parent.context.startActivity(intent)</span><br><span class="line">            <span class="literal">true</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-随机头像"><a href="#2-随机头像" class="headerlink" title="2.随机头像"></a>2.随机头像</h4><p>解决方案：直接用了上次日记的素材了（kotlin的代码写起来真简洁）</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getavadar</span><span class="params">()</span></span>= <span class="keyword">when</span> ((<span class="number">1.</span><span class="number">.5</span>).random()) &#123;</span><br><span class="line">            <span class="number">1</span> -&gt; R.drawable.mood_1</span><br><span class="line">            <span class="number">2</span> -&gt; R.drawable.mood_2</span><br><span class="line">            <span class="number">3</span> -&gt; R.drawable.mood_3</span><br><span class="line">            <span class="number">4</span> -&gt; R.drawable.mood_4</span><br><span class="line">            <span class="number">5</span> -&gt; R.drawable.mood_5</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span> -&gt; &#123;R.drawable.mood_1&#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-隐藏导航栏问题"><a href="#3-隐藏导航栏问题" class="headerlink" title="3.隐藏导航栏问题"></a>3.隐藏导航栏问题</h4><p>解决方案：好像直接隐藏有导航栏的手机会导致界面无法点击，所以加一个<code>BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</code>就好</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br></pre></td></tr></table></figure>

<h2 id="七、不足之处"><a href="#七、不足之处" class="headerlink" title="七、不足之处"></a>七、不足之处</h2><p>功能简陋啦，还有很多可以做，比如增删改联系人，通话记录，短信读取什么的</p>
<h2 id="八、今后设想"><a href="#八、今后设想" class="headerlink" title="八、今后设想"></a>八、今后设想</h2><p>可以丰富一些功能</p>
]]></content>
      <categories>
        <category>作业</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>登录注册界面的设计与实现</title>
    <url>/2021/11/22/Login-sample/</url>
    <content><![CDATA[<h1 id="登录注册界面的设计与实现说明文档"><a href="#登录注册界面的设计与实现说明文档" class="headerlink" title="登录注册界面的设计与实现说明文档"></a>登录注册界面的设计与实现说明文档</h1><h2 id="一、软件名称"><a href="#一、软件名称" class="headerlink" title="一、软件名称"></a>一、软件名称</h2><p>​    简易登录注册界面</p>
<blockquote>
<p>Github项目地址：<a href="https://github.com/lnm011223/Login">https://github.com/lnm011223/Login</a>  , 里面还有个simple分支</p>
</blockquote>
<h2 id="二、软件内容简介"><a href="#二、软件内容简介" class="headerlink" title="二、软件内容简介"></a>二、软件内容简介</h2><p>一个有较为美观（个人认为）的登录，注册，重置密码，用户界面的软件，用了Sqlite增删查改用户信息，比较完整的模拟了登录，注册，忘记密码，下线，注销等功能，适配了深色模式（2021年怎么会还有app不支持深色模式啊）。</p>
<p>实现了一些人性化的小细节，比如点击忘记密码会自动填充在登录界面输入的账号在重置密码界面，重置密码时如果账号和邮箱不匹配，会自动清除邮箱的已输入内容，显示密码,记住密码，还有各种错误提醒，等等。</p>
<h2 id="三、界面设计"><a href="#三、界面设计" class="headerlink" title="三、界面设计"></a>三、界面设计</h2><h4 id="1-登录界面"><a href="#1-登录界面" class="headerlink" title="1.登录界面"></a>1.登录界面</h4><blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Sign%20in.png" alt="Sign in"></p>
</blockquote>
<h4 id="2-重置密码界面"><a href="#2-重置密码界面" class="headerlink" title="2.重置密码界面"></a>2.重置密码界面</h4><blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Reset.png" alt="Reset"></p>
</blockquote>
<h4 id="3-注册界面"><a href="#3-注册界面" class="headerlink" title="3.注册界面"></a>3.注册界面</h4><blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/Sign%20up.png" alt="Sign up"></p>
</blockquote>
<h4 id="4-用户信息界面"><a href="#4-用户信息界面" class="headerlink" title="4.用户信息界面"></a>4.用户信息界面</h4><blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/User.png" alt="User"></p>
</blockquote>
<h4 id="5-深色模式及英文适配展示"><a href="#5-深色模式及英文适配展示" class="headerlink" title="5.深色模式及英文适配展示"></a>5.深色模式及英文适配展示</h4><blockquote>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/dark%20and%20english.png" alt="dark and english"></p>
</blockquote>
<h2 id="四、关键代码"><a href="#四、关键代码" class="headerlink" title="四、关键代码"></a>四、关键代码</h2><h3 id="1-Activity逻辑"><a href="#1-Activity逻辑" class="headerlink" title="1.Activity逻辑"></a>1.Activity逻辑</h3><blockquote>
<p>1.MainActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.ActivityOptions</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.os.Build</span><br><span class="line"><span class="keyword">import</span> android.text.method.HideReturnsTransformationMethod</span><br><span class="line"><span class="keyword">import</span> android.text.method.PasswordTransformationMethod</span><br><span class="line"><span class="keyword">import</span> android.transition.Explode</span><br><span class="line"><span class="keyword">import</span> android.view.Window</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.<span class="keyword">annotation</span>.RequiresApi</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AlertDialog</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">BaseActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;Range&quot;</span>)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        <span class="comment">//非常重要，没有这句话监听无法生效</span></span><br><span class="line"></span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//icon color -&gt; black</span></span><br><span class="line">        <span class="comment">//activity.getWindow().getDecorView().getWindowInsetsController().setSystemBarsAppearance(APPEARANCE_LIGHT_STATUS_BARS, APPEARANCE_LIGHT_STATUS_BARS);</span></span><br><span class="line">        <span class="comment">//icon color -&gt; white</span></span><br><span class="line">        <span class="comment">//activity.getWindow().getDecorView().getWindowInsetsController().setSystemBarsAppearance(0, APPEARANCE_LIGHT_STATUS_BARS);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> counter = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightStatusBars = true</span></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightNavigationBars = true</span></span><br><span class="line">            insetsController?.apply &#123;</span><br><span class="line">                isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT</span><br><span class="line">        <span class="keyword">val</span> dbhelper = MyDatabaseHelper(<span class="keyword">this</span>,<span class="string">&quot;accountdata.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">        create_text.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>,signup_Activity::<span class="keyword">class</span>.java)</span><br><span class="line">            startActivity(intent)</span><br><span class="line">        &#125;</span><br><span class="line">        forgot.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> account = signin_accountEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>,forgotActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            intent.putExtra(<span class="string">&quot;forgot_account&quot;</span>,account)</span><br><span class="line">            startActivity(intent)</span><br><span class="line">            finish()</span><br><span class="line">        &#125;</span><br><span class="line">        show_check.setOnCheckedChangeListener &#123; compoundButton, b -&gt;</span><br><span class="line">            <span class="keyword">if</span> (b)&#123;</span><br><span class="line">                signin_passwordEdit.setTransformationMethod(HideReturnsTransformationMethod.getInstance())</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                signin_passwordEdit.setTransformationMethod(PasswordTransformationMethod.getInstance())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">val</span> prefs = getPreferences(Context.MODE_PRIVATE)</span><br><span class="line">        <span class="keyword">val</span> isremember = prefs.getBoolean(<span class="string">&quot;remember_password&quot;</span>,<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">if</span> (isremember) &#123;</span><br><span class="line">            <span class="keyword">val</span> account_remember = prefs.getString(<span class="string">&quot;account&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">val</span> password_remember = prefs.getString(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">            signin_accountEdit.setText(account_remember)</span><br><span class="line">            signin_passwordEdit.setText(password_remember)</span><br><span class="line">            remember_check.isChecked = <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        signin_Button.setOnClickListener &#123;</span><br><span class="line">            counter--</span><br><span class="line">            <span class="keyword">var</span> flag1 = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">val</span> account = signin_accountEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> password = signin_passwordEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> db = dbhelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> cursor = db.query(<span class="string">&quot;accountdata&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">val</span> editor = prefs.edit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cursor.moveToFirst()) &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> account_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;account&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> password_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> email_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;email&quot;</span>))</span><br><span class="line">                    <span class="keyword">if</span> (account_exist==account &amp;&amp; password_exist==password &amp;&amp; account!= <span class="string">&quot;&quot;</span> &amp;&amp; password != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                        flag1 = <span class="literal">false</span></span><br><span class="line">                        <span class="keyword">if</span> (remember_check.isChecked) &#123;</span><br><span class="line">                            editor.putBoolean(<span class="string">&quot;remember_password&quot;</span>,<span class="literal">true</span>)</span><br><span class="line">                            editor.putString(<span class="string">&quot;account&quot;</span>,account)</span><br><span class="line">                            editor.putString(<span class="string">&quot;password&quot;</span>,password)</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            editor.clear()</span><br><span class="line">                        &#125;</span><br><span class="line">                        editor.apply()</span><br><span class="line">                        <span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>,userActivity::<span class="keyword">class</span>.java)</span><br><span class="line"></span><br><span class="line">                        intent.putExtra(<span class="string">&quot;user_name&quot;</span>,account)</span><br><span class="line">                        intent.putExtra(<span class="string">&quot;user_email&quot;</span>,email_exist)</span><br><span class="line">                        startActivity(intent)</span><br><span class="line">                        finish()</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;<span class="keyword">while</span> (cursor.moveToNext())</span><br><span class="line">            &#125;</span><br><span class="line">            cursor.close()</span><br><span class="line">            <span class="keyword">if</span> (flag1) &#123;</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;剩余可尝试次数为 <span class="variable">$counter</span> 次&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (counter==<span class="number">0</span>) &#123;</span><br><span class="line">                AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                    setTitle(<span class="string">&quot;错误：&quot;</span>)</span><br><span class="line">                    setMessage(<span class="string">&quot;账号或密码错误，请检查或者重新注册&quot;</span>)</span><br><span class="line">                    setCancelable(<span class="literal">false</span>)</span><br><span class="line">                    setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                        ActivityCollector.finishAll()</span><br><span class="line">                        <span class="keyword">val</span> i = Intent(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">                        context.startActivity(i)</span><br><span class="line">                        finish()</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    show()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.signupActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AlertDialog</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_signup.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">signup_Activity</span> : <span class="type">BaseActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_signup)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            insetsController?.isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        insetsController?.systemBarsBehavior =</span><br><span class="line">            WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line"></span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> dbhelper = MyDatabaseHelper(<span class="keyword">this</span>, <span class="string">&quot;accountdata.db&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        already_text.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            startActivity(intent)</span><br><span class="line">            finish()</span><br><span class="line">        &#125;</span><br><span class="line">        signup_Button.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> db = dbhelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> email = signup_emailEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> account = signup_accountEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> password = signup_passwordEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> values = ContentValues().apply &#123;</span><br><span class="line">                <span class="comment">//组装数据</span></span><br><span class="line">                put(<span class="string">&quot;account&quot;</span>, account)</span><br><span class="line">                put(<span class="string">&quot;email&quot;</span>, email)</span><br><span class="line">                put(<span class="string">&quot;password&quot;</span>, password)</span><br><span class="line">            &#125;</span><br><span class="line">            db.insert(<span class="string">&quot;accountdata&quot;</span>, <span class="literal">null</span>, values)</span><br><span class="line">            AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                setTitle(<span class="string">&quot;成功：&quot;</span>)</span><br><span class="line">                setMessage(<span class="string">&quot;已成功创建账户，请回到登录界面&quot;</span>)</span><br><span class="line"></span><br><span class="line">                setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                    ActivityCollector.finishAll()</span><br><span class="line">                    <span class="keyword">val</span> i = Intent(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">                    context.startActivity(i)</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                show()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.userActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.util.Log</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AlertDialog</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_user.*</span><br><span class="line"><span class="keyword">import</span> kotlin.math.log</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">userActivity</span> : <span class="type">BaseActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_user)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            insetsController?.isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line"></span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT</span><br><span class="line">        <span class="keyword">val</span> dbhelper = MyDatabaseHelper(<span class="keyword">this</span>, <span class="string">&quot;accountdata.db&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">val</span> user_nametext = intent.getStringExtra(<span class="string">&quot;user_name&quot;</span>)</span><br><span class="line">        <span class="keyword">val</span> user_emailtext = intent.getStringExtra(<span class="string">&quot;user_email&quot;</span>)</span><br><span class="line">        user_account.text = user_nametext</span><br><span class="line">        user_email.text = user_emailtext</span><br><span class="line">        signout_Button.setOnClickListener &#123;</span><br><span class="line">            ActivityCollector.finishAll()</span><br><span class="line">            <span class="keyword">val</span> i = Intent(<span class="keyword">this</span>, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            startActivity(i)</span><br><span class="line">        &#125;</span><br><span class="line">        delete_Button.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> db = dbhelper.writableDatabase</span><br><span class="line">            db.delete(<span class="string">&quot;accountdata&quot;</span>,<span class="string">&quot;account = ?&quot;</span>, arrayOf(user_nametext))</span><br><span class="line">            AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                setTitle(<span class="string">&quot;成功：&quot;</span>)</span><br><span class="line">                setMessage(<span class="string">&quot;已删除账号！&quot;</span>)</span><br><span class="line">                setCancelable(<span class="literal">false</span>)</span><br><span class="line">                setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                    ActivityCollector.finishAll()</span><br><span class="line">                    <span class="keyword">val</span> i = Intent(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">                    context.startActivity(i)</span><br><span class="line">                    finish()</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                show()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>4.forgotActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AlertDialog</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_forgot.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.*</span><br><span class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_signup.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">forgotActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;Range&quot;</span>)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_forgot)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            insetsController?.isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line"></span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT</span><br><span class="line">        <span class="keyword">val</span> dbhelper = MyDatabaseHelper(<span class="keyword">this</span>,<span class="string">&quot;accountdata.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">val</span> forgot_user= intent.getStringExtra(<span class="string">&quot;forgot_account&quot;</span>)</span><br><span class="line">        forgot_accountEdit.setText(forgot_user)</span><br><span class="line">        forgot_Button.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">var</span> flag1 = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">val</span> email = forgot_emailEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> account = forgot_accountEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> password = forgot_passwordEdit.text.toString()</span><br><span class="line">            <span class="keyword">val</span> password1 = forgot_passwordEdit1.text.toString()</span><br><span class="line">            <span class="keyword">val</span> db = dbhelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> cursor = db.query(<span class="string">&quot;accountdata&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">if</span> (cursor.moveToFirst()) &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> account_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;account&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> password_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> email_exist = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;email&quot;</span>))</span><br><span class="line">                    <span class="keyword">if</span> (account_exist==account &amp;&amp; email_exist==email &amp;&amp; account!= <span class="string">&quot;&quot;</span> &amp;&amp; email != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                        flag1 = <span class="literal">false</span></span><br><span class="line">                        <span class="keyword">if</span> (password==password1 &amp;&amp; password != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">val</span> values = ContentValues()</span><br><span class="line">                            values.put(<span class="string">&quot;password&quot;</span>,password)</span><br><span class="line">                            db.update(<span class="string">&quot;accountdata&quot;</span>,values,<span class="string">&quot;account = ?&quot;</span>, arrayOf(account))</span><br><span class="line">                            AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                                setTitle(<span class="string">&quot;成功：&quot;</span>)</span><br><span class="line">                                setMessage(<span class="string">&quot;已成功重置密码，请回到登录界面&quot;</span>)</span><br><span class="line"></span><br><span class="line">                                setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                                    ActivityCollector.finishAll()</span><br><span class="line">                                    <span class="keyword">val</span> i = Intent(context, MainActivity::<span class="keyword">class</span>.java)</span><br><span class="line">                                    context.startActivity(i)</span><br><span class="line"></span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                show()</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                                setTitle(<span class="string">&quot;错误：&quot;</span>)</span><br><span class="line">                                setMessage(<span class="string">&quot;两次密码不一样！&quot;</span>)</span><br><span class="line"></span><br><span class="line">                                setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                                    forgot_passwordEdit1.setText(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                show()</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;<span class="keyword">while</span> (cursor.moveToNext())</span><br><span class="line">            &#125;</span><br><span class="line">            cursor.close()</span><br><span class="line">            <span class="keyword">if</span> (flag1) &#123;</span><br><span class="line">                AlertDialog.Builder(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">                    setTitle(<span class="string">&quot;错误：&quot;</span>)</span><br><span class="line">                    setMessage(<span class="string">&quot;邮箱与账号不匹配，请检查信息！&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    setPositiveButton(<span class="string">&quot;OK&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                        forgot_emailEdit.setText(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    show()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-布局文件"><a href="#2-布局文件" class="headerlink" title="2.布局文件"></a>2.布局文件</h3><blockquote>
<p>1.activity_main.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signin_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/welcome_back&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;@+id/signin_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signin_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;290dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;428dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.495&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:srcCompat</span>=<span class="string">&quot;@drawable/ic_undraw_secure_login_pdn4&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:ignore</span>=<span class="string">&quot;MissingConstraints&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:layout_editor_absoluteY</span>=<span class="string">&quot;-105dp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;345dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;190dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/signin_text&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/account&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/signin_accountEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPersonName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;115dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;@string/password&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/switch_button&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;@string/show&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:gravity</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">androidx.appcompat.widget.AppCompatCheckBox</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/show_check&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:buttonTint</span>=<span class="string">&quot;#2196F3&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/signin_passwordEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPassword&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;@string/remember&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">androidx.appcompat.widget.AppCompatCheckBox</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/remember_check&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:buttonTint</span>=<span class="string">&quot;#2196F3&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;@string/forgot_password&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:gravity</span>=<span class="string">&quot;end&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                     /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.button.MaterialButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signin_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;28dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/sign_in&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.498&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cornerRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingVertical</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.Button.UnelevatedButton&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;52dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/signin_Button&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;@string/new_user&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/create_text&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginLeft</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;@string/create_an_account&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;#2196F3&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>2.activity_forgot.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.forgotActivity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;290dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;428dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:srcCompat</span>=<span class="string">&quot;@drawable/ic_undraw_forgot_password_re_hxwm&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/update_password&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;@+id/forgot_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;345dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;275dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/forgot_text&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/email&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_emailEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPersonName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/account&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_accountEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPersonName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/new_password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_passwordEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPassword&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/verify_new_password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_passwordEdit1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPassword&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.button.MaterialButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/forgot_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;28dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cornerRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#536DFE&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/update&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.498&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingVertical</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.Button.UnelevatedButton&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>3.activity_user.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.userActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/user_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;290dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;428dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.495&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:srcCompat</span>=<span class="string">&quot;@drawable/ic_undraw_access_account_re_8spm&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:ignore</span>=<span class="string">&quot;MissingConstraints&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:layout_editor_absoluteY</span>=<span class="string">&quot;-58dp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/user_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/user_information&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;@+id/user_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/user_image&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/linearLayout2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;289dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_usertext_normal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:padding</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/user_text&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/account&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/user_account&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/email&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/user_email&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.button.MaterialButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signout_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.Button.UnelevatedButton&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingVertical</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/sign_out&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cornerRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toStartOf</span>=<span class="string">&quot;@+id/delete_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/linearLayout2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.button.MaterialButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:strokeWidth</span>=<span class="string">&quot;2dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:strokeColor</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/delete_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.Button.UnelevatedButton&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#00000000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingVertical</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/delete_account&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#F9A826&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cornerRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@id/signout_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/linearLayout2&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>4.activity_signup.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.signup_Activity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;290dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;428dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:srcCompat</span>=<span class="string">&quot;@drawable/ic_undraw_my_password_d_6_kg__1_&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;300dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/create_account&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;@+id/signup_image&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;345dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/signup_text&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/email&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_emailEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPersonName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/account&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_accountEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPersonName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;@string/password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_passwordEdit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/bg_edittext_normal&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:inputType</span>=<span class="string">&quot;textPassword&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:paddingStart</span>=<span class="string">&quot;15dp&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.button.MaterialButton</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/signup_Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;28dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cornerRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;@string/sign_up&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:backgroundTint</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.498&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/linearLayout&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:paddingVertical</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;@style/Widget.MaterialComponents.Button.UnelevatedButton&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;52dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintHorizontal_bias</span>=<span class="string">&quot;0.497&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/signup_Button&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;@string/already_have_an_account&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/already_text&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginLeft</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;@string/sign_in&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textColor</span>=<span class="string">&quot;#8bc34a&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-Sqlite逻辑"><a href="#3-Sqlite逻辑" class="headerlink" title="3.Sqlite逻辑"></a>3.Sqlite逻辑</h3><blockquote>
<p>MyDatabaseHelper.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteDatabase</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteOpenHelper</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDatabaseHelper</span></span>(<span class="keyword">val</span> context: Context,name: String,version: <span class="built_in">Int</span>): SQLiteOpenHelper(context,name,<span class="literal">null</span>,version) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> account_creat = <span class="string">&quot;create table accountdata (&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id integer primary key autoincrement,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;account text,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;email text,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;password text)&quot;</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(db: <span class="type">SQLiteDatabase</span>)</span></span> &#123;</span><br><span class="line">        db.execSQL(account_creat)</span><br><span class="line">        Toast.makeText(context,<span class="string">&quot;Create succeeded&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onUpgrade</span><span class="params">(db: <span class="type">SQLiteDatabase</span>?, oldVersion: <span class="type">Int</span>, newVersion: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="五、软件操作流程"><a href="#五、软件操作流程" class="headerlink" title="五、软件操作流程"></a>五、软件操作流程</h2><p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211116193524392.png" alt="image-20211116193524392"></p>
<h2 id="六、难点和解决方案"><a href="#六、难点和解决方案" class="headerlink" title="六、难点和解决方案"></a>六、难点和解决方案</h2><h4 id="1-状态栏图标颜色在白色背景以及深色模式下的适配"><a href="#1-状态栏图标颜色在白色背景以及深色模式下的适配" class="headerlink" title="1.状态栏图标颜色在白色背景以及深色模式下的适配"></a>1.状态栏图标颜色在白色背景以及深色模式下的适配</h4><p>解决方案：</p>
<p>可以用API31才有的<code>insetsController</code>功能，再写个<code>isDarkTheme</code>函数判断是否切换到深色模式</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            insetsController?.isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        window.statusBarColor = Color.TRANSPARENT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-用户信息的处理"><a href="#2-用户信息的处理" class="headerlink" title="2.用户信息的处理"></a>2.用户信息的处理</h4><p>解决方案：</p>
<p>可以利用Sqlite处理用户信息，增删查改分别对应注册，注销，登录，重置密码</p>
<h4 id="3-用户下线等操作"><a href="#3-用户下线等操作" class="headerlink" title="3.用户下线等操作"></a>3.用户下线等操作</h4><p>解决方案：</p>
<p>可以使所有activity重新继承一个<code>baseactivity</code>父类，重写相关函数</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.os.PersistableBundle</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?, persistentState: <span class="type">PersistableBundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        ActivityCollector.addActivity(<span class="keyword">this</span>)</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">        ActivityCollector.removeActivity(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="七、不足之处"><a href="#七、不足之处" class="headerlink" title="七、不足之处"></a>七、不足之处</h2><ul>
<li>1.用户信息以明文方式存在本地的数据里，不安全，可以加混淆的功能</li>
<li>2.一个真正的登录功能应该是从服务器匹配数据，可惜我暂时没有买服务器</li>
<li>3.还是有很多小细节没有顾及到，比如一些文字的配色懒得去处理了</li>
<li>4.实际上还是有点逻辑漏洞的，但是也足够用了</li>
</ul>
<h2 id="八、今后设想"><a href="#八、今后设想" class="headerlink" title="八、今后设想"></a>八、今后设想</h2><p>这次锻炼了 一下自定义布局文件，sqlite操作的能力，本来想用Room进行增删查改的，不过有点麻烦</p>
<p>可以继续完善小细节，并接入服务器存储用户信息</p>
]]></content>
      <categories>
        <category>作业</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>日记本的实现</title>
    <url>/2021/12/05/DiaryApp/</url>
    <content><![CDATA[<h1 id="日记本的设计与实现说明文档"><a href="#日记本的设计与实现说明文档" class="headerlink" title="日记本的设计与实现说明文档"></a>日记本的设计与实现说明文档</h1><h2 id="一、软件名称"><a href="#一、软件名称" class="headerlink" title="一、软件名称"></a>一、软件名称</h2><p>​    简易日记本</p>
<blockquote>
<p>GitHub项目地址：<a href="https://github.com/lnm011223/My_diary/">https://github.com/lnm011223/My_diary/</a></p>
</blockquote>
<h2 id="二、软件内容简介"><a href="#二、软件内容简介" class="headerlink" title="二、软件内容简介"></a>二、软件内容简介</h2><p>一个比较美观的日记本，有简单的记录，修改，删除，查看日记的功能，对应了sqlite的增删查改（本来想用room的，不过写完了发现有问题，懒得debug了，还是sqlite顺手）。</p>
<p>这次写的还是比较痛苦的，recycleview和各种不熟悉的东西加起来，布局也弄了个比较复杂的布局，一步步调整到现在的样子，这次的配色和布局参考了我在iOS上用的一个日记软件。</p>
<p>有一些有趣的小功能啦，比如五个emoji图标，点按后才会变亮</p>
<p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211205210854751.png"></p>
<h2 id="三、界面设计"><a href="#三、界面设计" class="headerlink" title="三、界面设计"></a>三、界面设计</h2><h4 id="1-日记列表"><a href="#1-日记列表" class="headerlink" title="1.日记列表"></a>1.日记列表</h4><blockquote>
<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211205233951208.png" alt="" style="zoom: 25%;" />
</blockquote>
<h4 id="2-新建日记"><a href="#2-新建日记" class="headerlink" title="2.新建日记"></a>2.新建日记</h4><blockquote>
<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211205234105432.png" alt="" style="zoom:25%;" />
</blockquote>
<h4 id="3-修改日历"><a href="#3-修改日历" class="headerlink" title="3.修改日历"></a>3.修改日历</h4><blockquote>
<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211205234142498.png" alt="" style="zoom:25%;" />
</blockquote>
<p>4.删除日历</p>
<blockquote>
<img src="    https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211205234217125.png" alt="" style="zoom:25%;" />
</blockquote>
<h2 id="四、关键代码"><a href="#四、关键代码" class="headerlink" title="四、关键代码"></a>四、关键代码</h2><h3 id="1-Activity逻辑"><a href="#1-Activity逻辑" class="headerlink" title="1.Activity逻辑"></a>1.Activity逻辑</h3><blockquote>
<p>1.MainActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> com.google.android.material.bottomnavigation.BottomNavigationView</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> androidx.core.net.toUri</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.findNavController</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.AppBarConfiguration</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.setupActionBarWithNavController</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.setupWithNavController</span><br><span class="line"><span class="keyword">import</span> com.lnm011223.my_diary.databinding.ActivityMainBinding</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> binding: ActivityMainBinding</span><br><span class="line">    <span class="keyword">var</span> image_uri = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> mood_id:<span class="built_in">Int</span> = R.drawable.mood_1</span><br><span class="line">    <span class="keyword">var</span> datetext:String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> diarytext:String = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        <span class="keyword">val</span> dbHelper = MyDatabaseHelper(MyApplication.context,<span class="string">&quot;DiaryData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">        dbHelper.writableDatabase</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> navView: BottomNavigationView = binding.navView</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> navController = findNavController(R.id.nav_host_fragment_activity_main)</span><br><span class="line">        <span class="comment">// Passing each menu ID as a set of Ids because each</span></span><br><span class="line">        <span class="comment">// menu should be considered as top level destinations.</span></span><br><span class="line">        <span class="comment">//val appBarConfiguration = AppBarConfiguration(</span></span><br><span class="line">        <span class="comment">//    setOf(</span></span><br><span class="line">        <span class="comment">//        R.id.navigation_home, R.id.navigation_dashboard, R.id.navigation_notifications</span></span><br><span class="line">        <span class="comment">//    )</span></span><br><span class="line">        <span class="comment">//)</span></span><br><span class="line">        <span class="comment">//setupActionBarWithNavController(navController, appBarConfiguration)</span></span><br><span class="line">        navView.setupWithNavController(navController)</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        window.statusBarColor = Color.parseColor(<span class="string">&quot;#F3F3EC&quot;</span>)</span><br><span class="line">        window.navigationBarColor = Color.parseColor(<span class="string">&quot;#ffffff&quot;</span>)</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightStatusBars = true</span></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightNavigationBars = true</span></span><br><span class="line">            insetsController?.apply &#123;</span><br><span class="line">                isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line">                isAppearanceLightNavigationBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        binding.fab.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> intent = Intent(<span class="keyword">this</span>,AddActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            startActivityForResult(intent,<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityResult</span><span class="params">(requestCode: <span class="type">Int</span>, resultCode: <span class="type">Int</span>, <span class="keyword">data</span>: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, <span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">when</span> (requestCode) &#123;</span><br><span class="line">            <span class="number">1</span> -&gt; <span class="keyword">if</span> (resultCode == RESULT_OK) &#123;</span><br><span class="line">                image_uri = <span class="keyword">data</span>?.getStringExtra(<span class="string">&quot;image_uri&quot;</span>).toString()</span><br><span class="line">                mood_id = <span class="keyword">data</span>?.getIntExtra(<span class="string">&quot;mood_id&quot;</span>,R.drawable.mood_1)!!</span><br><span class="line">                datetext = <span class="keyword">data</span>.getStringExtra(<span class="string">&quot;date_text&quot;</span>).toString()</span><br><span class="line">                diarytext = <span class="keyword">data</span>.getStringExtra(<span class="string">&quot;diary_text1&quot;</span>).toString()</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.AddActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.BitmapFactory</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"><span class="keyword">import</span> com.lnm011223.my_diary.databinding.ActivityAddBinding</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> binding: ActivityAddBinding</span><br><span class="line">    <span class="keyword">var</span> mood_flag:<span class="built_in">Int</span> = R.drawable.mood_1</span><br><span class="line">    <span class="keyword">var</span> uri1: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;SimpleDateFormat&quot;</span>)</span></span><br><span class="line">    <span class="keyword">val</span> formAlbum = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> flag1 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag2 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag3 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag4 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag5 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        binding = ActivityAddBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        binding.dateText.text = SimpleDateFormat(<span class="string">&quot;MM 月 dd 日 E&quot;</span>).format(Date())</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        window.statusBarColor = Color.parseColor(<span class="string">&quot;#F3F3EC&quot;</span>)</span><br><span class="line">        window.navigationBarColor = Color.parseColor(<span class="string">&quot;#F3F3EC&quot;</span>)</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightStatusBars = true</span></span><br><span class="line">            <span class="comment">//insetsController?.isAppearanceLightNavigationBars = true</span></span><br><span class="line">            insetsController?.apply &#123;</span><br><span class="line">                isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line">                isAppearanceLightNavigationBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">val</span> dbHelper = MyDatabaseHelper(MyApplication.context,<span class="string">&quot;DiaryData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">        dbHelper.writableDatabase</span><br><span class="line"></span><br><span class="line">        binding.imageShow.setOnClickListener &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> intent = Intent(Intent.ACTION_OPEN_DOCUMENT)</span><br><span class="line">            intent.addCategory(Intent.CATEGORY_OPENABLE)</span><br><span class="line">            intent.type = <span class="string">&quot;image/*&quot;</span></span><br><span class="line">            startActivityForResult(intent,formAlbum)</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood1Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag1 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood1Image.setImageResource(R.drawable.mood_1)</span><br><span class="line">                flag1 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood1Image,flag1)</span><br><span class="line">                mood_flag = R.drawable.mood_1</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                flag1 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood2Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag2 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood2Image.setImageResource(R.drawable.mood_2)</span><br><span class="line">                flag2 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood2Image,flag2)</span><br><span class="line">                mood_flag = R.drawable.mood_2</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                flag2 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood3Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag3 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood3Image.setImageResource(R.drawable.mood_3)</span><br><span class="line">                flag3 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood3Image,flag3)</span><br><span class="line">                mood_flag = R.drawable.mood_3</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                flag3 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood4Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag4 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood4Image.setImageResource(R.drawable.mood_4)</span><br><span class="line">                flag4 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood4Image,flag4)</span><br><span class="line">                mood_flag = R.drawable.mood_4</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                flag4 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood5Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag5 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood5Image.setImageResource(R.drawable.mood_5)</span><br><span class="line">                flag5 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood5Image,flag5)</span><br><span class="line">                mood_flag = R.drawable.mood_5</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line">                flag5 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.completeButton.setOnClickListener &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> diary_text = binding.diarytextEdit.text.toString()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> intent = Intent()</span><br><span class="line">            <span class="keyword">val</span> db = dbHelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> diary_value = ContentValues().apply &#123;</span><br><span class="line">                put(<span class="string">&quot;imageuri&quot;</span>,uri1)</span><br><span class="line">                put(<span class="string">&quot;moodid&quot;</span>,mood_flag)</span><br><span class="line">                put(<span class="string">&quot;datetext&quot;</span>,SimpleDateFormat(<span class="string">&quot;MM 月 dd 日 E&quot;</span>).format(Date()))</span><br><span class="line">                put(<span class="string">&quot;diarytext&quot;</span>,diary_text)</span><br><span class="line">            &#125;</span><br><span class="line">            db.insert(<span class="string">&quot;diarydata&quot;</span>,<span class="literal">null</span>,diary_value)</span><br><span class="line"></span><br><span class="line">            intent.apply &#123;</span><br><span class="line">                putExtra(<span class="string">&quot;image_uri&quot;</span>,uri1)</span><br><span class="line">                putExtra(<span class="string">&quot;mood_id&quot;</span>,mood_flag)</span><br><span class="line">                putExtra(<span class="string">&quot;date_text&quot;</span>,SimpleDateFormat(<span class="string">&quot;dd E&quot;</span>).format(Date()))</span><br><span class="line">                putExtra(<span class="string">&quot;diary_text1&quot;</span>,diary_text)</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            setResult(RESULT_OK,intent)</span><br><span class="line">            finish()</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityResult</span><span class="params">(requestCode: <span class="type">Int</span>, resultCode: <span class="type">Int</span>, <span class="keyword">data</span>: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, <span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">when</span> (requestCode) &#123;</span><br><span class="line">            formAlbum -&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (resultCode == Activity.RESULT_OK &amp;&amp; <span class="keyword">data</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">data</span>.<span class="keyword">data</span>?.let &#123; uri -&gt;</span><br><span class="line">                        uri1 = uri.toString()</span><br><span class="line">                        <span class="keyword">val</span> bitmap = getBitmapFromuri(uri)</span><br><span class="line">                        binding.imageShow.setImageURI(uri)</span><br><span class="line">                        binding.imageShow.setPadding(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getBitmapFromuri</span><span class="params">(uri: <span class="type">Uri</span>)</span></span> = contentResolver.openFileDescriptor(uri,<span class="string">&quot;r&quot;</span>)?.use &#123; BitmapFactory.decodeFileDescriptor(it.fileDescriptor) &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">changeOther</span><span class="params">(imageView: <span class="type">ImageView</span>,flag:<span class="type">Boolean</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (flag==<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">when</span> (imageView) &#123;</span><br><span class="line">                binding.mood1Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood2Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood3Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood4Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood5Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.ReviseActivity.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"><span class="keyword">import</span> androidx.core.net.toUri</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsControllerCompat</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.lnm011223.my_diary.databinding.ActivityReviseBinding</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat</span><br><span class="line"><span class="keyword">import</span> java.util.*</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReviseActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> binding: ActivityReviseBinding</span><br><span class="line">    <span class="keyword">var</span> mood_flag:<span class="built_in">Int</span> = R.drawable.mood_1</span><br><span class="line">    <span class="keyword">var</span> uri1: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;SimpleDateFormat&quot;</span>)</span></span><br><span class="line">    <span class="keyword">val</span> formAlbum = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> flag1 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag2 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag3 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag4 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> flag5 = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        binding = ActivityReviseBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        <span class="keyword">val</span> dbHelper = MyDatabaseHelper(MyApplication.context,<span class="string">&quot;DiaryData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">val</span> db = dbHelper.writableDatabase</span><br><span class="line">        <span class="keyword">val</span> insetsController = WindowCompat.getInsetsController(</span><br><span class="line">            window, window.decorView</span><br><span class="line">        )</span><br><span class="line">        window.statusBarColor = Color.parseColor(<span class="string">&quot;#F3F3EC&quot;</span>)</span><br><span class="line">        window.navigationBarColor = Color.parseColor(<span class="string">&quot;#F3F3EC&quot;</span>)</span><br><span class="line">        insetsController?.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE</span><br><span class="line">        insetsController?.hide(WindowInsetsCompat.Type.navigationBars())</span><br><span class="line">        <span class="keyword">if</span> (!isDarkTheme(<span class="keyword">this</span>))&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            insetsController?.apply &#123;</span><br><span class="line">                isAppearanceLightStatusBars = <span class="literal">true</span></span><br><span class="line">                isAppearanceLightNavigationBars = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">val</span> datetext = intent.getStringExtra(<span class="string">&quot;datetext&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> diarytext = intent.getStringExtra(<span class="string">&quot;diarytext&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> imageuri = intent.getStringExtra(<span class="string">&quot;imageuri&quot;</span>)?.toUri()</span><br><span class="line">        <span class="comment">//val moodid = intent.getIntExtra(&quot;moodid&quot;,R.drawable.mood_1)</span></span><br><span class="line">        binding.dateText.text = datetext</span><br><span class="line">        binding.diarytextEdit.setText(diarytext)</span><br><span class="line">        binding.imageShow.setImageURI(imageuri)</span><br><span class="line">        <span class="keyword">val</span> diarytext_backup = intent.getStringExtra(<span class="string">&quot;diarytext&quot;</span>)</span><br><span class="line"></span><br><span class="line">        binding.completeButton.setOnClickListener &#123;</span><br><span class="line">            diarytext = binding.diarytextEdit.text.toString()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> diary_value = ContentValues().apply &#123;</span><br><span class="line">                put(<span class="string">&quot;imageuri&quot;</span>,uri1)</span><br><span class="line">                put(<span class="string">&quot;moodid&quot;</span>,mood_flag)</span><br><span class="line"></span><br><span class="line">                put(<span class="string">&quot;diarytext&quot;</span>,diarytext)</span><br><span class="line">            &#125;</span><br><span class="line">            db.update(<span class="string">&quot;diarydata&quot;</span>,diary_value,<span class="string">&quot;diarytext = ?&quot;</span>, arrayOf(diarytext_backup))</span><br><span class="line">            finish()</span><br><span class="line">        &#125;</span><br><span class="line">        binding.imageShow.setOnClickListener &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> intent = Intent(Intent.ACTION_OPEN_DOCUMENT)</span><br><span class="line">            intent.addCategory(Intent.CATEGORY_OPENABLE)</span><br><span class="line">            intent.type = <span class="string">&quot;image/*&quot;</span></span><br><span class="line">            startActivityForResult(intent,formAlbum)</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood1Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag1 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood1Image.setImageResource(R.drawable.mood_1)</span><br><span class="line">                flag1 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood1Image,flag1)</span><br><span class="line">                mood_flag = R.drawable.mood_1</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                flag1 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood2Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag2 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood2Image.setImageResource(R.drawable.mood_2)</span><br><span class="line">                flag2 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood2Image,flag2)</span><br><span class="line">                mood_flag = R.drawable.mood_2</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                flag2 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood3Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag3 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood3Image.setImageResource(R.drawable.mood_3)</span><br><span class="line">                flag3 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood3Image,flag3)</span><br><span class="line">                mood_flag = R.drawable.mood_3</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                flag3 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood4Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag4 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood4Image.setImageResource(R.drawable.mood_4)</span><br><span class="line">                flag4 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood4Image,flag4)</span><br><span class="line">                mood_flag = R.drawable.mood_4</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                flag4 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        binding.mood5Image.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag5 == <span class="literal">false</span>) &#123;</span><br><span class="line">                binding.mood5Image.setImageResource(R.drawable.mood_5)</span><br><span class="line">                flag5 = <span class="literal">true</span></span><br><span class="line">                changeOther(binding.mood5Image,flag5)</span><br><span class="line">                mood_flag = R.drawable.mood_5</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                binding.mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line">                flag5 = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isDarkTheme</span><span class="params">(context: <span class="type">Context</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> flag = context.resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK</span><br><span class="line">        <span class="keyword">return</span> flag == Configuration.UI_MODE_NIGHT_YES</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">changeOther</span><span class="params">(imageView: <span class="type">ImageView</span>, flag:<span class="type">Boolean</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (flag==<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">when</span> (imageView) &#123;</span><br><span class="line">                binding.mood1Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood2Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood3Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood4Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line">                        mood5Image.setImageResource(R.drawable.mood_5_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line">                    flag5 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                binding.mood5Image -&gt; &#123;</span><br><span class="line">                    binding.apply &#123;</span><br><span class="line">                        mood2Image.setImageResource(R.drawable.mood_2_last)</span><br><span class="line">                        mood3Image.setImageResource(R.drawable.mood_3_last)</span><br><span class="line">                        mood4Image.setImageResource(R.drawable.mood_4_last)</span><br><span class="line">                        mood1Image.setImageResource(R.drawable.mood_1_last)</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    flag2 = <span class="literal">false</span></span><br><span class="line">                    flag3 = <span class="literal">false</span></span><br><span class="line">                    flag4 = <span class="literal">false</span></span><br><span class="line">                    flag1 = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityResult</span><span class="params">(requestCode: <span class="type">Int</span>, resultCode: <span class="type">Int</span>, <span class="keyword">data</span>: <span class="type">Intent</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, <span class="keyword">data</span>)</span><br><span class="line">        <span class="keyword">when</span> (requestCode) &#123;</span><br><span class="line">            formAlbum -&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (resultCode == Activity.RESULT_OK &amp;&amp; <span class="keyword">data</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">data</span>.<span class="keyword">data</span>?.let &#123; uri -&gt;</span><br><span class="line">                        uri1 = uri.toString()</span><br><span class="line"></span><br><span class="line">                        binding.imageShow.setImageURI(uri)</span><br><span class="line">                        binding.imageShow.setPadding(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>4.DashboardFragment.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary.ui.dashboard</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.graphics.Color</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> androidx.core.net.toUri</span><br><span class="line"><span class="keyword">import</span> androidx.fragment.app.Fragment</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.LinearLayoutManager</span><br><span class="line"><span class="keyword">import</span> com.lnm011223.my_diary.*</span><br><span class="line"><span class="keyword">import</span> com.lnm011223.my_diary.databinding.FragmentDashboardBinding</span><br><span class="line"><span class="keyword">import</span> kotlin.concurrent.thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DashboardFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> dashboardViewModel: DashboardViewModel</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _binding: FragmentDashboardBinding? = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> diaryList = ArrayList&lt;Diary&gt;()</span><br><span class="line">    <span class="keyword">val</span> dbHelper = MyDatabaseHelper(MyApplication.context,<span class="string">&quot;DiaryData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This property is only valid between onCreateView and</span></span><br><span class="line">    <span class="comment">// onDestroyView.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> binding <span class="keyword">get</span>() = _binding!!</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateView</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        inflater: <span class="type">LayoutInflater</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">        container: <span class="type">ViewGroup</span>?,</span></span></span><br><span class="line"><span class="params"><span class="function">        savedInstanceState: <span class="type">Bundle</span>?</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>: View? &#123;</span><br><span class="line">        dashboardViewModel =</span><br><span class="line">            ViewModelProvider(<span class="keyword">this</span>).<span class="keyword">get</span>(DashboardViewModel::<span class="keyword">class</span>.java)</span><br><span class="line"></span><br><span class="line">        _binding = FragmentDashboardBinding.inflate(inflater, container, <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">val</span> root: View = binding.root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroyView</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroyView()</span><br><span class="line">        _binding = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;NotifyDataSetChanged&quot;</span>)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart()</span><br><span class="line">        initDiary()</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinearLayoutManager(context)</span><br><span class="line">        binding.diaryRecycle.layoutManager = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter = DiaryAdapter(diaryList)</span><br><span class="line">        binding.diaryRecycle.adapter = adapter</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@SuppressLint(<span class="meta-string">&quot;Range&quot;</span>)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initDiary</span><span class="params">()</span></span>&#123;</span><br><span class="line">        thread &#123;</span><br><span class="line">            diaryList.clear()</span><br><span class="line">            <span class="keyword">val</span> db = dbHelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> cursor = db.query(<span class="string">&quot;diarydata&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">if</span> (cursor.moveToFirst()) &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">val</span> datetext = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;datetext&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> imageuri = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;imageuri&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> moodid = cursor.getInt(cursor.getColumnIndex(<span class="string">&quot;moodid&quot;</span>))</span><br><span class="line">                    <span class="keyword">val</span> diarytext = cursor.getString(cursor.getColumnIndex(<span class="string">&quot;diarytext&quot;</span>))</span><br><span class="line">                    diaryList.add(Diary(datetext,moodid,imageuri.toUri(),diarytext))</span><br><span class="line">                &#125;<span class="keyword">while</span> (cursor.moveToNext())</span><br><span class="line">            &#125;</span><br><span class="line">            cursor.close()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Recycleview相关"><a href="#2-Recycleview相关" class="headerlink" title="2.Recycleview相关"></a>2.Recycleview相关</h3><blockquote>
<p>1.Diary.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Diary</span></span>(<span class="keyword">val</span> date_text:String, <span class="keyword">val</span> moon:<span class="built_in">Int</span>, <span class="keyword">val</span> diary_image:Uri, <span class="keyword">val</span> diary_text: String)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.DiaryAdapter.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.AlertDialog</span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.graphics.BitmapFactory</span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView</span><br><span class="line"><span class="keyword">import</span> android.graphics.Bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiaryAdapter</span></span>(<span class="keyword">val</span> diaryList: List&lt;Diary&gt;) : RecyclerView.Adapter&lt;DiaryAdapter.ViewHolder&gt;()&#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>(view: View) : RecyclerView.ViewHolder(view) &#123;</span><br><span class="line">        <span class="keyword">val</span> diarycard_mood : ImageView = view.findViewById(R.id.diarycard_mood)</span><br><span class="line">        <span class="keyword">val</span> diarycard_image : ImageView = view.findViewById(R.id.diarycard_image)</span><br><span class="line">        <span class="keyword">val</span> diarycard_date : TextView = view.findViewById(R.id.diarycard_date)</span><br><span class="line">        <span class="keyword">val</span> diarycard_text : TextView = view.findViewById(R.id.diarycard_text)</span><br><span class="line">        <span class="keyword">val</span> delete_button : ImageView = view.findViewById(R.id.delete_image)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = diaryList.size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.from(parent.context)</span><br><span class="line">            .inflate(R.layout.diary_card,parent,<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">val</span> viewHolder = ViewHolder(view)</span><br><span class="line">        viewHolder.delete_button.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> dbHelper = MyDatabaseHelper(MyApplication.context,<span class="string">&quot;DiaryData.db&quot;</span>,<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">val</span> db = dbHelper.writableDatabase</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> diary = diaryList[position]</span><br><span class="line">            AlertDialog.Builder(parent.context).apply &#123;</span><br><span class="line">                setTitle(<span class="string">&quot;确认：&quot;</span>)</span><br><span class="line">                setMessage(<span class="string">&quot;真的要删除这条记录吗？&quot;</span>)</span><br><span class="line">                setNegativeButton(<span class="string">&quot;否&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                setPositiveButton(<span class="string">&quot;是&quot;</span>) &#123; _, _ -&gt;</span><br><span class="line">                    db.delete(<span class="string">&quot;diarydata&quot;</span>, <span class="string">&quot;diarytext = ?&quot;</span>, arrayOf(diary.diary_text))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                show()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        viewHolder.itemView.setOnClickListener &#123;</span><br><span class="line">            <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">            <span class="keyword">val</span> diary = diaryList[position]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">val</span> intent = Intent(parent.context,ReviseActivity::<span class="keyword">class</span>.java)</span><br><span class="line">            intent.apply &#123;</span><br><span class="line">                putExtra(<span class="string">&quot;datetext&quot;</span>,diary.date_text)</span><br><span class="line">                putExtra(<span class="string">&quot;diarytext&quot;</span>,diary.diary_text)</span><br><span class="line">                putExtra(<span class="string">&quot;imageuri&quot;</span>,diary.diary_image.toString())</span><br><span class="line">                putExtra(<span class="string">&quot;moonid&quot;</span>,diary.moon)</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            parent.context.startActivity(intent)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> viewHolder</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">ViewHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> diary = diaryList[position]</span><br><span class="line">        holder.diarycard_mood.setImageResource(diary.moon)</span><br><span class="line">        holder.diarycard_date.text = diary.date_text.substring(<span class="number">5</span>,<span class="number">7</span>)+<span class="string">&quot; &quot;</span>+diary.date_text.substring(<span class="number">10</span>,<span class="number">12</span>)</span><br><span class="line">        holder.diarycard_text.text = diary.diary_text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        holder.diarycard_image.setImageURI(diary.diary_image)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.diary_card.xml        //recycleview的核心</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginVertical</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;264dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardElevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_margin</span>=<span class="string">&quot;15dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/diarycard_mood&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;57dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:src</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toTopOf</span>=<span class="string">&quot;@+id/materialCardView&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintVertical_bias</span>=<span class="string">&quot;0.0&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/materialCardView&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;63dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;140dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#eeeeee&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:cardElevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/diarycard_date&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;6dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_marginVertical</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:text</span>=<span class="string">&quot;01 周五&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textColor</span>=<span class="string">&quot;#707070&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/delete_image&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;30dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;24dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_delete&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/materialCardView&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/imageView2&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;3dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;234dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/button_drawable&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#eeeeee&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/materialCardView&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/diarycard_text&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;255dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:maxLines</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;dddd&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textColor</span>=<span class="string">&quot;#707070&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/imageView2&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">tools:layout_editor_absoluteY</span>=<span class="string">&quot;0dp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;255dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;190dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginStart</span>=<span class="string">&quot;6dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:backgroundTint</span>=<span class="string">&quot;#eeeeee&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:scaleType</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:cardElevation</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toEndOf</span>=<span class="string">&quot;@+id/imageView2&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@+id/diarycard_text&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintVertical_bias</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/diarycard_image&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:scaleType</span>=<span class="string">&quot;center&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-Sqlite相关"><a href="#3-Sqlite相关" class="headerlink" title="3.Sqlite相关"></a>3.Sqlite相关</h3><blockquote>
<p>MyDatabaseHelper.kt</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteDatabase</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteOpenHelper</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDatabaseHelper</span></span>(<span class="keyword">val</span> context: Context, name: String, version: <span class="built_in">Int</span>): SQLiteOpenHelper(context,name,<span class="literal">null</span>,version) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> account_creat = <span class="string">&quot;create table diarydata (&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id integer primary key autoincrement,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;datetext text,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;moodid integer,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;imageuri text,&quot;</span> +</span><br><span class="line">            <span class="string">&quot;diarytext text)&quot;</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(db: <span class="type">SQLiteDatabase</span>)</span></span> &#123;</span><br><span class="line">        db.execSQL(account_creat)</span><br><span class="line">        Toast.makeText(context,<span class="string">&quot;Create succeeded&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onUpgrade</span><span class="params">(db: <span class="type">SQLiteDatabase</span>?, oldVersion: <span class="type">Int</span>, newVersion: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-布局文件"><a href="#4-布局文件" class="headerlink" title="4.布局文件"></a>4.布局文件</h3><blockquote>
<p>1.activity_main.xml</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    xmlns:tools=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">    android:id=<span class="string">&quot;@+id/container&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:background=<span class="string">&quot;#F3F3EC&quot;</span></span><br><span class="line"></span><br><span class="line">    &gt;</span><br><span class="line"></span><br><span class="line">    &lt;fragment</span><br><span class="line">        android:id=<span class="string">&quot;@+id/nav_host_fragment_activity_main&quot;</span></span><br><span class="line">        android:name=<span class="string">&quot;androidx.navigation.fragment.NavHostFragment&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        app:defaultNavHost=<span class="string">&quot;true&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/bottomAppBar&quot;</span></span><br><span class="line">        app:layout_constraintTop_toTopOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:navGraph=<span class="string">&quot;@navigation/mobile_navigation&quot;</span></span><br><span class="line">        tools:layout_editor_absoluteX=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;56dp&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.bottomappbar.BottomAppBar</span><br><span class="line">        android:id=<span class="string">&quot;@+id/bottomAppBar&quot;</span></span><br><span class="line"></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_gravity=<span class="string">&quot;bottom&quot;</span></span><br><span class="line">        app:backgroundTint=<span class="string">&quot;#ffffff&quot;</span></span><br><span class="line"></span><br><span class="line">        app:contentInsetEnd=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:contentInsetStart=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:fabAlignmentMode=<span class="string">&quot;end&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        &gt;</span><br><span class="line"></span><br><span class="line">        &lt;com.google.android.material.bottomnavigation.BottomNavigationView</span><br><span class="line">            android:layout_gravity=<span class="string">&quot;bottom&quot;</span></span><br><span class="line">            app:labelVisibilityMode=<span class="string">&quot;selected&quot;</span></span><br><span class="line">            android:id=<span class="string">&quot;@+id/nav_view&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_marginStart=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">            android:layout_marginEnd=<span class="string">&quot;100dp&quot;</span></span><br><span class="line">            android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">            app:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">            app:backgroundTint=<span class="string">&quot;@android:color/transparent&quot;</span></span><br><span class="line">            app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">            app:layout_constraintLeft_toLeftOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">            app:layout_constraintRight_toRightOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">            app:menu=<span class="string">&quot;@menu/bottom_nav_menu&quot;</span></span><br><span class="line">            app:itemIconTint=<span class="string">&quot;@color/selector_color&quot;</span></span><br><span class="line">            app:itemTextColor=<span class="string">&quot;@color/selector_color&quot;</span></span><br><span class="line">            /&gt;</span><br><span class="line">    &lt;/com.google.android.material.bottomappbar.BottomAppBar&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton</span><br><span class="line">        android:id=<span class="string">&quot;@+id/fab&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:backgroundTint=<span class="string">&quot;#B8D68A&quot;</span></span><br><span class="line">        app:borderWidth=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:src=<span class="string">&quot;@drawable/ic_baseline_add_24&quot;</span></span><br><span class="line"></span><br><span class="line">        app:tint=<span class="string">&quot;#000000&quot;</span></span><br><span class="line"></span><br><span class="line">        app:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_anchor=<span class="string">&quot;@id/bottomAppBar&quot;</span> /&gt;</span><br><span class="line">&lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.activity_add.xml</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    xmlns:tools=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:background=<span class="string">&quot;#F3F3EC&quot;</span></span><br><span class="line"></span><br><span class="line">    android:fitsSystemWindows=<span class="string">&quot;true&quot;</span></span><br><span class="line">    tools:context=<span class="string">&quot;.AddActivity&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/date_text&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">        android:textSize=<span class="string">&quot;20sp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/card_mood&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintTop_toTopOf=<span class="string">&quot;parent&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/card_mood&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/photo_card&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;androidx.constraintlayout.widget.ConstraintLayout</span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_margin=<span class="string">&quot;10dp&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;TextView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:text=<span class="string">&quot;今天的心情&quot;</span></span><br><span class="line">                android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">                android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">                android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line">                app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintTop_toTopOf=<span class="string">&quot;parent&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood1_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_1_last&quot;</span></span><br><span class="line">                app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood2_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_marginStart=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_2_last&quot;</span></span><br><span class="line">                app:layout_constraintStart_toEndOf=<span class="string">&quot;@+id/mood1_image&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood3_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:layout_marginStart=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_3_last&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toStartOf=<span class="string">&quot;@+id/mood4_image&quot;</span></span><br><span class="line">                app:layout_constraintHorizontal_bias=<span class="string">&quot;0.512&quot;</span></span><br><span class="line">                app:layout_constraintStart_toEndOf=<span class="string">&quot;@+id/mood2_image&quot;</span></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood4_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_4_last&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toStartOf=<span class="string">&quot;@+id/mood5_image&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood5_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_5_last&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line">        &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/photo_card&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/card_text&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:orientation=<span class="string">&quot;vertical&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;TextView</span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:text=<span class="string">&quot;今天的照片&quot;</span></span><br><span class="line">                android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">                android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">                android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line"></span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">                android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#eeeeee&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;7dp&quot;</span></span><br><span class="line">                android:layout_marginBottom=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">                app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span>&gt;</span><br><span class="line">                &lt;ImageView</span><br><span class="line">                    android:id=<span class="string">&quot;@+id/image_show&quot;</span></span><br><span class="line">                    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">                    android:layout_height=<span class="string">&quot;300dp&quot;</span></span><br><span class="line">                    android:scaleType=<span class="string">&quot;center&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    android:src=<span class="string">&quot;@drawable/ic_baseline_camera_alt_24&quot;</span></span><br><span class="line"></span><br><span class="line">                    android:padding=<span class="string">&quot;65dp&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    /&gt;</span><br><span class="line">            &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/card_text&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;100dp&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/complete_Button&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;一行日记&quot;</span></span><br><span class="line">            android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">            android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">            android:textStyle=<span class="string">&quot;bold&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;com.google.android.material.textfield.TextInputEditText</span><br><span class="line">            android:id=<span class="string">&quot;@+id/diarytext_edit&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_gravity=<span class="string">&quot;bottom&quot;</span></span><br><span class="line">            android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:layout_marginBottom=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">            android:background=<span class="string">&quot;@drawable/button_drawable&quot;</span></span><br><span class="line">            android:backgroundTint=<span class="string">&quot;#eeeeee&quot;</span></span><br><span class="line">            android:maxLines=<span class="string">&quot;2&quot;</span></span><br><span class="line">            android:hint=<span class="string">&quot;请输入内容&quot;</span></span><br><span class="line">            android:paddingStart=<span class="string">&quot;10dp&quot;</span> /&gt;</span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.button.MaterialButton</span><br><span class="line">        android:id=<span class="string">&quot;@+id/complete_Button&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;50dp&quot;</span></span><br><span class="line">        android:backgroundTint=<span class="string">&quot;#3EB06A&quot;</span></span><br><span class="line">        android:insetTop=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:insetBottom=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:text=<span class="string">&quot;制作完成&quot;</span></span><br><span class="line">        android:textSize=<span class="string">&quot;18dp&quot;</span></span><br><span class="line">        android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line">        app:cornerRadius=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        tools:layout_editor_absoluteX=<span class="string">&quot;0dp&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.activity_revise.xml</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="line">    xmlns:app=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="line">    xmlns:tools=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="line">    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:background=<span class="string">&quot;#F3F3EC&quot;</span></span><br><span class="line"></span><br><span class="line">    android:fitsSystemWindows=<span class="string">&quot;true&quot;</span></span><br><span class="line">    tools:context=<span class="string">&quot;.ReviseActivity&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/date_text&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">        android:textSize=<span class="string">&quot;20sp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/card_mood&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintTop_toTopOf=<span class="string">&quot;parent&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/card_mood&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/photo_card&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;androidx.constraintlayout.widget.ConstraintLayout</span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_margin=<span class="string">&quot;10dp&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;TextView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:text=<span class="string">&quot;今天的心情&quot;</span></span><br><span class="line">                android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">                android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">                android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line">                app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintTop_toTopOf=<span class="string">&quot;parent&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood1_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_1_last&quot;</span></span><br><span class="line">                app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood2_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_marginStart=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_2_last&quot;</span></span><br><span class="line">                app:layout_constraintStart_toEndOf=<span class="string">&quot;@+id/mood1_image&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood3_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:layout_marginStart=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;20dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_3_last&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toStartOf=<span class="string">&quot;@+id/mood4_image&quot;</span></span><br><span class="line">                app:layout_constraintHorizontal_bias=<span class="string">&quot;0.512&quot;</span></span><br><span class="line">                app:layout_constraintStart_toEndOf=<span class="string">&quot;@+id/mood2_image&quot;</span></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood4_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:layout_marginEnd=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_4_last&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toStartOf=<span class="string">&quot;@+id/mood5_image&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">            &lt;ImageView</span><br><span class="line">                android:id=<span class="string">&quot;@+id/mood5_image&quot;</span></span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line"></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#00000000&quot;</span></span><br><span class="line">                android:src=<span class="string">&quot;@drawable/mood_5_last&quot;</span></span><br><span class="line">                app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">                tools:layout_editor_absoluteY=<span class="string">&quot;37dp&quot;</span></span><br><span class="line">                app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line"></span><br><span class="line">                app:layout_constraintTop_toBottomOf=<span class="string">&quot;@+id/textView&quot;</span></span><br><span class="line">                app:layout_constraintVertical_bias=<span class="string">&quot;1.0&quot;</span>/&gt;</span><br><span class="line">        &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/photo_card&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/card_text&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;LinearLayout</span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:orientation=<span class="string">&quot;vertical&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;TextView</span><br><span class="line">                android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:text=<span class="string">&quot;今天的照片&quot;</span></span><br><span class="line">                android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">                android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">                android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line"></span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">                android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">                android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">                android:backgroundTint=<span class="string">&quot;#eeeeee&quot;</span></span><br><span class="line">                android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">                android:layout_marginTop=<span class="string">&quot;7dp&quot;</span></span><br><span class="line">                android:layout_marginBottom=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">                app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">                app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span>&gt;</span><br><span class="line">                &lt;ImageView</span><br><span class="line">                    android:id=<span class="string">&quot;@+id/image_show&quot;</span></span><br><span class="line">                    android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">                    android:layout_height=<span class="string">&quot;300dp&quot;</span></span><br><span class="line">                    android:scaleType=<span class="string">&quot;center&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    android:src=<span class="string">&quot;@drawable/ic_baseline_camera_alt_24&quot;</span></span><br><span class="line"></span><br><span class="line">                    android:padding=<span class="string">&quot;65dp&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    /&gt;</span><br><span class="line">            &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.card.MaterialCardView</span><br><span class="line">        android:id=<span class="string">&quot;@+id/card_text&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;100dp&quot;</span></span><br><span class="line">        android:layout_marginHorizontal=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">        android:layout_marginBottom=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        android:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:cardCornerRadius=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">        app:cardElevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toTopOf=<span class="string">&quot;@+id/complete_Button&quot;</span></span><br><span class="line">        app:layout_constraintEnd_toEndOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        app:layout_constraintStart_toStartOf=<span class="string">&quot;parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:layout_marginTop=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;一行日记&quot;</span></span><br><span class="line">            android:textColor=<span class="string">&quot;#707070&quot;</span></span><br><span class="line">            android:textSize=<span class="string">&quot;16sp&quot;</span></span><br><span class="line">            android:textStyle=<span class="string">&quot;bold&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;com.google.android.material.textfield.TextInputEditText</span><br><span class="line">            android:id=<span class="string">&quot;@+id/diarytext_edit&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">            android:layout_gravity=<span class="string">&quot;bottom&quot;</span></span><br><span class="line">            android:layout_marginHorizontal=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:layout_marginBottom=<span class="string">&quot;15dp&quot;</span></span><br><span class="line">            android:background=<span class="string">&quot;@drawable/button_drawable&quot;</span></span><br><span class="line">            android:backgroundTint=<span class="string">&quot;#eeeeee&quot;</span></span><br><span class="line">            android:maxLines=<span class="string">&quot;2&quot;</span></span><br><span class="line">            android:hint=<span class="string">&quot;请输入内容&quot;</span></span><br><span class="line">            android:paddingStart=<span class="string">&quot;10dp&quot;</span> /&gt;</span><br><span class="line">    &lt;/com.google.android.material.card.MaterialCardView&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.google.android.material.button.MaterialButton</span><br><span class="line">        android:id=<span class="string">&quot;@+id/complete_Button&quot;</span></span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;50dp&quot;</span></span><br><span class="line">        android:backgroundTint=<span class="string">&quot;#3EB06A&quot;</span></span><br><span class="line">        android:insetTop=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:insetBottom=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        android:text=<span class="string">&quot;修改完成&quot;</span></span><br><span class="line">        android:textSize=<span class="string">&quot;18dp&quot;</span></span><br><span class="line">        android:textStyle=<span class="string">&quot;bold&quot;</span></span><br><span class="line">        app:cornerRadius=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:elevation=<span class="string">&quot;0dp&quot;</span></span><br><span class="line">        app:layout_constraintBottom_toBottomOf=<span class="string">&quot;parent&quot;</span></span><br><span class="line">        tools:layout_editor_absoluteX=<span class="string">&quot;0dp&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br></pre></td></tr></table></figure>





<h2 id="五、软件操作流程"><a href="#五、软件操作流程" class="headerlink" title="五、软件操作流程"></a>五、软件操作流程</h2><p><img src="https://blog-1307458383.cos.ap-guangzhou.myqcloud.com/lnm011223-picture-master/uPic/image-20211206000220688.png"></p>
<h2 id="六、难点和解决方案"><a href="#六、难点和解决方案" class="headerlink" title="六、难点和解决方案"></a>六、难点和解决方案</h2><p>对于我个人而言本次的难点主要是布局的问题以及对recycleview的不熟悉，和一些奇奇怪怪的bug，导致体验极差，现在项目里也遗留了一些垃圾代码</p>
<h4 id="1-日记列表刷新问题"><a href="#1-日记列表刷新问题" class="headerlink" title="1.日记列表刷新问题"></a>1.日记列表刷新问题</h4><p>解决方案：利用Fragment的生命周期，把加载Recycleview放在<code>onstart( )</code>方法里，每当fragment变为可见状态，便会执行一次加载（即创建完新日记和修改完日记回到这个列表fragment就会加载出来）</p>
<h4 id="2-context获取问题"><a href="#2-context获取问题" class="headerlink" title="2.context获取问题"></a>2.context获取问题</h4><p>解决方案：有的时候this用作context会翻车，所以可以弄个全局的context</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lnm011223.my_diary</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.<span class="keyword">annotation</span>.SuppressLint</span><br><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> : <span class="type">Application</span></span>() &#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span>&#123;</span><br><span class="line">        <span class="meta">@SuppressLint(<span class="meta-string">&quot;StaticFieldLeak&quot;</span>)</span></span><br><span class="line">        <span class="keyword">lateinit</span> <span class="keyword">var</span> context: Context</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line">        context = applicationContext</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-recycleview点击问题"><a href="#3-recycleview点击问题" class="headerlink" title="3.recycleview点击问题"></a>3.recycleview点击问题</h4><p>解决方案：一定要记得context的参数是<code>parent.context</code>,不然会直接闪退</p>
<h2 id="七、不足之处"><a href="#七、不足之处" class="headerlink" title="七、不足之处"></a>七、不足之处</h2><p>虽然目前程序跑的效果还是不错的，但是也只是在数据量少的时候，因为这个列表加载是一次加载全部，所以数据多的时候，肯定会导致卡顿以及难找到想要的记录。而且现在日记能记录的东西也只有时间，文字，图片以及心情，内容比较少。</p>
<h2 id="八、今后设想"><a href="#八、今后设想" class="headerlink" title="八、今后设想"></a>八、今后设想</h2><p>1.可以加入按年份月份分类的功能，就不用一次性加载全部记录</p>
<p>2.可以加入定时提醒功能，每天自定义时间提醒用户该写日记了</p>
<p>3.加入按具体日期查看日记的功能</p>
]]></content>
      <categories>
        <category>作业</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>UI</tag>
      </tags>
  </entry>
</search>
